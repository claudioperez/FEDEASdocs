<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://claudioperez.github.io/FEDEASdocs/Guides/Teaching/chp_1/">
        <link rel="shortcut icon" href="../../../img/favicon.ico">
        <title>Basic Analysis Functions - FEDEASLab</title>
        <link href="../../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
        <link href="../../../_static/css/extra.css" rel="stylesheet">


        <script src="../../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/matlab.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <!-- <script>
            $(".nav .nav-link").on("click", function(){
            $(".nav").find(".active").removeClass("active");
            $(this).addClass("active");
         });
         </script> -->


        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-170527070-1', 'auto');
            ga('send', 'pageview');
        </script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../../..">FEDEASLab</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav ml-auto">
                        <!--<ul class="nav navbar-nav">-->
                            <li class="navitem">
                                <a href="../../../About/" class="nav-link">About</a>
                            </li>
                            <li class="navitem">
                                <a href="../../" class="nav-link">Guides</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Functions <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li><a href="../../../Functions/latest" class="dropdown-item">Index</a></li>
                                    
<li><a href="../../../Functions/latest/PreProcessing/" class="dropdown-item">Pre-processing</a></li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Modeling Libraries</a>
    <ul class="dropdown-menu">
            
<li><a href="../../../Functions/latest/Modeling_Library/Element_Library/" class="dropdown-item">Element</a></li>
            
<li><a href="../../../Functions/latest/Modeling_Library/Material_Library/" class="dropdown-item">Material</a></li>
            
<li><a href="../../../Functions/latest/Modeling_Library/Section_Library/" class="dropdown-item">Section</a></li>
    </ul>
  </li>
                                    
<li><a href="../../../Functions/latest/Solution_Library/" class="dropdown-item">Solution Library</a></li>
                                    
<li><a href="../../../Functions/latest/Utilities/" class="dropdown-item">Utilities</a></li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="../../../Examples/" class="nav-link">Examples</a>
                            </li>
                        <!--</ul>-->
                        <!--</div>-->

                    <!-- <ul class="nav navbar-nav ml-auto"> -->
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#elstir_search_modal">
                               <!--<img src="img/search.png" class="icon">--> <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="container">
            
            <!-- <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                  <li class="breadcrumb-item"><a href="#">Home</a></li>
                  <li class="breadcrumb-item"><a href="#">Library</a></li>
                  <li class="breadcrumb-item active" aria-current="page">Data</li>
                </ol>
            </nav> -->
            
            <div class="row">
                    
                        <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>
    
    <div id="toc-collapse" class="navbar-collapse collapse card ">
        <ul class="nav flex-column">
        
            
            <li class="nav-item " data-level="1">
              <a href="/FEDEASdocs/Guides/Teaching/" class="">FEDEASLab Basic Structural Analysis Functions</a>
              <!-- <a href="/FEDEASdocs/Guides/Teaching/" class="nav-link ">FEDEASLab Basic Structural Analysis Functions</a> -->
              
              <ul class="nav flex-column">
              <div class="dropdown-divider"></div>
                    
            <li class="nav-item active" data-level="2">
              <a href="/FEDEASdocs/Guides/Teaching/chp_1/" class="active">Basic Analysis Functions</a>
              <!-- <a href="/FEDEASdocs/Guides/Teaching/chp_1/" class="nav-link active">Basic Analysis Functions</a> -->
              
              <ul class="nav flex-column">
              
              </ul>
              
            </li>
                    
                    
            <li class="nav-item " data-level="2">
              <a href="/FEDEASdocs/Guides/Teaching/chp_2/" class="">Utilities</a>
              <!-- <a href="/FEDEASdocs/Guides/Teaching/chp_2/" class="nav-link ">Utilities</a> -->
              
              <ul class="nav flex-column">
              
              </ul>
              
            </li>
                    
              </ul>
              
            </li>
        
        </ul>
    </div>
</div></div>
                    

                    
                        <article class="col-md-9 p-3">
                        <!-- <article class="col-md-9"> -->
                        
<h1>Basic Analysis Functions</h1>

<p><strong>Table of Contents</strong></p>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#function-organization">Function Organization</a></li>
<li><a href="#data-organization">Data Organization</a></li>
<li><a href="#data-structure-model">Data Structure <code>Model</code></a></li>
<li><a href="#general-utility-functions">General Utility Functions</a></li>
<li><a href="#function-localize">Function <code>Localize</code></a></li>
<li><a href="#displacement-method-of-analysis">Displacement Method of Analysis</a></li>
<li><a href="#210-direct-stiffness-assembly">2.10 Direct Stiffness Assembly</a></li>
</ul>
<h2 id="introduction">Introduction</h2>
<p><code>FEDEASLab</code> functions implement structural analysis concepts in parallel with their theoretical presentation in the introductory structural analysis course, thus illustrating the generality of the methods and their application to large scale and complex structural models. The intent is not only to reinforce the understanding of the structural response under different types and arrangements of loading, but also to facilitate system and parameter studies.</p>
<h2 id="function-organization">Function Organization</h2>
<p>The basic structural analysis functions for the introductory course are organized in two folders: <code>Basic</code> and <code>Utilities</code>. The <code>Basic</code> folder contains 14 functions that directly implement the analysis concepts of the course in Matlab. Most functions in this folder are provided in open source form (<code>.m</code> file format), so that interested readers can relate the implementation details with the theory presented in the course. They can be classified in the following categories:</p>
<ol>
<li><em>Functions for Structural Matrices and Vectors (8)</em>:  These are listed in Table 2.1.</li>
<li><em>Analysis Functions and Scripts (4)</em>: These are listed in Table 2.2.</li>
<li><em>General Utility Functions (2)</em>: Namely <code>Localize</code> and <code>ElmLenOr</code> which are not invoked directly, but are used by the functions in the first category.</li>
</ol>
<p>The user defines the geometry and properties of the structural model, and then specifies the structural analysis procedure(s) and the graphical post-processing of the results by selecting suitable functions from Table  2.1-Table  2.4  in  a Matlab script  file,  as  described  in  the  following  sections.  Scripting  affords extensive  flexibility  for  the  response  determination  and  the  presentation  of  the  results,  but  puts  the burden  on  the  user  to  assemble  the  whole  by  understanding  its  parts.  This  supports  the  open-ended educational mission of <code>FEDEASLab</code>, as opposed to the black-box nature of commercial analysis software. The following sections describe the functions in Table 2.1-Table 2.4 with examples. The notation for function  arguments  and  local  variables  agrees  with  the  notation  of  the  course  reader,  as  summarized in Appendix RB2. The examples in this chapter correspond to examples of the course reader with the Matlab scripts for all examples available in the folder <code>Examples</code> of the basic <code>FEDEASLab</code> package.</p>
<h2 id="data-organization">Data Organization</h2>
<p>The initial set of analysis functions for the concepts of an introductory course on structural analysis is built around two data structures: <code>Model</code>, for the geometric description of the structural model, and <code>ElemData</code> for  the  element  and  material  properties  and  element  loading,  as  is  evident  from  the  input argument list of the functions in Table 2.1-Table 2.4. The organization of structural model information in two data structures serves to emphasize the concept of the introductory structural analysis course that, under linear conditions, the governing static and kinematic relations depend only on the geometry of  the  structural  model  and  not  on  any  element  properties.  Accordingly,  the  functions <code>Bmatrix</code> for setting up the linear static matrix <script type="math/tex">B</script> and <code>Amatrix</code> for setting up the linear kinematic matrix <script type="math/tex">A</script> of the structure take as single input argument the data structure <code>Model</code> with model geometry information.</p>
<h3 id="data-structure-model">Data Structure <code>Model</code></h3>
<p>In <code>FEDEASLab</code> information about the structural model is collected in the data structure <code>Model</code>, which is  set  up  by  the  function <code>CreateSimpleModel</code> from  information  supplied  by  the  user.  The  function <code>CreateSimpleModel</code> is limited to models consisting of 2-node, 2d or 3d truss and frame elements. The function  numbers  the  degrees  of  freedom  (DOFs)  of  the  structure,  as  discussed  in  the  course  reader, thus  facilitating  their  identification  for  small  structural  models.  With  this  degree  of  freedom  (DOF) numbering the analysis functions set up full matrices that do not take advantage of the small number of non-zero terms in large structural models. The general model creation function <code>CreateModel</code> does not have limitations on element type and uses a DOF numbering scheme that minimizes the storage of structure matrices. The use of sparse matrices with minimum storage is essential for the analysis of large structural models with 2d and 3d finite elements.</p>
<p>Fig. 2.1 shows the input data for the structure of Example R4.1 in the form of numerical arrays <code>XYZ</code>,<code>BOUN</code>, and <code>CON</code>. The rows of <code>XYZ</code> correspond to the nodes and the <em>ndm</em> columns to the node coordinates, where <em>ndm</em> is the dimension of the structural model. The rows of <code>BOUN</code> also correspond to the nodes and the <em>ndf</em> columns to node restraint switches, where <em>ndf</em> is the maximum number of DOFs per node for the model. The DOF order for each node is: 1 = force in <script type="math/tex">X</script>, 2 = force in <script type="math/tex">Y</script>, 3 = moment about <script type="math/tex">Z</script> (for 2d model), or force in <script type="math/tex">Z</script> (for 3d model), 4,5,6 = moment about <script type="math/tex">X</script>,<script type="math/tex">Y</script> and <script type="math/tex">Z</script> (for 3d model). The switch value <code>0</code> indicates a free and the value 1 a restrained DOF. <code>CON</code> can be a numerical array for a structural model with only 2-node elements. For finite element models with elements having a different number of nodes, <code>CON</code> needs to be specified as a cell array so that the row contents can vary from element to element. Each row of the numerical <code>CON</code> array contains the node numbers to which the corresponding element connects. Finally, <code>ElemName</code> is a cell array that accommodates element names with a different number of characters. The names <code>'Truss'</code> and <code>'2dFrm'</code> suffice for tasks that do not require element and material properties. For tasks requiring element and material properties the element names need to be <code>'LinTruss'</code>, <code>'Lin2dFrm'</code>, and <code>'Lin3dFrm'</code> for the 2d/3d truss, the 2d frame, and the 3d frame element, respectively.</p>
<h2 id="general-utility-functions">General Utility Functions</h2>
<p>Once the geometry and other relevant information about the structural model is collected in data structure <code>Model</code> by the function <code>CreateSimpleModel</code>, information about the geometry and the global DOF  correspondence  for  a  particular  element  can  be  extracted  with  the  help  of  two  general  utility functions: <code>Localize</code> and <code>ElmLenOr</code>. All functions with input arguments <code>Model</code> and <code>ElemData</code> in Table 2.1 invoke these utility functions for setting up the corresponding structural matrices or vectors.</p>
<h3 id="function-localize">Function <code>Localize</code></h3>
<p>This function locates the element <code>el</code> in the Model and returns its end node coordinates in array <code>xyz</code>, and the local-global DOF correspondence in vector <code>id</code>. The first column of the two dimensional array <code>xyz</code> contains the coordinates of end <code>i</code> of the element and the second column those of end <code>j</code>.</p>
<pre><code class="matlab">function [xyz,id] = Localize(Model, el)
XYZ = Model.XYZ; % node  coordinates
DOF = Model.DOF; % array with dof numbers for all  nodes

CON = Model.CON{el}; % extract connectivity array for element
ndf = Model.ndf(el); % extract no of dofs /node for element

% extract element  coordinates into array xyz;
% use CON array to extract appropriate rows of global XYZ array
xyz = XYZ(CON(CON&gt;0),:)'; % extract dof numbers into array id

% use CON array to extract appropriate rows of DOF array
id = DOF(CON(CON&gt;0), 1:ndf)'; % reshape id array into vector
id = id(:);
</code></pre>

<p>Box 2.2: Syntax of function <code>Localize</code> with input arguments <code>Model</code> and <code>el</code> and output arguments <code>xyz</code> and <code>id</code>.</p>
<h2 id="displacement-method-of-analysis">Displacement Method of Analysis</h2>
<p>The steps of the displacement method of analysis are described in Section <script type="math/tex">\mathrm{R} 10.3</script> and Section <script type="math/tex">\mathrm{R} 10.4</script>
A summary of these steps for implementation in <code>FEDEASLab</code> is:</p>
<ol>
<li>With the kinematic matrix <script type="math/tex">\mathbf{A}_{f}</script> set up the stiffness matrix <script type="math/tex">\mathbf{K}_{f}</script> and the initial force vector <script type="math/tex">\boldsymbol{P}_{0}</script>
<script type="math/tex; mode=display">
\mathbf{K}_{f}=\mathbf{A}_{f}^{T} \mathbf{K}_{s} \mathbf{A}_{f} \quad \boldsymbol{P}_{0}=\mathbf{A}_{J}^{T} \boldsymbol{Q}_{0}+\boldsymbol{P}_{w f}
</script>
</li>
<li>Solve the equilibrium equations for the free DOF displacements <script type="math/tex">\boldsymbol{U}_{f}</script>
<script type="math/tex; mode=display">
P_{f}=\mathbf{K}_{f} \boldsymbol{U}_{f}+\boldsymbol{P}_{0}
</script>
</li>
<li>Determine the element deformations <script type="math/tex">\boldsymbol{V}</script> from the kinematic relations
<script type="math/tex; mode=display">
\boldsymbol{V}=\mathbf{A}_{f} \boldsymbol{U}_{f}
</script>
</li>
<li>Determine the basic forces <script type="math/tex">Q</script> from the collection of element force-deformation relations
<script type="math/tex; mode=display">
Q=\mathbf{K}_{s} \boldsymbol{V}+\boldsymbol{Q}_{0}
</script>
</li>
</ol>
<p>Box 2.17 shows the implementation of these steps in the Matlab script file <code>S_DisplMethod</code>.
As is the case with the script for the force method of analysis, the script <code>S_DisplMethod</code> depends on the definition of the structural model geometry in data structure <code>Model</code>, and on the specification of the element property and loading information in data structure <code>ElemData</code>. The specification of the
nodal forces <code>Pf</code> and <code>Pwf</code> is optional with default, values equal to zero. The script uses the same auxiliary
functions as the script for the force method to remove the rows of the kinematic matrix <script type="math/tex">\mathbf{A}</script> with release
deformations and pad the vector of basic forces <script type="math/tex">Q</script> from the displacement method of analysis with zero
values at the releases, so that it can determine the element deformations <script type="math/tex">\boldsymbol{V}_{\varepsilon}</script> at the element ends with flexural releases and plot the deformed shape of the corresponding element, if required.</p>
<h2 id="210-direct-stiffness-assembly">2.10 Direct Stiffness Assembly</h2>
<p>Section <script type="math/tex">\mathrm{R} 10.6 .3</script> demonstrates the significant advantage of the displacement method over the force
method of analysis: the direct assembly of the structure stiffness matrix <script type="math/tex">\mathbf{K}_{f}</script> and the resisting forces <script type="math/tex">\boldsymbol{P}_{r}</script>.
We demonstrate briefly the ease of implementing the direct stiffness assembly in <code>FEDEASLab</code> by taking advantage of the array indexing capabilities of Matlab described in Appendix <script type="math/tex">\mathrm{A}</script> and avoiding the
multiplication by the Boolean array in Eq. <script type="math/tex">\mathrm{R}(10.31) .</script> The latter approach is symbolically compact but computationally inefficient, because the Boolean matrix <script type="math/tex">\mathbf{A}_{b}^{(e l)}</script> in Eq. <script type="math/tex">\mathrm{R}(10.31)</script> contains only a few terms of one but mostly zeros.</p>
<p>In the direct assembly process the element <script type="math/tex">i d</script> array serves as index of the element stiffness coefficients into the structure stiffness matrix <script type="math/tex">\check{\mathrm{K}} .</script>
<code>FEDEASLab</code> function <code>Kf_matrix.m</code> assembles the complete stiffness
matrix <script type="math/tex">\check{\mathrm{K}}</script> and then extracts the stiffness <script type="math/tex">\mathbf{K}</script> at the free DOFs (in practice only the free dof stiffness <script type="math/tex">\mathbf{K}</script> is assembled to save storage).</p>
<pre><code class="matlab">K  = zeros(nt, nt);

for el=1:ne % locate element in Model and return end coordinates and id array
    [xyz,id] = Localize(Model, el); % form element stiffness matrix ke in global reference system
    ke = ke_matrix(Model.ElemName{el}, ElemData{el}, xyz); % assemble element stiffness matrix ke into structure matrix K
    K(id,id) = K(id, id) + ke;
end
Kf = K(1:nf, 1:nf); % extract stiffness matrix of free DOFs
</code></pre>
                        
                        </article>
                        <!-- <div class="col-md-8" role="main"></div> -->
                    
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>&copy 1998-2020 UC Regents, <a href="http://filippou.ce.berkeley.edu/">Filip C. Filippou</a></p>
        </footer>
        <script>
            var base_url = "../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../js/base.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer></script>
        <script src="../../../search/main.js" defer></script>

        <div class="modal" id="elstir_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="elstir-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="elstir-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="elstir_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
