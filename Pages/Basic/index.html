<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://claudioperez.github.io/FEDEASdocs/Pages/Basic/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Basic Structural Analysis Functions - FEDEASLab</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
        <link href="../../_static/css/extra.css" rel="stylesheet">

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/matlab.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <!-- <script>
            $(".nav .nav-link").on("click", function(){
            $(".nav").find(".active").removeClass("active");
            $(this).addClass("active");
         });
         </script> -->
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-170527070-1', 'auto');
            ga('send', 'pageview');
        </script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">FEDEASLab</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav ml-auto">
                        <!--<ul class="nav navbar-nav">-->
                            <li class="navitem">
                                <a href="../../About/" class="nav-link">About</a>
                            </li>
                            <li class="navitem">
                                <a href="./" class="nav-link">Basics</a>
                            </li>
                            <li class="navitem">
                                <a href="../../Functions/latest/" class="nav-link">Functions</a>
                            </li>
                            <li class="navitem">
                                <a href="../../Gallery/" class="nav-link">Gallery</a>
                            </li>
                        <!--</ul>-->
                        <!--</div>-->

                    <!-- <ul class="nav navbar-nav ml-auto"> -->
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#elstir_search_modal">
                               <!--<img src="img/search.png" class="icon">--> <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="container">
            
            <!-- <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                  <li class="breadcrumb-item"><a href="#">Home</a></li>
                  <li class="breadcrumb-item"><a href="#">Library</a></li>
                  <li class="breadcrumb-item active" aria-current="page">Data</li>
                </ol>
            </nav> -->
            
            <div class="row">
                    
                        <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>
    
    <div id="toc-collapse" class="navbar-collapse collapse card ">
        <ul class="nav flex-column">
        
            
            <li class="nav-item " data-level="1">
              <a href="/FEDEASdocs/Pages/" class="">Pages</a>
              <!-- <a href="/FEDEASdocs/Pages/" class="nav-link ">Pages</a> -->
              
              <ul class="nav flex-column">
              <div class="dropdown-divider"></div>
                    
            <li class="nav-item active" data-level="2">
              <a href="/FEDEASdocs/Pages/Basic/" class="active">Basic Structural Analysis Functions</a>
              <!-- <a href="/FEDEASdocs/Pages/Basic/" class="nav-link active">Basic Structural Analysis Functions</a> -->
              
              <ul class="nav flex-column">
              
              </ul>
              
            </li>
                    
              </ul>
              
            </li>
        
        </ul>
    </div>
</div></div>
                    

                    
                        <article class="col-md-9 p-3">
                        <!-- <article class="col-md-9"> -->
                        

<h1 id="basic-structural-analysis-functions">Basic Structural Analysis Functions</h1>
<p><a href="" id="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" data-replace="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" title="../../"><span style="color: blue;font-family: monospace;">FEDEAS</span>Lab</a> functions implement structural analysis concepts in parallel with their theoretical presentation in the introductory structural analysis course, thus illustrating the generality of the methods and their application to large scale and complex structural models. The intent is not only to reinforce the understanding of the structural response under different types and arrangements of loading, but also to facilitate system and parameter studies.</p>
<h1 id="function-organization">Function Organization</h1>
<p>The structural analysis functions for the introductory course are organized in two folders: <code>Basic</code> and <code>Utilities</code>. The <code>Basic</code> folder contains 20 functions that directly implement the analysis concepts of the course in MATLAB . Many functions in this folder are provided in open source form (<code>.m</code> file format), so that interested readers can relate the implementation details with the theory presented in the course.</p>
<div id="tbl:StructMat">
<table>
<caption>Table 1: Functions for Structural Matrices and Vectors</caption>
<thead>
<tr class="header">
<th style="text-align: center;">Function name</th>
<th style="text-align: left;"> Input arguments (optional)</th>
<th style="text-align: left;"> Output</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"> <a href="../../Functions/latest/General/B_matrix" id="&lt;span style=&quot;font-family: monospace&quot;&gt;B_matrix&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;B_matrix&lt;/span&gt;"><span style="font-family: monospace">B_matrix</span></a></td>
<td style="text-align: left;"> <code>Model</code></td>
<td style="text-align: left;"> <code>B</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>BbariBbarx_matrix</code>  </td>
<td style="text-align: left;"> <code>Bf</code>, (<code>ind_r</code>)</td>
<td style="text-align: left;"> <code>Bbari</code>, <code>Bbarx</code>  </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <a href="../../Functions/latest/General/A_matrix" id="&lt;span style=&quot;font-family: monospace&quot;&gt;A_matrix&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;A_matrix&lt;/span&gt;"><span style="font-family: monospace">A_matrix</span></a></td>
<td style="text-align: left;"> <code>Model</code></td>
<td style="text-align: left;"> <code>A</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"> <a href="../../Functions/latest/General/Fs_matrix" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Fs_matrix&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Fs_matrix&lt;/span&gt;"><span style="font-family: monospace">Fs_matrix</span></a></td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code>, <code>(Roption)</code></td>
<td style="text-align: left;"> <code>Fs</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <a href="../../Functions/latest/General/V0_vector" id="&lt;span style=&quot;font-family: monospace&quot;&gt;V0_vector&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;V0_vector&lt;/span&gt;"><span style="font-family: monospace">V0_vector</span></a></td>
<td style="text-align: left;"><code>Model</code>, <code>ElemData</code>, <code>(Roption)</code></td>
<td style="text-align: left;"> <code>V0</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"> <a href="../../Functions/latest/General/Ks_matrix" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Ks_matrix&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Ks_matrix&lt;/span&gt;"><span style="font-family: monospace">Ks_matrix</span></a></td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code>  </td>
<td style="text-align: left;"> <code>Ks</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <a href="../../Functions/latest/General/Q0_vector" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Q0_vector&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Q0_vector&lt;/span&gt;"><span style="font-family: monospace">Q0_vector</span></a></td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code>  </td>
<td style="text-align: left;"> <code>Q0</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"> <a href="../../Functions/latest/General/Kf_matrix" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Kf_matrix&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Kf_matrix&lt;/span&gt;"><span style="font-family: monospace">Kf_matrix</span></a>  </td>
<td style="text-align: left;"><code>Model</code>, <code>ElemData</code>  </td>
<td style="text-align: left;"> <code>Kf</code></td>
</tr>
</tbody>
</table>
</div>
<p>The <a href="" id="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" data-replace="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" title="../../"><span style="color: blue;font-family: monospace;">FEDEAS</span>Lab</a>  functions in the <code>Basic</code> folder can be classified in the following categories:</p>
<ol type="1">
<li><p><em>Functions for Structural Matrices and Vectors</em>: 8. These are listed in Table <a href="#tbl:StructMat">1</a>.</p></li>
<li><p><em>Analysis Functions and Scripts</em>: 4. These are listed in Table <a href="#tbl:AnalFunScr">2</a>.</p></li>
<li><p><em>Structural Model and Loading Functions</em>: 3. These are listed in Table <a href="#tbl:ModLoad">4</a>.</p></li>
<li><p><em>Model and Element Utility Functions</em>: 6, namely <code>Localize</code>, <code>ElmLenOr</code>, <code>Create_PlasticLimitSurface</code>, <code>DefGeom_2dFrm</code>, <code>DeformShape2dFrm</code> and <code>Large2du2v_Frm</code> which are not invoked directly, but are used either by the Model and Loading Functions or by Graphics Utility Functions to be discussed subsequently.</p></li>
</ol>
<div id="tbl:AnalFunScr">
<table>
<caption>Table 2: Analysis Functions and Scripts</caption>
<thead>
<tr class="header">
<th style="text-align: center;"> Script name</th>
<th style="text-align: left;">  Input variables (optional)</th>
<th>  Output variables  </th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"> <code>S_ForceMethod</code>  </td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code>, (<code>Pf</code>), (<code>Pwf</code>)  </td>
<td> <code>Q</code>, <code>Ve</code>, <code>Uf</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>S_DisplMethod</code>  </td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code>, (<code>Pf</code>), (<code>Pwf</code>)  </td>
<td> <code>Uf</code>, <code>Q</code>, <code>Ve</code></td>
</tr>
</tbody>
</table>
</div>
<div id="tbl:PAnalFunScr">
<table>
<caption>Table 3: Analysis Functions and Scripts</caption>
<thead>
<tr class="header">
<th style="text-align: center;"> Function name</th>
<th style="text-align: center;"> Input arguments  </th>
<th style="text-align: left;">  Output</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"> <code>PlasticAnalysis_wLBT</code>  </td>
<td style="text-align: center;"> <code>Bf</code>, <code>Qpl</code>, <code>Pref</code>, <code>(Pcf)</code>, <code>(Options)</code>  </td>
<td style="text-align: left;"> <code>lambdac</code>, <code>Qc</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>PlasticAnalysis_wUBT</code>  </td>
<td style="text-align: center;"> <code>Af</code>, <code>Qpl</code>, <code>Pref</code>, <code>(Pcf)</code>, <code>(Options)</code>  </td>
<td style="text-align: left;"> <code>lambdac</code>, <code>DUf</code>, <code>DVhp</code>  </td>
</tr>
</tbody>
</table>
</div>
<div id="tbl:ModLoad">
<table>
<caption>Table 4: Model and Loading Functions</caption>
<thead>
<tr class="header">
<th style="text-align: center;"> Function name</th>
<th style="text-align: left;">  Input arguments</th>
<th>  Output  </th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"> [func:Create_SimpleModel] </td>
<td style="text-align: left;"> <code>XYZ</code>, <code>CON</code>, <code>BOUN</code>, <code>ElemName</code>  </td>
<td> <code>Model</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"> [func:Create_NodalForces] </td>
<td style="text-align: left;"> <code>Model</code>, <code>Pe</code></td>
<td> <code>Pf</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"> [func:Create_PwForces]  </td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code></td>
<td> <code>Pw</code></td>
</tr>
</tbody>
</table>
</div>
<p>The folder <code>Utilities</code> contains 28 functions. Almost all functions in this folder are provided in content-obscured form (encoded <code>.p</code> file format), since the implementation details have no bearing on the structural analysis concepts and may only be of interest to readers with programming curiosity and skills. They can be classified in the following categories:</p>
<ol type="1">
<li><p><em>General Utility Functions</em>: 2, namely <code>CleanStart</code> and <code>Print_PDFile</code>.</p></li>
<li><p><em>Graphics Utility Functions</em>: 13. These are listed in Table <a href="#tbl:GraphUtil">5</a>.</p></li>
<li><p><em>Supporting Functions</em>: 13. These are not invoked directly, but are used by the analysis functions and scripts and by the graphics utility functions. They are not described further in this text, since they are of little interest to the user, but details about input and output arguments may be found in the online help.</p></li>
</ol>
<div id="tbl:GraphUtil">
<table>
<caption>Table 5: Graphics Utility Functions</caption>
<thead>
<tr class="header">
<th style="text-align: left;">  Function name</th>
<th style="text-align: left;">  Input arguments (optional)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"> <a href="../../Functions/latest/Utilities/Plotting/Create_Window" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Create_Window&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Create_Window&lt;/span&gt;"><span style="font-family: monospace">Create_Window</span></a></td>
<td style="text-align: left;"> <code>DX</code>, <code>DY</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"> <a href="../../Functions/latest/Utilities/Plotting/Structure/Plot_Model" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Plot_Model&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Plot_Model&lt;/span&gt;"><span style="font-family: monospace">Plot_Model</span></a></td>
<td style="text-align: left;"> <code>Model</code>, (<code>Uf</code>) , (<code>Options</code>)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <a href="../../Functions/latest/Utilities/Plotting/Structure/Label_Model" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Label_Model&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Label_Model&lt;/span&gt;"><span style="font-family: monospace">Label_Model</span></a></td>
<td style="text-align: left;"> <code>Model</code>, (<code>Options</code>)</td>
</tr>
<tr class="even">
<td style="text-align: left;"> <a href="../../Functions/latest/Utilities/Plotting/Structure/Plot_NodalForces" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Plot_NodalForces&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Plot_NodalForces&lt;/span&gt;"><span style="font-family: monospace">Plot_NodalForces</span></a></td>
<td style="text-align: left;"> <code>Model</code>, <code>Pe</code> , (<code>Options</code>) </td>
</tr>
<tr class="odd">
<td style="text-align: left;"> [func:Plot_ElementLoading]</td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code> , (<code>Options</code>) </td>
</tr>
<tr class="even">
<td style="text-align: left;"> <a href="../../Functions/latest/Utilities/Plotting/Structure/Plot_Releases" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Plot_Releases&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Plot_Releases&lt;/span&gt;"><span style="font-family: monospace">Plot_Releases</span></a></td>
<td style="text-align: left;"> <code>Model</code>, (<code>ElemData</code>) , (<code>Uf</code>) , (<code>Options</code>) </td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <a href="../../Functions/latest/Utilities/Plotting/Elements/Plot_AxialForces" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Plot_AxialForces&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Plot_AxialForces&lt;/span&gt;"><span style="font-family: monospace">Plot_AxialForces</span></a></td>
<td style="text-align: left;"> <code>Model</code>, <code>Q</code>, (<code>ElemList</code>), (<code>Scale</code>)</td>
</tr>
<tr class="even">
<td style="text-align: left;"> <a href="../../Functions/latest/Utilities/Plotting/Elements/Label_AxialForces" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Label_AxialForces&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Label_AxialForces&lt;/span&gt;"><span style="font-family: monospace">Label_AxialForces</span></a></td>
<td style="text-align: left;"> <code>Model</code>, <code>Q</code>, (<code>ElemList</code>), (<code>Digit</code>), (<code>Units</code>)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <a href="../../Functions/latest/Utilities/Plotting/Elements/Plot_2dMomntDistr" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Plot_2dMomntDistr&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Plot_2dMomntDistr&lt;/span&gt;"><span style="font-family: monospace">Plot_2dMomntDistr</span></a></td>
<td style="text-align: left;"> <code>Model</code>, (<code>ElemData</code>), <code>Q</code>, (<code>ElemList</code>), (<code>Scale</code>)  </td>
</tr>
<tr class="even">
<td style="text-align: left;"> <a href="../../Functions/latest/Utilities/Plotting/Elements/Label_2dMoments" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Label_2dMoments&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Label_2dMoments&lt;/span&gt;"><span style="font-family: monospace">Label_2dMoments</span></a></td>
<td style="text-align: left;"> <code>Model</code>, <code>Q</code>, (<code>ElemList</code>), (<code>Digit</code>), (<code>Units</code>)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <a href="../../Functions/latest/Utilities/Plotting/Elements/Plot_2dCurvDistr" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Plot_2dCurvDistr&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Plot_2dCurvDistr&lt;/span&gt;"><span style="font-family: monospace">Plot_2dCurvDistr</span></a></td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code>, <code>Q</code>, (<code>ElemList</code>), (<code>Scale</code>)  </td>
</tr>
<tr class="even">
<td style="text-align: left;"> <a href="../../Functions/latest/Utilities/Plotting/Structure/Plot_DeformedStructure" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Plot_DeformedStructure&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Plot_DeformedStructure&lt;/span&gt;"><span style="font-family: monospace">Plot_DeformedStructure</span></a></td>
<td style="text-align: left;"> <code>Model</code>, (<code>ElemData</code>), <code>Uf</code>, (<code>Ve</code>), (<code>Options</code>)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <a href="../../Functions/latest/Utilities/Plotting/Structure/Plot_PlasticHinges" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Plot_PlasticHinges&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Plot_PlasticHinges&lt;/span&gt;"><span style="font-family: monospace">Plot_PlasticHinges</span></a></td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code>, (<code>Uf</code>), <code>Q</code>, (<code>Options</code>)</td>
</tr>
</tbody>
</table>
</div>
<p>The user defines the geometry and properties of the structural model, and then specifies the structural analysis procedure(s) and the graphical post-processing of the results by selecting suitable functions from Table <a href="#tbl:StructMat">1</a>-Table <a href="#tbl:GraphUtil">5</a> in a MATLAB  script file, as described in the following sections. Scripting affords extensive flexibility for the response determination and the presentation of the results, but puts the burden on the user to assemble the whole by understanding its parts. This supports the open-ended educational mission of <a href="" id="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" data-replace="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" title="../../"><span style="color: blue;font-family: monospace;">FEDEAS</span>Lab</a> , as opposed to the black-box nature of commercial analysis software.</p>
<p>The following sections describe the functions in Table <a href="#tbl:StructMat">1</a>-Table <a href="#tbl:GraphUtil">5</a> with examples. The notation for function arguments and local variables agrees with the notation of the course reader, as summarized in Appendix <span class="citation" data-cites="B-C:Notation">[@B-C:Notation]</span><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. The examples in this chapter correspond to examples of the course reader with the MATLAB  scripts for all examples available in the folder <code>Examples</code> of the basic <a href="" id="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" data-replace="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" title="../../"><span style="color: blue;font-family: monospace;">FEDEAS</span>Lab</a> package.</p>
<h1 id="data-organization">Data Organization</h1>
<p>The initial set of analysis functions for the concepts of an introductory course on structural analysis is built around two data structures: <a href="https://example.com" id="Model" data-replace="Model">Model</a>  for the geometric description of the structural model, and <a href="" id="&lt;code&gt;ElemData&lt;/code&gt;" data-replace="&lt;code&gt;ElemData&lt;/code&gt;" title="#sec:Data"><code>ElemData</code></a>  for the element and material properties and element loading, as is evident from the input argument list of the functions in Table <a href="#tbl:StructMat">1</a>-Table <a href="#tbl:GraphUtil">5</a>. The organization of structural model information in two data structures serves to emphasize the concept of the introductory structural analysis course that, under linear conditions, the governing static and kinematic relations depend only on the geometry of the structural model and not on any element properties. Accordingly, the functions <a href="../../Functions/latest/General/B_matrix" id="&lt;span style=&quot;font-family: monospace&quot;&gt;B_matrix&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;B_matrix&lt;/span&gt;"><span style="font-family: monospace">B_matrix</span></a> for setting up the <strong>linear</strong> equilibrium matrix <span class="math inline">\(\mathbf{B}\)</span> and <a href="../../Functions/latest/General/A_matrix" id="&lt;span style=&quot;font-family: monospace&quot;&gt;A_matrix&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;A_matrix&lt;/span&gt;"><span style="font-family: monospace">A_matrix</span></a> for setting up the <strong>linear</strong> kinematic matrix <span class="math inline">\(\mathbf{A}\)</span> of the structure take as single input argument the data structure <a href="https://example.com" id="Model" data-replace="Model">Model</a> with model geometry information.</p>
<h2 id="data-structure-datamodel">Data Structure <a href="https://example.com" id="Model" data-replace="Model">Model</a></h2>
<p>In <a href="" id="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" data-replace="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" title="../../"><span style="color: blue;font-family: monospace;">FEDEAS</span>Lab</a> information about the structural model is collected in the data structure <a href="https://example.com" id="Model" data-replace="Model">Model</a> , which is set up by the function [func:Create_SimpleModel] from information supplied by the user. The function [func:Create_SimpleModel] is limited to models consisting of 2-node, 2d or 3d truss and frame elements. The function numbers the degrees of freedom (DOFs) of the structure, as discussed in the course reader, thus facilitating their identification for small structural models. With this degree of freedom (DOF) numbering the analysis functions set up <strong>full</strong> matrices that do not take advantage of the small number of non-zero terms in large structural models. The general model creation function [func:Create_Model] does not have limitations on element type and uses a DOF numbering scheme that minimizes the storage of structure matrices. The use of sparse matrices with minimum storage is essential for the analysis of large structural models with 2d and 3d finite elements.</p>
<figure>
<img src="Function_Code/Ex4_1F1.png" id="fig:ModelInp" data-with="60%" alt="Figure 1: Specification of model geometry for plane truss in script file Ex3_1.m" /><figcaption aria-hidden="true">Figure 1: Specification of model geometry for plane truss in script file Ex3_1.m</figcaption>
</figure>
<div class="sourceCode" id="cb1" data-startFrom="38"><pre class="sourceCode matlab"><code class="sourceCode matlab" style="counter-reset: source-line 37;"><span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="co">% clear memory; close open windows</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="va">CleanStart</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="co">% define model geometry</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="va">XYZ</span>(<span class="fl">1</span><span class="op">,:</span>) <span class="op">=</span> [  <span class="fl">0</span>   <span class="fl">0</span>]<span class="op">;</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="va">XYZ</span>(<span class="fl">2</span><span class="op">,:</span>) <span class="op">=</span> [  <span class="fl">8</span>   <span class="fl">0</span>]<span class="op">;</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="va">XYZ</span>(<span class="fl">3</span><span class="op">,:</span>) <span class="op">=</span> [ <span class="fl">16</span>   <span class="fl">0</span>]<span class="op">;</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="va">XYZ</span>(<span class="fl">4</span><span class="op">,:</span>) <span class="op">=</span> [  <span class="fl">8</span>   <span class="fl">6</span>]<span class="op">;</span>  </span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="co">% element connectivity array</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="va">CON</span>(<span class="fl">1</span><span class="op">,:</span>) <span class="op">=</span> [  <span class="fl">1</span>   <span class="fl">2</span>]<span class="op">;</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="va">CON</span>(<span class="fl">2</span><span class="op">,:</span>) <span class="op">=</span> [  <span class="fl">2</span>   <span class="fl">3</span>]<span class="op">;</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="va">CON</span>(<span class="fl">3</span><span class="op">,:</span>) <span class="op">=</span> [  <span class="fl">1</span>   <span class="fl">4</span>]<span class="op">;</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="va">CON</span>(<span class="fl">4</span><span class="op">,:</span>) <span class="op">=</span> [  <span class="fl">2</span>   <span class="fl">4</span>]<span class="op">;</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="va">CON</span>(<span class="fl">5</span><span class="op">,:</span>) <span class="op">=</span> [  <span class="fl">3</span>   <span class="fl">4</span>]<span class="op">;</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a><span class="co">% boundary conditions</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a><span class="va">BOUN</span>(<span class="fl">1</span><span class="op">,:</span>) <span class="op">=</span> [ <span class="fl">1</span> <span class="fl">1</span>]<span class="op">;</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="va">BOUN</span>(<span class="fl">3</span><span class="op">,:</span>) <span class="op">=</span> [ <span class="fl">0</span> <span class="fl">1</span>]<span class="op">;</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="co">% specify element type</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a><span class="va">ne</span> <span class="op">=</span> <span class="va">size</span>(<span class="va">CON</span><span class="op">,</span><span class="fl">1</span>)<span class="op">;</span>                      </span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>[<span class="va">ElemName</span>{<span class="fl">1</span><span class="op">:</span><span class="va">ne</span>}] <span class="op">=</span> <span class="va">deal</span>(<span class="ss">&#39;Truss&#39;</span>)<span class="op">;</span></span></code></pre></div>
<p>Fig. <a href="#fig:ModelInp">1</a> shows the input data for the structure of [B-X:StatDetTruss] in the form of numerical arrays <code>XYZ</code>, <code>BOUN</code>, and <code>CON</code>. The rows of <code>XYZ</code> correspond to the nodes and the <span class="math inline">\(ndm\)</span> columns to the node coordinates, where <span class="math inline">\(ndm\)</span> is the dimension of the structural model. The rows of <code>BOUN</code> also correspond to the nodes and the <span class="math inline">\(ndf\)</span> columns to node restraint switches, where <span class="math inline">\(ndf\)</span> is the maximum number of DOFs per node for the model. The DOF order for each node is: 1 = force in <span class="math inline">\(X\)</span>, 2 = force in <span class="math inline">\(Y\)</span>, 3 = moment about <span class="math inline">\(Z\)</span> (for 2d model), or force in <span class="math inline">\(Z\)</span> (for 3d model), 4,5,6 = moment about <span class="math inline">\(X\)</span>, <span class="math inline">\(Y\)</span> and <span class="math inline">\(Z\)</span>, respectively (for 3d model). The switch value 0 indicates a free and the value 1 a restrained DOF. <code>CON</code> can be a numerical array for a structural model with only 2-node elements. For finite element models with elements having a different number of nodes, <code>CON</code> needs to be specified as a <strong>cell array</strong> so that the row contents can vary from element to element. Each row of the numerical <code>CON</code> array contains the node numbers to which the corresponding element connects. Finally, <code>ElemName</code> is a <strong>cell array</strong> that accommodates element names with a different number of characters. The names <code>'Truss'</code> and <code>'2dFrm'</code> suffice for tasks that do not require element and material properties. For tasks requiring element and material properties the element names need to be <code>'LinTruss'</code>, <code>'Lin2dFrm'</code>, and <code>'Lin3dFrm'</code> for the 2d/3d truss, the 2d frame, and the 3d frame element, respectively.</p>
<p>At the start of each input script the command <code>CleanStart</code> issues two MATLAB  commands, one for clearing the computer memory of all stored variable values (<code>clearvars</code>), and the second for closing any open figure windows (<code class="sourceCode matlab"><span class="va">close</span> <span class="va">all</span></code>). It may also be expedient to include the call to the function <code>Create_Units</code> at the start of each script, so as to take advantage of the unit definitions in the return argument <code>Units</code> and obviate the need for unit conversion in the values of variables with different units.</p>
<p>The command</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="va">Model</span> <span class="op">=</span> <span class="va">Create_SimpleModel</span>(<span class="va">XYZ</span><span class="op">,</span><span class="va">CON</span><span class="op">,</span><span class="va">BOUN</span><span class="op">,</span><span class="va">ElemName</span>)</span></code></pre></div>
<p>generates the data structure <a href="https://example.com" id="Model" data-replace="Model">Model</a> . Once <code>Model</code> is created its contents can be displayed by executing <code class="sourceCode matlab"><span class="va">disp</span>(<span class="va">Model</span>)</code>.</p>
<div class="MLbox">
<p><code>{#lst:ModelCont include="docs/Pages/Basic/Function_Code/Ex2_1a.m .matlab startLine=1 endLine=14 caption=""}</code></p>
</div>
<p>lst. <strong>¿lst:ModelCont?</strong> shows the fields and some of their contents for the data structure <a href="https://example.com" id="Model" data-replace="Model">Model</a>  of the truss in Fig. <a href="#fig:ModelInp">1</a>: <span class="math inline">\(nn\)</span> is the number of nodes of the structural model, <span class="math inline">\(ndm\)</span> the model dimension, <code>XYZ</code> the node coordinate array, <span class="math inline">\(ne\)</span> the number of elements, <code>CON</code> a cell array of element connectivity with the row number corresponding to the element number (by conversion of the numerical array <code>CON</code> supplied as input argument), <span class="math inline">\(nq\)</span> the number of basic forces in each element, <span class="math inline">\(ndf\)</span> the number of local DOFs/node and <span class="math inline">\(nen\)</span> the number of end nodes of each element, <code>ElemName</code> the cell array of element types, <span class="math inline">\(nt\)</span> the total number of DOFs, <code>BOUN</code> the array of node restraint switches, <span class="math inline">\(nf\)</span> the number of free DOFs, and <code>DOF</code> the global DOF numbering array. Typing <code>Model</code> or <code>disp(Model)</code> at the command prompt only shows contents of scalar fields of <a href="https://example.com" id="Model" data-replace="Model">Model</a>  and numeric or cell arrays that can be displayed in a single line, as [B:ModelCont] shows (numeric arrays use <code>[ ]</code> operators and cell arrays use <code>{ }</code> operators in MATLAB ). To display the contents of fields of other array types, type the data structure name and the field name separated by a period as input argument to the MATLAB  function <code>disp</code> to avoid echoing the variable name:</p>
<div class="flushleft">
<p><code>Model.XYZ</code> for node coordinates</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<div class="sourceCode" id="cb4" data-caption="`Model.BOUN` for node restraint switches"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<div class="flushleft">
<p><code>Model.DOF</code> for global DOF numbering</p>
<div class="sourceCode" id="cb5" data-caption=""><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<h2 id="sec:Data">Data Structure <a href="" id="&lt;code&gt;ElemData&lt;/code&gt;" data-replace="&lt;code&gt;ElemData&lt;/code&gt;" title="#sec:Data"><code>ElemData</code></a> for Element Properties and Loading</h2>
<p><a href="" id="&lt;code&gt;ElemData&lt;/code&gt;" data-replace="&lt;code&gt;ElemData&lt;/code&gt;" title="#sec:Data"><code>ElemData</code></a>  is the second data structure of <a href="" id="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" data-replace="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" title="../../"><span style="color: blue;font-family: monospace;">FEDEAS</span>Lab</a> after <a href="https://example.com" id="Model" data-replace="Model">Model</a> . It is specified entirely by the user. Because the element property data vary from element to element, it is necessary to use a cell array for <a href="" id="&lt;code&gt;ElemData&lt;/code&gt;" data-replace="&lt;code&gt;ElemData&lt;/code&gt;" title="#sec:Data"><code>ElemData</code></a>  so that the array contents can vary from element to element. <a href="" id="&lt;code&gt;ElemData&lt;/code&gt;" data-replace="&lt;code&gt;ElemData&lt;/code&gt;" title="#sec:Data"><code>ElemData</code></a>  is a one dimensional cell array with the row number corresponding to the element number. It has the fields in Table <a href="#tbl:ElDatafields">6</a> with optional fields with default value 0 shown in parentheses.</p>
<div id="tbl:ElDatafields">
<table>
<caption>Table 6: <a href="" id="&lt;code&gt;ElemData&lt;/code&gt;" data-replace="&lt;code&gt;ElemData&lt;/code&gt;" title="#sec:Data"><code>ElemData</code></a> fields (optional fields with default value 0 in parentheses)</caption>
<thead>
<tr class="header">
<th style="text-align: center;">Field</th>
<th style="text-align: left;"> Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code>E</code>  </td>
<td style="text-align: left;">elastic material modulus (scalar)</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>A</code>  </td>
<td style="text-align: left;">cross section area (scalar)</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>I</code>  </td>
<td style="text-align: left;">moment of inertia (scalar) (2d frame only)</td>
</tr>
<tr class="even">
<td style="text-align: center;"> (<code>Release</code>)    </td>
<td style="text-align: left;">3x1 vector of release codes; 0=continuous, 1=release (2d frame only)  </td>
</tr>
<tr class="odd">
<td style="text-align: center;">(<code>w</code>)  </td>
<td style="text-align: left;">uniform element load, 2x1 vector with <span class="math inline">\(w_x\)</span> and <span class="math inline">\(w_y\)</span> (2d frame only)</td>
</tr>
<tr class="even">
<td style="text-align: center;">(<code>e0</code>)  </td>
<td style="text-align: left;">non-mechanical effects, 2x1 vector with <span class="math inline">\(\varepsilon_0\)</span> and <span class="math inline">\(\kappa_0\)</span> (2d frame only)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">(<code>q0</code>)  </td>
<td style="text-align: left;">initial prestressing force (scalar) (truss only)</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>Np</code>  </td>
<td style="text-align: left;">plastic axial capacity (scalar)</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>Mp</code>  </td>
<td style="text-align: left;">plastic flexural capacity (scalar) (2d frame only)</td>
</tr>
</tbody>
</table>
</div>
<p>Table <a href="#tbl:ElDatafields">6</a> shows that <a href="" id="&lt;code&gt;ElemData&lt;/code&gt;" data-replace="&lt;code&gt;ElemData&lt;/code&gt;" title="#sec:Data"><code>ElemData</code></a> includes a field <code>Np</code> for the plastic axial capacity and a field <code>Mp</code> for the plastic flexural capacity. <em>These are only required for the plastic analysis of large structural models</em>. Otherwise, the plastic capacities of the elements may be directly specified with vector <span class="math inline">\(\boldsymbol{Q}_{pl}\)</span>, as discussed later in this chapter.</p>
<div class="MLbox">
<div class="sourceCode" id="cb6" data-rulecolor="\color{red}" data-startFrom="1"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> [<span class="va">xyz</span><span class="op">,</span><span class="va">id</span>] <span class="op">=</span> <span class="va">Localize</span> (<span class="va">Model</span><span class="op">,</span><span class="va">el</span>)</span></code></pre></div>
<div class="sourceCode" id="cb7" data-startFrom="15"><pre class="sourceCode matlab"><code class="sourceCode matlab" style="counter-reset: source-line 14;"><span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="va">XYZ</span> <span class="op">=</span> <span class="va">Model</span>.<span class="va">XYZ</span><span class="op">;</span>        <span class="co">% node coordinates</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="va">DOF</span> <span class="op">=</span> <span class="va">Model</span>.<span class="va">DOF</span><span class="op">;</span>        <span class="co">% array with dof numbers for all nodes</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="va">CON</span> <span class="op">=</span> <span class="va">Model</span>.<span class="va">CON</span>{<span class="va">el</span>}<span class="op">;</span>    <span class="co">% extract connectivity array for element</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="va">ndf</span> <span class="op">=</span> <span class="va">Model</span>.<span class="va">ndf</span>(<span class="va">el</span>)<span class="op">;</span>    <span class="co">% extract no of dofs/node for element</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="co">% extract element coordinates into array xyz;</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="co">% use CON array to extract appropriate rows of global XYZ array</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="va">xyz</span> <span class="op">=</span> <span class="va">XYZ</span>(<span class="va">CON</span>(<span class="va">CON</span><span class="op">&gt;</span><span class="fl">0</span>)<span class="op">,:</span>)<span class="op">&#39;;</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="co">% extract dof numbers into array id</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="co">% use CON array to extract appropriate rows of DOF array</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="va">id</span> <span class="op">=</span> <span class="va">DOF</span>(<span class="va">CON</span>(<span class="va">CON</span><span class="op">&gt;</span><span class="fl">0</span>)<span class="op">,</span><span class="fl">1</span><span class="op">:</span><span class="va">ndf</span>)<span class="op">&#39;;</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="co">% reshape id array into vector   </span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="va">id</span> <span class="op">=</span> <span class="va">id</span>(<span class="op">:</span>)<span class="op">;</span></span></code></pre></div>
</div>
<div class="MLbox">
<div class="sourceCode" id="cb8" data-rulecolor="\color{red}" data-startFrom="1"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> [<span class="va">L</span><span class="op">,</span><span class="va">dcx</span>] <span class="op">=</span> <span class="va">ElmLenOr</span> (<span class="va">xyz</span>)</span></code></pre></div>
<div class="sourceCode" id="cb9" data-startFrom="16"><pre class="sourceCode matlab"><code class="sourceCode matlab" style="counter-reset: source-line 15;"><span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co">% coordinate differences Dx, Dy, Dz depending on problem dimension</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="va">Dxyz</span> <span class="op">=</span> <span class="va">xyz</span> (<span class="op">:,</span><span class="fl">2</span>) <span class="op">-</span> <span class="va">xyz</span>(<span class="op">:,</span><span class="fl">1</span>)<span class="op">;</span>   </span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="co">% element length</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="va">L</span>    <span class="op">=</span> <span class="va">sqrt</span> (<span class="va">Dxyz</span><span class="op">&#39;*</span><span class="va">Dxyz</span>)<span class="op">;</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="co">% direction cosines of element orientation</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="va">dcx</span>  <span class="op">=</span> <span class="va">Dxyz</span><span class="op">./</span><span class="va">L</span><span class="op">;</span></span></code></pre></div>
</div>
<h1 id="general-utility-functions">General Utility Functions</h1>
<p>Once the geometry and other relevant information about the structural model is collected in data structure <a href="https://example.com" id="Model" data-replace="Model">Model</a>  by the function [func:Create_SimpleModel], information about the geometry and the global DOF correspondence for a particular element can be extracted with the help of two general utility functions: <code>Localize</code> and <code>ElmLenOr</code>. All functions with input arguments <a href="https://example.com" id="Model" data-replace="Model">Model</a>  and <a href="" id="&lt;code&gt;ElemData&lt;/code&gt;" data-replace="&lt;code&gt;ElemData&lt;/code&gt;" title="#sec:Data"><code>ElemData</code></a> in Table <a href="#tbl:StructMat">1</a> invoke these utility functions for setting up the corresponding structural matrices or vectors.</p>
<h2 id="function-funclocalize">Function <a href="../../Functions/latest/General/Localize" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Localize&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Localize&lt;/span&gt;"><span style="font-family: monospace">Localize</span></a></h2>
<p>This function locates the element <code>el</code> in the <a href="https://example.com" id="Model" data-replace="Model">Model</a>  and returns its end node coordinates in array <code>xyz</code>, and the local-global DOF correspondence in vector <code>id</code>. The first column of the two dimensional array <code>xyz</code> contains the coordinates of end <span class="math inline">\(i\)</span> of the element and the second column those of end <span class="math inline">\(j\)</span>.</p>
<h2 id="function-funcelmlenor">Function <a href="../../Functions/latest/Geometry/ElmLenOr" id="&lt;span style=&quot;font-family: monospace&quot;&gt;ElmLenOr&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;ElmLenOr&lt;/span&gt;"><span style="font-family: monospace">ElmLenOr</span></a></h2>
<p>This function returns the element length <code>L</code> and the direction cosines of the element <span class="math inline">\(x\)</span>-axis in vector <code>dcx</code> from the end node coordinates supplied in array <code>xyz</code>.</p>
<h1 id="structural-equilibrium">Structural Equilibrium</h1>
<p>The global DOF equilibrium equations of the structural model are given by [B-E:PBQ]. As discussed in [B-C:Statics], the equilibrium equations at the free DOFs of the structural model in [B-E:GlEqwBfQ] are used to solve for the basic forces <span class="math inline">\(\boldsymbol{Q}\)</span>. For determining the solution of these equations it is necessary to set up the applied nodal forces <span class="math inline">\(\boldsymbol{P}_f\)</span>, the equivalent nodal forces <span class="math inline">\(\boldsymbol{P}_{wf}\)</span> and the equilibrium matrix <span class="math inline">\(\mathbf{B}_f\)</span>. The latter is extracted from the full equilibrium matrix <span class="math inline">\(\mathbf{B}\)</span>.</p>
<h2 id="sec:FLBfAssembly">Assembly of Equilibrium Matrix <span class="math inline">\(\mathbf{B}\)</span></h2>
<p>The assembly of the equilibrium matrix <span class="math inline">\(\mathbf{B}\)</span> of the structural model in [B-S:BfAssembly] involves the determination of the equilibrium matrix <span class="math inline">\(\mathbf{b}_g\)</span> of each element and the re-assignment of the rows of <span class="math inline">\(\mathbf{b}_g\)</span> to the rows of <span class="math inline">\(\mathbf{B}\)</span> based on the local-global DOF number correspondence in accordance with the <span class="math inline">\(\boldsymbol{id}\)</span> array of the element. Setting up the equilibrium matrix <span class="math inline">\(\mathbf{b}_g\)</span> of each element according to [B-E:bg42dfr], [B-E:bg42dtr] or [B-E:bg43dtr] for a 2d frame, a 2d truss and a 3d truss element, respectively, requires the element length <span class="math inline">\(L\)</span> and the direction cosines of the undeformed element <span class="math inline">\(x\)</span>-axis. These are set up by the utility function <a href="../../Functions/latest/Geometry/ElmLenOr" id="&lt;span style=&quot;font-family: monospace&quot;&gt;ElmLenOr&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;ElmLenOr&lt;/span&gt;"><span style="font-family: monospace">ElmLenOr</span></a> in conjunction with the utility function <code>Localize</code>, which also sets up the <span class="math inline">\(\boldsymbol{id}\)</span> array for the element, as described earlier.</p>
<p>The assembly of the <span class="math inline">\(\mathbf{B}\)</span> matrix according to [B-E:Belbg] is implemented in <a href="" id="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" data-replace="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" title="../../"><span style="color: blue;font-family: monospace;">FEDEAS</span>Lab</a>  function <a href="../../Functions/latest/General/B_matrix" id="&lt;span style=&quot;font-family: monospace&quot;&gt;B_matrix&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;B_matrix&lt;/span&gt;"><span style="font-family: monospace">B_matrix</span></a> , as shown in lst. <a href="#lst:Bmatimpl">1</a>. The function <a href="../../Functions/latest/General/B_matrix" id="&lt;span style=&quot;font-family: monospace&quot;&gt;B_matrix&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;B_matrix&lt;/span&gt;"><span style="font-family: monospace">B_matrix</span></a>  calls the internal function <code>bg_matrix</code> to set up the equilibrium matrix <span class="math inline">\(\mathbf{b}_g\)</span> of each element according to [B-E:bg42dfr], [B-E:bg42dtr] or [B-E:bg43dtr] for a 2d frame, a 2d truss and a 3d truss element, respectively. The function syntax is given in [B:bgimpl].</p>
<p>Because the data structure <a href="https://example.com" id="Model" data-replace="Model">Model</a>  does not have information about basic force releases, it is the user’s responsibility to remove the columns of the <span class="math inline">\(\mathbf{B}\)</span>-matrix corresponding to basic force releases so that the difference between the number of columns and the number of rows of the <span class="math inline">\(\mathbf{B}\)</span>-matrix matches the degree of static indeterminacy NOS of the structural model. A convenient way for setting up an index of element release locations is furnished by the utility function [func:H_index] with information about the element releases in <a href="" id="&lt;code&gt;ElemData&lt;/code&gt;" data-replace="&lt;code&gt;ElemData&lt;/code&gt;" title="#sec:Data"><code>ElemData</code></a> , as will be discussed later.</p>
<p>After setting up the complete equilibrium matrix <span class="math inline">\(\mathbf{B}\)</span> for the structural model, the equilibrium matrix <span class="math inline">\(\mathbf{B}_f\)</span> for the free DOFs corresponds to the upper <span class="math inline">\(nf\)</span> rows of <span class="math inline">\(\mathbf{B}\)</span>. It can be extracted with the statement</p>
<div class="MLbox">
<div id="lst:Bmatimpl" class="listing matlab">
<p>Listing 1: </p>
<div class="sourceCode" id="cb10" data-rulecolor="\color{red}" data-startFrom="1"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="va">B</span> <span class="op">=</span> <span class="va">B_matrix</span> (<span class="va">Model</span>)</span></code></pre></div>
</div>
<div class="sourceCode" id="cb11" data-startFrom="20"><pre class="sourceCode matlab"><code class="sourceCode matlab" style="counter-reset: source-line 19;"><span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="co">% assemble structure equilibrium matrix</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="va">ne</span> <span class="op">=</span> <span class="va">Model</span>.<span class="va">ne</span><span class="op">;</span>          <span class="co">% number of elements in structural model</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="va">k</span>  <span class="op">=</span> <span class="fl">0</span><span class="op">;</span>                 <span class="co">% initialize column index into matrix B</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="kw">for</span> <span class="va">el</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">ne</span>             <span class="co">% loop over all elements</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>   <span class="co">% locate element in Model and return end coordinates and id array</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>   [<span class="va">xyz</span><span class="op">,</span><span class="va">id</span>] <span class="op">=</span> <span class="va">Localize</span>(<span class="va">Model</span><span class="op">,</span><span class="va">el</span>)<span class="op">;</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>   <span class="co">% form element equilibrium matrix bg</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>   <span class="va">bg</span> <span class="op">=</span> <span class="va">bg_matrix</span>(<span class="va">Model</span>.<span class="va">ElemName</span>{<span class="va">el</span>}<span class="op">,</span><span class="va">xyz</span>)<span class="op">;</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>   <span class="co">% assemble element equilibrium matrix bg into static matrix B</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>   <span class="va">nc</span> <span class="op">=</span> <span class="va">size</span>(<span class="va">bg</span><span class="op">,</span><span class="fl">2</span>)<span class="op">;</span>     <span class="co">% determine number of columns of matrix bg</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>   <span class="va">B</span>(<span class="va">id</span><span class="op">,</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">:</span><span class="va">k</span><span class="op">+</span><span class="va">nc</span>) <span class="op">=</span> <span class="va">bg</span><span class="op">;</span> <span class="co">% insert bg into id locations of matrix B</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>   <span class="va">k</span>  <span class="op">=</span> <span class="va">k</span><span class="op">+</span><span class="va">nc</span><span class="op">;</span>           <span class="co">% augment column index by number of columns</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div>
<div class="sourceCode" id="cb12" data-startFrom="35"><pre class="sourceCode matlab"><code class="sourceCode matlab" style="counter-reset: source-line 34;"><span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="va">bg</span> <span class="op">=</span> <span class="va">bg_matrix</span>(<span class="va">ElemName</span><span class="op">,</span><span class="va">xyz</span>)</span></code></pre></div>
<div class="sourceCode" id="cb13" data-startFrom="39"><pre class="sourceCode matlab"><code class="sourceCode matlab" style="counter-reset: source-line 38;"><span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a><span class="co">% determine element length and orientation</span></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>[<span class="va">L</span><span class="op">,</span><span class="va">dcx</span>] <span class="op">=</span> <span class="va">ElmLenOr</span>(<span class="va">xyz</span>)<span class="op">;</span></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="va">contains</span>(<span class="va">ElemName</span><span class="op">,</span><span class="ss">&#39;Truss&#39;</span>)</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>   <span class="co">% truss element</span></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>   <span class="va">bg</span> <span class="op">=</span> [<span class="op">-</span><span class="va">dcx</span><span class="op">;</span> <span class="va">dcx</span>]<span class="op">;</span></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a><span class="kw">elseif</span> <span class="va">contains</span>(<span class="va">ElemName</span><span class="op">,</span><span class="ss">&#39;2dFrm&#39;</span>)</span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>   <span class="co">% 2d frame element</span></span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>   <span class="va">dXL</span> <span class="op">=</span> <span class="va">dcx</span>(<span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>   <span class="va">dYL</span> <span class="op">=</span> <span class="va">dcx</span>(<span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>   <span class="va">bg</span>  <span class="op">=</span> [<span class="op">-</span><span class="va">dXL</span>  <span class="op">-</span><span class="va">dYL</span><span class="op">/</span><span class="va">L</span>  <span class="op">-</span><span class="va">dYL</span><span class="op">/</span><span class="va">L</span><span class="op">;</span></span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>          <span class="op">-</span><span class="va">dYL</span>   <span class="va">dXL</span><span class="op">/</span><span class="va">L</span>   <span class="va">dXL</span><span class="op">/</span><span class="va">L</span><span class="op">;</span></span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>             <span class="fl">0</span>     <span class="fl">1</span>       <span class="fl">0</span>  <span class="op">;</span></span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>           <span class="va">dXL</span>   <span class="va">dYL</span><span class="op">/</span><span class="va">L</span>   <span class="va">dYL</span><span class="op">/</span><span class="va">L</span><span class="op">;</span></span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>           <span class="va">dYL</span>  <span class="op">-</span><span class="va">dXL</span><span class="op">/</span><span class="va">L</span>  <span class="op">-</span><span class="va">dXL</span><span class="op">/</span><span class="va">L</span><span class="op">;</span></span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>             <span class="fl">0</span>     <span class="fl">0</span>       <span class="fl">1</span>  ]<span class="op">;</span></span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a><span class="kw">else</span></span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>   <span class="va">error</span> (<span class="ss">&#39;only truss and 2d frame elements supported; check syntax&#39;</span>)</span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div>
</div>
<h2 id="sec:SpecNF">Specification of Nodal Forces</h2>
<figure>
<img src="Function_Code/StatTrEx2F1.png" id="fig:PfInp" style="width:98.0%" alt="Figure 2: Specification of applied nodal forces in the script file Ex3_1.m" /><figcaption aria-hidden="true">Figure 2: Specification of applied nodal forces in the script file <code>Ex3_1.m</code></figcaption>
</figure>
<div class="sourceCode" id="cb14" data-startFrom="84"><pre class="sourceCode matlab"><code class="sourceCode matlab" style="counter-reset: source-line 83;"><span id="cb14-84"><a href="#cb14-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-85"><a href="#cb14-85" aria-hidden="true" tabindex="-1"></a><span class="co">%% specify loading</span></span>
<span id="cb14-86"><a href="#cb14-86" aria-hidden="true" tabindex="-1"></a><span class="va">Pe</span>(<span class="fl">2</span><span class="op">,</span><span class="fl">2</span>) <span class="op">=</span> <span class="op">-</span><span class="fl">5</span><span class="op">;</span> <span class="co">% node 2, direction Y</span></span>
<span id="cb14-87"><a href="#cb14-87" aria-hidden="true" tabindex="-1"></a><span class="va">Pe</span>(<span class="fl">4</span><span class="op">,</span><span class="fl">1</span>) <span class="op">=</span> <span class="fl">10</span><span class="op">;</span> <span class="co">% node 4, direction X</span></span>
<span id="cb14-88"><a href="#cb14-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-89"><a href="#cb14-89" aria-hidden="true" tabindex="-1"></a><span class="co">% generate applied force vector Pf</span></span></code></pre></div>
<p>The next task for setting up the node equilibrium equations of the structural model is the specification of the applied and the equivalent nodal forces. For this task it is impractical to know the global DOF numbering for directly setting up the applied and the equivalent nodal force vectors <span class="math inline">\(\boldsymbol{P}_f\)</span> and <span class="math inline">\(\boldsymbol{P}_{wf}\)</span> at the free DOFs, respectively. Instead, it is convenient to specify the nodal forces in a two dimensional array <code>Pe</code> with row numbers corresponding to node numbers and column numbers corresponding to DOF numbers, where 1 = force in <span class="math inline">\(X\)</span>, <code>2</code> = force in <span class="math inline">\(Y\)</span>, <code>3</code> = moment about <span class="math inline">\(Z\)</span> (for 2d model), or force in <span class="math inline">\(Z\)</span> (for 3d model), <code>4,5,6</code> = moment about <span class="math inline">\(X\)</span>, <span class="math inline">\(Y\)</span> and <span class="math inline">\(Z\)</span>, respectively (for 3d model). With the global DOF numbering available in the data structure <a href="https://example.com" id="Model" data-replace="Model">Model</a> , the <a href="" id="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" data-replace="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" title="../../"><span style="color: blue;font-family: monospace;">FEDEAS</span>Lab</a> function [func:Create_NodalForces]  in Table <a href="#tbl:ModLoad">4</a>] sets-up the nodal force vector. The input arguments to the function are the data structure <a href="https://example.com" id="Model" data-replace="Model">Model</a> and the two dimensional nodal force array <code>Pe</code>, while the output argument is the nodal force vector <code>Pf</code>. Fig. <a href="#fig:PfInp">2</a> shows the syntax for the applied nodal forces of the truss from [B-X:StatDetTruss]. The equivalent nodal forces <span class="math inline">\(\boldsymbol{P}_w\)</span> are set up by the function <code>Create_PwForces</code> in Table <a href="#tbl:ModLoad">4</a> for the element loading <span class="math inline">\(w\)</span> specified in data structure <a href="" id="&lt;code&gt;ElemData&lt;/code&gt;" data-replace="&lt;code&gt;ElemData&lt;/code&gt;" title="#sec:Data"><code>ElemData</code></a>  according to Table <a href="#tbl:ElDatafields">6</a>.</p>
<h2 id="sec:Q42dtruss">Solution for Statically Determinate Structures</h2>
<p>For a stable, statically determinate structure the equilibrium matrix <span class="math inline">\(\mathbf{B}_f\)</span> is square with full rank. The MATLAB  function <code>rank</code> can be used to make sure that this is indeed the case. Given the nodal forces <span class="math inline">\(\boldsymbol{P}_f\)</span> and <span class="math inline">\(\boldsymbol{P}_{wf}\)</span> at the free DOFs of a stable structural model, a unique solution of the system of linear equations in [B-E:GlEqwBfQ] exists, resulting in the basic forces <span class="math inline">\(\boldsymbol{Q}\)</span> of the structure. The product of the basic forces <span class="math inline">\(\boldsymbol{Q}\)</span> with the full equilibrium matrix <span class="math inline">\(\mathbf{B}\)</span> gives the complete nodal force vector <span class="math inline">\(\boldsymbol{P}\)</span> according to [B-E:PBQ]. The entries in the upper <span class="math inline">\(nf\)</span> rows of <span class="math inline">\(\boldsymbol{P}\)</span> correspond to the nodal forces <span class="math inline">\(\boldsymbol{P}_f-\boldsymbol{P}_{wf}\)</span>, and the entries in the remaining rows correspond to the support reactions <span class="math inline">\(\boldsymbol{R}\)</span> according to [B-E:PfRBQ].</p>
<p>lst. <a href="#lst:QRdet">2</a> shows an excerpt from a MATLAB  script file that follows the generation of <a href="https://example.com" id="Model" data-replace="Model">Model</a>  in Fig. <a href="#fig:ModelInp">1</a> and of the applied nodal force vector <span class="math inline">\(\boldsymbol{P}_f\)</span> in Fig. <a href="#fig:PfInp">2</a>. The script shows the determination of the equilibrium matrix <span class="math inline">\(\mathbf{B}\)</span> with function <a href="../../Functions/latest/General/B_matrix" id="&lt;span style=&quot;font-family: monospace&quot;&gt;B_matrix&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;B_matrix&lt;/span&gt;"><span style="font-family: monospace">B_matrix</span></a>  and its display, the solution of the equilibrium equations in [B-E:GlEqwBfQ] with the MATLAB  <span class="math inline">\(\backslash\)</span> command, and the resulting basic forces <span class="math inline">\(\boldsymbol{Q}\)</span>. The basic forces <span class="math inline">\(\boldsymbol{Q}\)</span> are then used to determine the support reactions <span class="math inline">\(\boldsymbol{R}\)</span> after first multiplying these with the full equilibrium matrix <span class="math inline">\(\mathbf{B}\)</span> and then extracting the rows corresponding to the restrained DOFs.</p>
<div class="MLbox">
<div id="lst:QRdet" class="listing matlab">
<p>Listing 2: </p>
<div class="sourceCode" id="cb15"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
</div>
<h2 id="solution-for-statically-indeterminate-structures">Solution for Statically Indeterminate Structures</h2>
<p>The general solution of the equilibrium equations in [B-E:GlEqwBfQ] for a equilibrium matrix <span class="math inline">\(\mathbf{B}_f\)</span> with full rank and with more columns than rows uses <strong>the row-echelon form of the matrix</strong>. Conversion of a matrix to row-echelon form uses the Gauss-Jordan elimination procedure. This well established procedure of linear algebra is implemented in the function <code>rref</code> of MATLAB . It can be used to establish the rank of <span class="math inline">\(\mathbf{B}_f\)</span> and provide the particular and the homogeneous solutions of the equilibrium equations according to [B-S:Sol4SIStr].</p>
<p>Following [B-S:Sol4SIStr] the general solution of the equilibrium equations in [B-E:Qfinal] is based on the basic force influence matrix <span class="math inline">\(\bar{\mathbf{B}}_i\)</span> of <strong>the primary structure</strong> for the applied and equivalent nodal forces, and the basic force influence matrix <span class="math inline">\(\bar{\mathbf{B}}_x\)</span> for the redundant basic forces <span class="math inline">\(\boldsymbol{Q}_x\)</span>. <a href="" id="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" data-replace="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" title="../../"><span style="color: blue;font-family: monospace;">FEDEAS</span>Lab</a>  function <a href="../../Functions/latest/General/BbariBbarx_matrix" id="&lt;span style=&quot;font-family: monospace&quot;&gt;BbariBbarx_matrix&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;BbariBbarx_matrix&lt;/span&gt;"><span style="font-family: monospace">BbariBbarx_matrix</span></a>  takes the equilibrium matrix <span class="math inline">\(\mathbf{B}_f\)</span> as input argument and uses its reduced-row echelon form to set up the force influence matrices <span class="math inline">\(\bar{\mathbf{B}}_i\)</span> and <span class="math inline">\(\bar{\mathbf{B}}_x\)</span>. The optional function argument <code>ind_r</code> can be used to select specific basic forces as redundants. If <code>ind_r</code> is not specified, the Gauss-Jordan elimination process selects the redundant basic forces automatically, and the function <a href="../../Functions/latest/General/BbariBbarx_matrix" id="&lt;span style=&quot;font-family: monospace&quot;&gt;BbariBbarx_matrix&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;BbariBbarx_matrix&lt;/span&gt;"><span style="font-family: monospace">BbariBbarx_matrix</span></a>  returns the index array <code>ind_x</code> to the basic force vector <span class="math inline">\(\boldsymbol{Q}\)</span>, so that the redundant basic forces <span class="math inline">\(\boldsymbol{Q}_x\)</span> can be extracted with <code>Qx = Q(ind_x)</code>. The function syntax is</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> [<span class="va">Bbari</span><span class="op">,</span> <span class="va">Bbarx</span><span class="op">,</span> <span class="va">ind</span> <span class="va">x</span>] <span class="op">=</span> <span class="va">BbariBbarx</span> <span class="va">matrix</span> ( <span class="va">Bf</span><span class="op">,</span> <span class="va">ind</span> <span class="va">r</span>)</span></code></pre></div>
<div class="MLbox" data-caption="Particular and homogeneous static solutions">
<div id="lst:Bbar4brfr" class="listing matlab">
<p>Listing 3: </p>
<div class="sourceCode" id="cb17" data-linerange="11"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">%% Matlab script for force influence matrix generation</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">% Department of Civil and Environmental Engineering</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">% University of California, Berkeley</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co">% Professor Filip C. Filippou</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co">% clear memory</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="va">CleanStart</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co">% static matrix Bf of braced frame (Ex 2.7)</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="va">Bf</span> <span class="op">=</span> [ <span class="fl">1</span><span class="op">/</span><span class="fl">6</span>  <span class="fl">1</span><span class="op">/</span><span class="fl">6</span>  <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>  <span class="fl">0.8</span><span class="op">;</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>        <span class="fl">0</span>    <span class="fl">1</span>   <span class="fl">1</span>    <span class="fl">0</span>    <span class="fl">0</span>   <span class="fl">0</span> <span class="op">;</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>        <span class="fl">0</span>    <span class="fl">0</span> <span class="op">-</span><span class="fl">1</span><span class="op">/</span><span class="fl">4</span> <span class="op">-</span><span class="fl">1</span><span class="op">/</span><span class="fl">4</span>  <span class="fl">1</span><span class="op">/</span><span class="fl">4</span>  <span class="fl">0</span> <span class="op">;</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>        <span class="fl">0</span>    <span class="fl">0</span>   <span class="fl">0</span>    <span class="fl">1</span>    <span class="fl">1</span>   <span class="fl">0</span> ]<span class="op">;</span></span></code></pre></div>
</div>
<div class="sourceCode" id="cb18" data-startFrom="16"><pre class="sourceCode matlab"><code class="sourceCode matlab" style="counter-reset: source-line 15;"><span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="co">% select basic force redundants</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="va">ind_r</span> <span class="op">=</span> [<span class="fl">1</span><span class="op">,</span><span class="fl">4</span>]<span class="op">;</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>[<span class="va">Bbari</span><span class="op">,</span><span class="va">Bbarx</span><span class="op">,</span><span class="va">ind_x</span>] <span class="op">=</span> <span class="va">BbariBbarx_matrix</span>(<span class="va">Bf</span><span class="op">,</span><span class="va">ind_r</span>)<span class="op">;</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="va">Pf</span> <span class="op">=</span> [<span class="fl">20</span><span class="op">;</span><span class="fl">0</span><span class="op">;-</span><span class="fl">30</span><span class="op">;</span><span class="fl">0</span>]<span class="op">;</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="va">Qp</span> <span class="op">=</span> <span class="va">Bbari</span><span class="op">*</span><span class="va">Pf</span><span class="op">;</span></span></code></pre></div>
<div class="sourceCode" id="cb19" data-startFrom="1"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">%% Matlab script for force influence matrix generation</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co">% Department of Civil and Environmental Engineering</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co">% University of California, Berkeley</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co">% Professor Filip C. Filippou</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co">% clear memory</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="va">CleanStart</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co">% static matrix Bf of braced frame (Ex 2.7)</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="va">Bf</span> <span class="op">=</span> [ <span class="fl">1</span><span class="op">/</span><span class="fl">6</span>  <span class="fl">1</span><span class="op">/</span><span class="fl">6</span>  <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>  <span class="fl">0.8</span><span class="op">;</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>        <span class="fl">0</span>    <span class="fl">1</span>   <span class="fl">1</span>    <span class="fl">0</span>    <span class="fl">0</span>   <span class="fl">0</span> <span class="op">;</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>        <span class="fl">0</span>    <span class="fl">0</span> <span class="op">-</span><span class="fl">1</span><span class="op">/</span><span class="fl">4</span> <span class="op">-</span><span class="fl">1</span><span class="op">/</span><span class="fl">4</span>  <span class="fl">1</span><span class="op">/</span><span class="fl">4</span>  <span class="fl">0</span> <span class="op">;</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>        <span class="fl">0</span>    <span class="fl">0</span>   <span class="fl">0</span>    <span class="fl">1</span>    <span class="fl">1</span>   <span class="fl">0</span> ]<span class="op">;</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="co">% select basic force redundants</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="va">ind_r</span> <span class="op">=</span> [<span class="fl">1</span><span class="op">,</span><span class="fl">4</span>]<span class="op">;</span></span></code></pre></div>
</div>
<p>lst. <a href="#lst:Bbar4brfr">3</a> shows the direct specification of the <span class="math inline">\(\mathbf{B}_f\)</span> matrix for the braced frame of [B-X:SIBrFrm] that corresponds to the equilibrium equations in [B-E:EqEqs4brfr]. The function <a href="../../Functions/latest/General/BbariBbarx_matrix" id="&lt;span style=&quot;font-family: monospace&quot;&gt;BbariBbarx_matrix&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;BbariBbarx_matrix&lt;/span&gt;"><span style="font-family: monospace">BbariBbarx_matrix</span></a>  then determines the force influence matrices <span class="math inline">\(\bar{\mathbf{B}}_i\)</span> and <span class="math inline">\(\bar{\mathbf{B}}_x\)</span> for the selection of <span class="math inline">\(\boldsymbol{Q}_1\)</span> and <span class="math inline">\(\boldsymbol{Q}_4\)</span> as redundant basic forces, as specified by <code>ind_r=[1,4]</code>. With the direct specification of the nodal force vector <span class="math inline">\(\boldsymbol{P}_f\)</span> the particular solution for the given nodal forces can be determined by the product <span class="math inline">\(\bar{\mathbf{B}}_i\mspace{1.5mu}\boldsymbol{P}_f\)</span>. The resulting values agree with those from <a href="b">B-X:SIBrFrm</a> and (c).</p>
<h1 id="structural-kinematics">Structural Kinematics</h1>
<p>The structural kinematic relations in [B-E:VAfUf] relate the element deformations <span class="math inline">\(\boldsymbol{V}\)</span> to the free global DOF displacements <span class="math inline">\(\boldsymbol{U}_f\)</span> through the kinematic matrix <span class="math inline">\(\mathbf{A}_f\)</span> of the structure. With a given set of <strong>compatible</strong> element deformations <span class="math inline">\(\boldsymbol{V}\)</span> the solution of the kinematic relations in [B-E:VAfUf] gives the values of the free DOF displacements <span class="math inline">\(\boldsymbol{U}_f\)</span>. This approach to the determination of the free DOF displacements is of particular interest for statically determinate structures, for which the number of element deformations is equal to the number of unknown free DOF displacements, so that the element deformations are not constrained by compatibility conditions, as the examples of [B-C:Kinematics] demonstrate.</p>
<h2 id="assembly-of-kinematic-matrix-mathbfa">Assembly of Kinematic Matrix <span class="math inline">\(\mathbf{A}\)</span></h2>
<p>Because <span class="math inline">\(\mathbf{A}_f^T=\mathbf{B}_f\)</span> according to the principle of virtual work, it is not necessary to create separate functions for setting up the equilibrium matrix <span class="math inline">\(\mathbf{B}\)</span> and the kinematic matrix <span class="math inline">\(\mathbf{A}\)</span>. Nonetheless, <a href="" id="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" data-replace="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" title="../../"><span style="color: blue;font-family: monospace;">FEDEAS</span>Lab</a> has two separate functions in the interest of completeness.</p>
<p>The assembly of the kinematic matrix <span class="math inline">\(\mathbf{A}\)</span> is completely analogous to that of the equilibrium matrix <span class="math inline">\(\mathbf{B}\)</span> and the corresponding functions practically identical. Nonetheless, a brief description of the process is given in the following.</p>
<p>The assembly of the kinematic matrix <span class="math inline">\(\mathbf{A}\)</span> of the structural model in [B-S:AfAssembly] involves the determination of the kinematic matrix <span class="math inline">\(\mathbf{a}_g\)</span> of each element and the re-assignment of the columns of <span class="math inline">\(\mathbf{a}_g\)</span> to the columns of <span class="math inline">\(\mathbf{A}\)</span> based on the local-global DOF number correspondence in accordance with the <span class="math inline">\(\boldsymbol{id}\)</span> array of the element. The kinematic matrix <span class="math inline">\(\mathbf{a}_g\)</span> of each element is set up according to [B-E:vagu], [B-E:v2dtruss], or [B-E:v3dtruss] for 2d frame, 2d truss and 3d truss, respectively, and requires the element length <span class="math inline">\(L\)</span> and the <span class="math inline">\(x\)</span>-axis orientation in the form of the direction cosines, as discussed for the equilibrium matrix <span class="math inline">\(\mathbf{b}_g\)</span> in sec. <a href="#sec:FLBfAssembly">5.1</a>.</p>
<div class="MLbox">
<div id="lst:Amatimpl" class="listing matlab">
<p>Listing 4: </p>
<div class="sourceCode" id="cb20" data-rulecolor="\color{red}" data-startFrom="1"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="va">A</span> <span class="op">=</span> <span class="va">A_matrix</span> (<span class="va">Model</span>)</span></code></pre></div>
</div>
<div class="sourceCode" id="cb21" data-startFrom="21"><pre class="sourceCode matlab"><code class="sourceCode matlab" style="counter-reset: source-line 20;"><span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="va">ne</span> <span class="op">=</span> <span class="va">Model</span>.<span class="va">ne</span><span class="op">;</span>           <span class="co">% number of elements in structural model                  </span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="va">k</span>  <span class="op">=</span> <span class="fl">0</span><span class="op">;</span>                  <span class="co">% initialize row index into matrix A</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a><span class="kw">for</span> <span class="va">el</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">ne</span>              <span class="co">% loop over all elements                   </span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>   <span class="co">% locate element in Model and return end coordinates and id array</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>   [<span class="va">xyz</span><span class="op">,</span><span class="va">id</span>] <span class="op">=</span> <span class="va">Localize</span>(<span class="va">Model</span><span class="op">,</span><span class="va">el</span>)<span class="op">;</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>   <span class="co">% form element compatibility matrix ag</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>   <span class="va">ag</span> <span class="op">=</span> <span class="va">ag_matrix</span>(<span class="va">Model</span>.<span class="va">ElemName</span>{<span class="va">el</span>}<span class="op">,</span><span class="va">xyz</span>)<span class="op">;</span></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>   <span class="co">% assemble element compatibility matrix ag into structure matrix A</span></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>   <span class="va">nc</span> <span class="op">=</span> <span class="va">size</span>(<span class="va">ag</span><span class="op">,</span><span class="fl">1</span>)<span class="op">;</span>      <span class="co">% number of rows of matrix ag</span></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>   <span class="va">A</span>(<span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">:</span><span class="va">k</span><span class="op">+</span><span class="va">nc</span><span class="op">,</span><span class="va">id</span>) <span class="op">=</span> <span class="va">ag</span><span class="op">;</span>  <span class="co">% insert ag into location of matrix A</span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>   <span class="va">k</span>  <span class="op">=</span> <span class="va">k</span><span class="op">+</span><span class="va">nc</span><span class="op">;</span>            <span class="co">% augment row index by number of rows in ag</span></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div>
<div id="lst:agimpl" class="listing matlab">
<p>Listing 5: .</p>
<div class="sourceCode" id="cb22" data-rulecolor="\color{red}" data-startFrom="35"><pre class="sourceCode matlab"><code class="sourceCode matlab" style="counter-reset: source-line 34;"><span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="va">ag</span> <span class="op">=</span> <span class="va">ag_matrix</span>(<span class="va">ElemName</span><span class="op">,</span><span class="va">xyz</span>)</span></code></pre></div>
</div>
<div class="sourceCode" id="cb23" data-startFrom="39"><pre class="sourceCode matlab"><code class="sourceCode matlab" style="counter-reset: source-line 38;"><span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a><span class="co">% determine element length and orientation</span></span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>[<span class="va">L</span><span class="op">,</span><span class="va">dcx</span>] <span class="op">=</span> <span class="va">ElmLenOr</span>(<span class="va">xyz</span>)<span class="op">;</span></span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="va">contains</span>(<span class="va">ElemName</span><span class="op">,</span><span class="ss">&#39;Truss&#39;</span>)</span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>   <span class="co">% truss element</span></span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>   <span class="va">ag</span> <span class="op">=</span> [<span class="op">-</span><span class="va">dcx</span><span class="op">&#39;</span> <span class="va">dcx</span><span class="op">&#39;</span>]<span class="op">;</span></span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a><span class="kw">elseif</span> <span class="va">contains</span>(<span class="va">ElemName</span><span class="op">,</span><span class="ss">&#39;2dFrm&#39;</span>)</span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>   <span class="co">% 2d frame element</span></span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a>   <span class="va">dXL</span> <span class="op">=</span> <span class="va">dcx</span>(<span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a>   <span class="va">dYL</span> <span class="op">=</span> <span class="va">dcx</span>(<span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a>   <span class="va">ag</span>  <span class="op">=</span> [<span class="op">-</span><span class="va">dXL</span>     <span class="op">-</span><span class="va">dYL</span>     <span class="fl">0</span>   <span class="va">dXL</span>      <span class="va">dYL</span>      <span class="fl">0</span><span class="op">;</span></span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a>          <span class="op">-</span><span class="va">dYL</span><span class="op">/</span><span class="va">L</span>    <span class="va">dXL</span><span class="op">/</span><span class="va">L</span>   <span class="fl">1</span>   <span class="va">dYL</span><span class="op">/</span><span class="va">L</span>   <span class="op">-</span><span class="va">dXL</span><span class="op">/</span><span class="va">L</span>    <span class="fl">0</span><span class="op">;</span></span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a>          <span class="op">-</span><span class="va">dYL</span><span class="op">/</span><span class="va">L</span>    <span class="va">dXL</span><span class="op">/</span><span class="va">L</span>   <span class="fl">0</span>   <span class="va">dYL</span><span class="op">/</span><span class="va">L</span>   <span class="op">-</span><span class="va">dXL</span><span class="op">/</span><span class="va">L</span>    <span class="fl">1</span>]<span class="op">;</span></span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a><span class="kw">else</span></span>
<span id="cb23-52"><a href="#cb23-52" aria-hidden="true" tabindex="-1"></a>   <span class="va">error</span> (<span class="ss">&#39;only truss and 2d frame elements supported&#39;</span>)</span>
<span id="cb23-53"><a href="#cb23-53" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div>
</div>
<p>lst. <a href="#lst:Amatimpl">4</a> gives the syntax for function <a href="../../Functions/latest/General/A_matrix" id="&lt;span style=&quot;font-family: monospace&quot;&gt;A_matrix&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;A_matrix&lt;/span&gt;"><span style="font-family: monospace">A_matrix</span></a> . The function <a href="../../Functions/latest/General/A_matrix" id="&lt;span style=&quot;font-family: monospace&quot;&gt;A_matrix&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;A_matrix&lt;/span&gt;"><span style="font-family: monospace">A_matrix</span></a>  calls the internal function <code>ag_matrix</code> to set up the kinematic matrix <span class="math inline">\(\mathbf{a}_g\)</span> of each element according to [B-E:vagu], [B-E:v2dtruss], or [B-E:v3dtruss] for 2d frame, 2d truss and 3d truss, respectively. The function syntax is given in lst. <a href="#lst:agimpl">5</a>.</p>
<p>Because the data structure <a href="https://example.com" id="Model" data-replace="Model">Model</a>  does not have information about basic force releases, it is the user’s responsibility to remove the rows of the <span class="math inline">\(\mathbf{A}\)</span>-matrix corresponding to element ends with release deformations <span class="math inline">\(\boldsymbol{V}_h\)</span>. After setting up the complete kinematic matrix <span class="math inline">\(\mathbf{A}\)</span> for the structural model, the kinematic matrix <span class="math inline">\(\mathbf{A}_f\)</span> for the free DOFs corresponds to the first <span class="math inline">\(nf\)</span> columns of <span class="math inline">\(\mathbf{A}\)</span>. For a stable, statically determinate structure the kinematic matrix <span class="math inline">\(\mathbf{A}_f\)</span> is square with full rank. Given the element deformations <span class="math inline">\(\boldsymbol{V}\)</span>, a unique solution of the system of linear equations in [B-E:VAfUf] exists, resulting in the displacements <span class="math inline">\(\boldsymbol{U}_f\)</span> at the free DOFs of the structural model.</p>
<p>The excerpt from a MATLAB  script file in lst. <a href="#lst:TrussKinem">6</a> follows the input data for the plane truss of [B-X:KinDetTruss] and the command <code>Create_SimpleModel</code>. The element deformation vector <code>V0</code> is populated with zeroes. It has size equal to the total number of basic forces <code>sum(Model.nq)</code> for this model which does not have element releases. After specifying the non-zero values of the element deformations the solution of the kinematic relations in [B-E:VAfUf] gives the free DOF displacements <code>Uf</code>. The values are identical with those of [B-X:KinDetTruss] with the corresponding deformed shape in [B-F:KineTrEx2F8].</p>
<div class="MLbox">
<div id="lst:TrussKinem" class="listing matlab">
<p>Listing 6: Determination of the free DOF displacements for the truss of @B-X:KinDetTruss</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
</div>
<h1 id="force-deformation-relations-for-linear-material-response">Force-Deformation Relations for Linear Material Response</h1>
<p>[B-C:ForceDef] establishes the deformation-force relations of the truss element in [B-E:vq4truss] and of the 2d frame element in [B-E:vq4frm]. The collection of these relations for all elements of the structural model results in the structure deformation-force relations in [B-E:VepsQ]. Consequently, the collection of the element flexibility matrices <span class="math inline">\(\mathbf{f}\)</span> to form the matrix <span class="math inline">\(\mathbf{F}_s\)</span> and the collection of the initial element deformation vectors <span class="math inline">\(\boldsymbol{v}_0\)</span> to form the vector <span class="math inline">\(\boldsymbol{V}_{0}\)</span> depends on setting up <span class="math inline">\(\mathbf{f}\)</span> and <span class="math inline">\(\boldsymbol{v}_0\)</span> for all elements of the structural model. The latter depend on the material properties and the loading of each element which are supplied in <a href="" id="&lt;code&gt;ElemData&lt;/code&gt;" data-replace="&lt;code&gt;ElemData&lt;/code&gt;" title="#sec:Data"><code>ElemData</code></a>  according to the information in Table <a href="#tbl:ElDatafields">6</a>.</p>
<h2 id="force-deformation-functions">Force-Deformation Functions</h2>
<p>With the element property and loading information in <a href="" id="&lt;code&gt;ElemData&lt;/code&gt;" data-replace="&lt;code&gt;ElemData&lt;/code&gt;" title="#sec:Data"><code>ElemData</code></a> , the <a href="" id="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" data-replace="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" title="../../"><span style="color: blue;font-family: monospace;">FEDEAS</span>Lab</a> function <a href="../../Functions/latest/General/Fs_matrix" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Fs_matrix&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Fs_matrix&lt;/span&gt;"><span style="font-family: monospace">Fs_matrix</span></a>  collects the element flexibility matrices into the block-diagonal matrix <span class="math inline">\(\mathbf{F}_s\)</span> according to [B-E:VepsQ]. Similarly, the function <a href="../../Functions/latest/General/V0_vector" id="&lt;span style=&quot;font-family: monospace&quot;&gt;V0_vector&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;V0_vector&lt;/span&gt;"><span style="font-family: monospace">V0_vector</span></a>  collects the initial element deformations into vector <span class="math inline">\(\boldsymbol{V}_{0}\)</span>.</p>
<div class="MLbox">
<div id="lst:Fsmatimpl" class="listing matlab">
<p>Listing 7: </p>
<div class="sourceCode" id="cb25" data-rulecolor="\color{red}" data-startFrom="1"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="va">Fs</span> <span class="op">=</span> <span class="va">Fs_matrix</span> (<span class="va">Model</span><span class="op">,</span><span class="va">ElemData</span><span class="op">,</span><span class="va">Roption</span>)</span></code></pre></div>
</div>
<div class="sourceCode" id="cb26" data-startFrom="23"><pre class="sourceCode matlab"><code class="sourceCode matlab" style="counter-reset: source-line 22;"><span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a><span class="va">ne</span> <span class="op">=</span> <span class="va">Model</span>.<span class="va">ne</span><span class="op">;</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a><span class="va">f</span>  <span class="op">=</span> <span class="va">cell</span>(<span class="va">ne</span><span class="op">,</span><span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a><span class="co">% loop over all elements in structural model</span></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a><span class="kw">for</span> <span class="va">el</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">ne</span></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">% locate element in Model and return end coordinates xyz</span></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>  <span class="va">xyz</span> <span class="op">=</span> <span class="va">Localize</span>(<span class="va">Model</span><span class="op">,</span><span class="va">el</span>)<span class="op">;</span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">% determine element length from end coordinates</span></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>  <span class="va">L</span> <span class="op">=</span> <span class="va">ElmLenOr</span>(<span class="va">xyz</span>)<span class="op">;</span></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>  <span class="co">% set up element flexibility matrix</span></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>  <span class="va">f</span>{<span class="va">el</span>} <span class="op">=</span> <span class="va">f_matrix</span> (<span class="va">Model</span>.<span class="va">ElemName</span>{<span class="va">el</span>}<span class="op">,</span><span class="va">ElemData</span>{<span class="va">el</span>}<span class="op">,</span><span class="va">L</span><span class="op">,</span><span class="va">Roption</span>)<span class="op">;</span></span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a><span class="co">% block-diagonal array of element flexibility matrices</span></span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a><span class="va">Fs</span> <span class="op">=</span> <span class="va">blkdiag</span> (<span class="va">f</span>{<span class="op">:</span>})<span class="op">;</span></span></code></pre></div>
</div>
<div class="MLbox">
<div class="sourceCode" id="lst:fimpl" data-rulecolor="\color{red}" data-startFrom="38"><pre class="sourceCode matlab"><code class="sourceCode matlab" style="counter-reset: source-line 37;"><span id="lst:fimpl-38"><a href="#lst:fimpl-38" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="va">f</span> <span class="op">=</span> <span class="va">f_matrix</span> (<span class="va">ElemName</span><span class="op">,</span><span class="va">ElemData</span><span class="op">,</span><span class="va">L</span><span class="op">,</span><span class="va">Roption</span>)</span></code></pre></div>
<div class="sourceCode" id="cb27" data-startFrom="44"><pre class="sourceCode matlab"><code class="sourceCode matlab" style="counter-reset: source-line 43;"><span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a><span class="va">E</span>  <span class="op">=</span> <span class="va">ElemData</span>.<span class="va">E</span><span class="op">;</span>    <span class="co">% elastic modulus</span></span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a><span class="va">A</span>  <span class="op">=</span> <span class="va">ElemData</span>.<span class="va">A</span><span class="op">;</span>    <span class="co">% area</span></span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a><span class="va">EA</span> <span class="op">=</span> <span class="va">E</span><span class="op">*</span><span class="va">A</span><span class="op">;</span>           <span class="co">% axial stiffness</span></span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a><span class="kw">switch</span> <span class="va">ElemName</span></span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a>  <span class="kw">case</span> <span class="ss">&#39;LinTruss&#39;</span></span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a>    <span class="co">% linear truss element</span></span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a>    <span class="va">f</span>  <span class="op">=</span> <span class="va">L</span><span class="op">/</span><span class="va">EA</span><span class="op">;</span></span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true" tabindex="-1"></a>  <span class="kw">case</span> <span class="ss">&#39;Lin2dFrm&#39;</span></span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true" tabindex="-1"></a>    <span class="co">% 2d linear frame element</span></span>
<span id="cb27-54"><a href="#cb27-54" aria-hidden="true" tabindex="-1"></a>    <span class="va">I</span>  <span class="op">=</span> <span class="va">ElemData</span>.<span class="va">I</span><span class="op">;</span></span>
<span id="cb27-55"><a href="#cb27-55" aria-hidden="true" tabindex="-1"></a>    <span class="va">EI</span> <span class="op">=</span> <span class="va">E</span><span class="op">*</span><span class="va">I</span><span class="op">;</span></span>
<span id="cb27-56"><a href="#cb27-56" aria-hidden="true" tabindex="-1"></a>    <span class="va">f</span>  <span class="op">=</span> [<span class="va">L</span><span class="op">/</span><span class="va">EA</span>   <span class="fl">0</span>          <span class="fl">0</span>   <span class="op">;</span></span>
<span id="cb27-57"><a href="#cb27-57" aria-hidden="true" tabindex="-1"></a>           <span class="fl">0</span>    <span class="va">L</span><span class="op">/</span>(<span class="fl">3</span><span class="op">*</span><span class="va">EI</span>)  <span class="op">-</span><span class="va">L</span><span class="op">/</span>(<span class="fl">6</span><span class="op">*</span><span class="va">EI</span>) <span class="op">;</span></span>
<span id="cb27-58"><a href="#cb27-58" aria-hidden="true" tabindex="-1"></a>           <span class="fl">0</span>   <span class="op">-</span><span class="va">L</span><span class="op">/</span>(<span class="fl">6</span><span class="op">*</span><span class="va">EI</span>)   <span class="va">L</span><span class="op">/</span>(<span class="fl">3</span><span class="op">*</span><span class="va">EI</span>)]<span class="op">;</span></span>
<span id="cb27-59"><a href="#cb27-59" aria-hidden="true" tabindex="-1"></a>    <span class="co">% extract necessary submatrix in the presence of release(s)</span></span>
<span id="cb27-60"><a href="#cb27-60" aria-hidden="true" tabindex="-1"></a>    <span class="va">ide</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">;</span></span>
<span id="cb27-61"><a href="#cb27-61" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> <span class="va">Roption</span> <span class="op">&amp;&amp;</span> <span class="va">isfield</span>(<span class="va">ElemData</span><span class="op">,</span><span class="ss">&#39;Release&#39;</span>)</span>
<span id="cb27-62"><a href="#cb27-62" aria-hidden="true" tabindex="-1"></a>      <span class="va">idr</span> <span class="op">=</span> <span class="va">find</span>(<span class="va">ElemData</span>.<span class="va">Release</span>)<span class="op">;</span></span>
<span id="cb27-63"><a href="#cb27-63" aria-hidden="true" tabindex="-1"></a>      <span class="va">ide</span> <span class="op">=</span> <span class="va">setdiff</span>(<span class="va">ide</span><span class="op">,</span><span class="va">idr</span>)<span class="op">;</span></span>
<span id="cb27-64"><a href="#cb27-64" aria-hidden="true" tabindex="-1"></a>    <span class="kw">end</span></span>
<span id="cb27-65"><a href="#cb27-65" aria-hidden="true" tabindex="-1"></a>    <span class="va">f</span> <span class="op">=</span> <span class="va">f</span>(<span class="va">ide</span><span class="op">,</span><span class="va">ide</span>)<span class="op">;</span></span>
<span id="cb27-66"><a href="#cb27-66" aria-hidden="true" tabindex="-1"></a>  <span class="kw">otherwise</span></span>
<span id="cb27-67"><a href="#cb27-67" aria-hidden="true" tabindex="-1"></a>    <span class="va">error</span> (<span class="ss">&#39;only linear truss and 2d frame elements supported&#39;</span>)</span>
<span id="cb27-68"><a href="#cb27-68" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div>
</div>
<p>The syntax of function <a href="../../Functions/latest/General/Fs_matrix" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Fs_matrix&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Fs_matrix&lt;/span&gt;"><span style="font-family: monospace">Fs_matrix</span></a>  is shown in lst. <a href="#lst:Fsmatimpl">7</a> <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. The function <a href="../../Functions/latest/General/Fs_matrix" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Fs_matrix&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Fs_matrix&lt;/span&gt;"><span style="font-family: monospace">Fs_matrix</span></a>  calls the internal function <code>f_matrix</code> to set up the flexibility matrix <span class="math inline">\(\mathbf{f}\)</span> for each element according to [B-E:vq4frm] with the flexibility matrices for the truss element in [B-E:fatruss] and for the 2d frame element in [B-E:fb4planebeam]. The function syntax is given in lst. <strong>¿lst:fimpl?</strong>. The function <a href="../../Functions/latest/General/V0_vector" id="&lt;span style=&quot;font-family: monospace&quot;&gt;V0_vector&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;V0_vector&lt;/span&gt;"><span style="font-family: monospace">V0_vector</span></a>  has similar syntax and is not listed here.</p>
<p>According to [B-S:qv], the element force-deformation relations are established as the inverse of the deformation-force relations of the element with the basic element stiffness matrix <span class="math inline">\(\mathbf{k}\)</span> equal to the inverse of the element flexibility matrix <span class="math inline">\(\mathbf{f}\)</span> and the initial force vector <span class="math inline">\(\boldsymbol{q}_0\)</span> according to [B-E:qvgen].</p>
<div class="MLbox">
<div class="sourceCode" id="Ksmatimpl" data-rulecolor="\color{red}" data-startFrom="1"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="Ksmatimpl-1"><a href="#Ksmatimpl-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="va">Ks</span> <span class="op">=</span> <span class="va">Ks_matrix</span> (<span class="va">Model</span><span class="op">,</span><span class="va">ElemData</span>)</span></code></pre></div>
<div class="sourceCode" id="cb28" data-startFrom="19"><pre class="sourceCode matlab"><code class="sourceCode matlab" style="counter-reset: source-line 18;"><span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="va">ne</span> <span class="op">=</span> <span class="va">Model</span>.<span class="va">ne</span><span class="op">;</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a><span class="va">k</span>  <span class="op">=</span> <span class="va">cell</span>(<span class="va">ne</span><span class="op">,</span><span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a><span class="kw">for</span> <span class="va">el</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">ne</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>   <span class="co">% locate element in Model and return end coordinates xyz</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>   <span class="va">xyz</span> <span class="op">=</span> <span class="va">Localize</span>(<span class="va">Model</span><span class="op">,</span><span class="va">el</span>)<span class="op">;</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>   <span class="co">% determine element length from end coordinates</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>   <span class="va">L</span> <span class="op">=</span> <span class="va">ElmLenOr</span>(<span class="va">xyz</span>)<span class="op">;</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>   <span class="co">% set up element stiffness matrix</span></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>   <span class="va">k</span>{<span class="va">el</span>} <span class="op">=</span> <span class="va">k_matrix</span> (<span class="va">Model</span>.<span class="va">ElemName</span>{<span class="va">el</span>}<span class="op">,</span><span class="va">ElemData</span>{<span class="va">el</span>}<span class="op">,</span><span class="va">L</span>)<span class="op">;</span></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a><span class="co">% block-diagonal array of element stiffness matrices</span></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a><span class="va">Ks</span> <span class="op">=</span> <span class="va">blkdiag</span> (<span class="va">k</span>{<span class="op">:</span>})<span class="op">;</span></span></code></pre></div>
</div>
<div class="MLbox">
<div class="sourceCode" id="kimpl" data-rulecolor="\color{red}" data-caption="Syntax of the function `k_matrix`." data-startFrom="33"><pre class="sourceCode matlab"><code class="sourceCode matlab" style="counter-reset: source-line 32;"><span id="kimpl-33"><a href="#kimpl-33" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="va">k</span> <span class="op">=</span> <span class="va">k_matrix</span> (<span class="va">ElemName</span><span class="op">,</span><span class="va">ElemData</span><span class="op">,</span><span class="va">L</span>)</span></code></pre></div>
<div class="sourceCode" id="cb29" data-startFrom="38"><pre class="sourceCode matlab"><code class="sourceCode matlab" style="counter-reset: source-line 37;"><span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a><span class="va">E</span>  <span class="op">=</span> <span class="va">ElemData</span>.<span class="va">E</span><span class="op">;</span>    <span class="co">% elastic modulus</span></span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a><span class="va">A</span>  <span class="op">=</span> <span class="va">ElemData</span>.<span class="va">A</span><span class="op">;</span>    <span class="co">% area</span></span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a><span class="va">EA</span> <span class="op">=</span> <span class="va">E</span><span class="op">*</span><span class="va">A</span><span class="op">;</span>           <span class="co">% axial stiffness</span></span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a><span class="kw">switch</span> <span class="va">ElemName</span></span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a>  <span class="kw">case</span> <span class="ss">&#39;LinTruss&#39;</span></span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>    <span class="co">% linear truss element</span></span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>    <span class="va">k</span>  <span class="op">=</span> <span class="va">EA</span><span class="op">/</span><span class="va">L</span><span class="op">;</span></span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a>  <span class="kw">case</span> <span class="ss">&#39;Lin2dFrm&#39;</span></span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a>    <span class="co">% 2d linear frame element</span></span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>    <span class="va">I</span>  <span class="op">=</span> <span class="va">ElemData</span>.<span class="va">I</span><span class="op">;</span></span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a>    <span class="va">EI</span> <span class="op">=</span> <span class="va">E</span><span class="op">*</span><span class="va">I</span><span class="op">;</span></span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a>    <span class="va">f</span>  <span class="op">=</span> [<span class="va">L</span><span class="op">/</span><span class="va">EA</span>   <span class="fl">0</span>          <span class="fl">0</span>       <span class="op">;</span></span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a>           <span class="fl">0</span>    <span class="va">L</span><span class="op">/</span>(<span class="fl">3</span><span class="op">*</span><span class="va">EI</span>)  <span class="op">-</span><span class="va">L</span><span class="op">/</span>(<span class="fl">6</span><span class="op">*</span><span class="va">EI</span>) <span class="op">;</span></span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a>           <span class="fl">0</span>   <span class="op">-</span><span class="va">L</span><span class="op">/</span>(<span class="fl">6</span><span class="op">*</span><span class="va">EI</span>)   <span class="va">L</span><span class="op">/</span>(<span class="fl">3</span><span class="op">*</span><span class="va">EI</span>)]<span class="op">;</span></span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a>    <span class="co">% extract necessary submatrix in the presence of release(s)</span></span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a>    <span class="va">ide</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">;</span></span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> <span class="va">isfield</span>(<span class="va">ElemData</span><span class="op">,</span><span class="ss">&#39;Release&#39;</span>)</span>
<span id="cb29-56"><a href="#cb29-56" aria-hidden="true" tabindex="-1"></a>      <span class="va">idr</span> <span class="op">=</span> <span class="va">find</span>(<span class="va">ElemData</span>.<span class="va">Release</span>)<span class="op">;</span></span>
<span id="cb29-57"><a href="#cb29-57" aria-hidden="true" tabindex="-1"></a>      <span class="va">ide</span> <span class="op">=</span> <span class="va">setdiff</span>(<span class="va">ide</span><span class="op">,</span><span class="va">idr</span>)<span class="op">;</span></span>
<span id="cb29-58"><a href="#cb29-58" aria-hidden="true" tabindex="-1"></a>    <span class="kw">end</span></span>
<span id="cb29-59"><a href="#cb29-59" aria-hidden="true" tabindex="-1"></a>    <span class="va">f</span> <span class="op">=</span> <span class="va">f</span>(<span class="va">ide</span><span class="op">,</span><span class="va">ide</span>)<span class="op">;</span></span>
<span id="cb29-60"><a href="#cb29-60" aria-hidden="true" tabindex="-1"></a>    <span class="co">% invert element flexibility to get basic element stiffness</span></span>
<span id="cb29-61"><a href="#cb29-61" aria-hidden="true" tabindex="-1"></a>    <span class="va">k</span> <span class="op">=</span> <span class="va">inv</span>(<span class="va">f</span>)<span class="op">;</span></span>
<span id="cb29-62"><a href="#cb29-62" aria-hidden="true" tabindex="-1"></a>  <span class="kw">otherwise</span></span>
<span id="cb29-63"><a href="#cb29-63" aria-hidden="true" tabindex="-1"></a>    <span class="va">error</span> (<span class="ss">&#39;only linear truss and 2d frame elements supported&#39;</span>)</span>
<span id="cb29-64"><a href="#cb29-64" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div>
</div>
<div class="MLbox">
<div class="sourceCode" id="q0impl" data-rulecolor="\color{red}" data-caption="" data-startFrom="32"><pre class="sourceCode matlab"><code class="sourceCode matlab" style="counter-reset: source-line 31;"><span id="q0impl-32"><a href="#q0impl-32" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="va">q0</span> <span class="op">=</span> <span class="va">q0_vector</span> (<span class="va">ElemName</span><span class="op">,</span><span class="va">ElemData</span><span class="op">,</span><span class="va">L</span>)</span></code></pre></div>
<div class="sourceCode" id="cb30" data-startFrom="36"><pre class="sourceCode matlab"><code class="sourceCode matlab" style="counter-reset: source-line 35;"><span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a><span class="va">E</span>  <span class="op">=</span> <span class="va">ElemData</span>.<span class="va">E</span><span class="op">;</span>    <span class="co">% elastic modulus</span></span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a><span class="va">A</span>  <span class="op">=</span> <span class="va">ElemData</span>.<span class="va">A</span><span class="op">;</span>    <span class="co">% area</span></span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a><span class="va">EA</span> <span class="op">=</span> <span class="va">E</span><span class="op">*</span><span class="va">A</span><span class="op">;</span>           <span class="co">% axial stiffness</span></span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a><span class="kw">switch</span> <span class="va">ElemName</span></span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a>  <span class="kw">case</span> <span class="ss">&#39;LinTruss&#39;</span></span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a>    <span class="co">% linear truss element</span></span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> <span class="op">~</span><span class="va">isfield</span>(<span class="va">ElemData</span><span class="op">,</span><span class="ss">&#39;e0&#39;</span>)<span class="op">,</span> <span class="va">ElemData</span>.<span class="va">e0</span> <span class="op">=</span> <span class="fl">0</span><span class="op">;</span> <span class="kw">end</span></span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> <span class="op">~</span><span class="va">isfield</span>(<span class="va">ElemData</span><span class="op">,</span><span class="ss">&#39;q0&#39;</span>)<span class="op">,</span> <span class="va">ElemData</span>.<span class="va">q0</span> <span class="op">=</span> <span class="fl">0</span><span class="op">;</span> <span class="kw">end</span></span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a>    <span class="va">e0</span> <span class="op">=</span> <span class="va">ElemData</span>.<span class="va">e0</span><span class="op">;</span>   <span class="co">% initial axial strain</span></span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a>    <span class="va">q0</span> <span class="op">=</span> <span class="va">ElemData</span>.<span class="va">q0</span><span class="op">;</span>   <span class="co">% initial prestressing force</span></span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a>    <span class="va">q0</span> <span class="op">=</span> <span class="va">q0</span> <span class="op">-</span> <span class="va">EA</span><span class="op">*</span><span class="va">e0</span><span class="op">;</span>    <span class="co">% fixed-end force vector</span></span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a>  <span class="kw">case</span> <span class="ss">&#39;Lin2dFrm&#39;</span></span>
<span id="cb30-49"><a href="#cb30-49" aria-hidden="true" tabindex="-1"></a>    <span class="co">% 2d linear frame element</span></span>
<span id="cb30-50"><a href="#cb30-50" aria-hidden="true" tabindex="-1"></a>    <span class="va">I</span>  <span class="op">=</span> <span class="va">ElemData</span>.<span class="va">I</span><span class="op">;</span></span>
<span id="cb30-51"><a href="#cb30-51" aria-hidden="true" tabindex="-1"></a>    <span class="va">EI</span> <span class="op">=</span> <span class="va">E</span><span class="op">*</span><span class="va">I</span><span class="op">;</span></span>
<span id="cb30-52"><a href="#cb30-52" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> <span class="op">~</span><span class="va">isfield</span>(<span class="va">ElemData</span><span class="op">,</span><span class="ss">&#39;e0&#39;</span>)<span class="op">,</span> <span class="va">ElemData</span>.<span class="va">e0</span> <span class="op">=</span> [<span class="fl">0</span><span class="op">;</span><span class="fl">0</span>]<span class="op">;</span> <span class="kw">end</span></span>
<span id="cb30-53"><a href="#cb30-53" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> <span class="op">~</span><span class="va">isfield</span>(<span class="va">ElemData</span><span class="op">,</span><span class="ss">&#39;w&#39;</span>)<span class="op">,</span>  <span class="va">ElemData</span>.<span class="va">w</span>  <span class="op">=</span> [<span class="fl">0</span><span class="op">;</span><span class="fl">0</span>]<span class="op">;</span> <span class="kw">end</span></span>
<span id="cb30-54"><a href="#cb30-54" aria-hidden="true" tabindex="-1"></a>    <span class="va">e0</span> <span class="op">=</span> <span class="va">ElemData</span>.<span class="va">e0</span><span class="op">;</span>   <span class="co">% initial section deformations</span></span>
<span id="cb30-55"><a href="#cb30-55" aria-hidden="true" tabindex="-1"></a>    <span class="va">w</span>  <span class="op">=</span> <span class="va">ElemData</span>.<span class="va">w</span><span class="op">;</span>    <span class="co">% uniformly element load in x and y</span></span>
<span id="cb30-56"><a href="#cb30-56" aria-hidden="true" tabindex="-1"></a>    <span class="co">% 2d linear frame element</span></span>
<span id="cb30-57"><a href="#cb30-57" aria-hidden="true" tabindex="-1"></a>    <span class="va">v0</span> <span class="op">=</span> [<span class="va">e0</span>(<span class="fl">1</span>)<span class="op">*</span><span class="va">L</span><span class="op">;</span> <span class="op">-</span><span class="va">e0</span>(<span class="fl">2</span>)<span class="op">*</span><span class="va">L</span><span class="op">/</span><span class="fl">2</span> <span class="op">;</span> <span class="va">e0</span>(<span class="fl">2</span>)<span class="op">*</span><span class="va">L</span><span class="op">/</span><span class="fl">2</span>]<span class="op">;</span></span>
<span id="cb30-58"><a href="#cb30-58" aria-hidden="true" tabindex="-1"></a>    <span class="va">v0</span> <span class="op">=</span> <span class="va">v0</span> <span class="op">+</span> [<span class="va">w</span>(<span class="fl">1</span>)<span class="op">*</span><span class="va">L</span><span class="op">*</span><span class="va">L</span><span class="op">/</span>(<span class="fl">2</span><span class="op">*</span><span class="va">EA</span>) <span class="op">;</span> <span class="va">w</span>(<span class="fl">2</span>)<span class="op">*</span><span class="va">L</span><span class="op">^</span><span class="fl">3</span><span class="op">/</span>(<span class="fl">24</span><span class="op">*</span><span class="va">EI</span>) <span class="op">;</span> <span class="op">-</span><span class="va">w</span>(<span class="fl">2</span>)<span class="op">*</span><span class="va">L</span><span class="op">^</span><span class="fl">3</span><span class="op">/</span>(<span class="fl">24</span><span class="op">*</span><span class="va">EI</span>)]<span class="op">;</span></span>
<span id="cb30-59"><a href="#cb30-59" aria-hidden="true" tabindex="-1"></a>    <span class="co">% flexibility matrix</span></span>
<span id="cb30-60"><a href="#cb30-60" aria-hidden="true" tabindex="-1"></a>    <span class="va">f</span>  <span class="op">=</span> [<span class="va">L</span><span class="op">/</span><span class="va">EA</span>   <span class="fl">0</span>          <span class="fl">0</span>       <span class="op">;</span></span>
<span id="cb30-61"><a href="#cb30-61" aria-hidden="true" tabindex="-1"></a>           <span class="fl">0</span>    <span class="va">L</span><span class="op">/</span>(<span class="fl">3</span><span class="op">*</span><span class="va">EI</span>)  <span class="op">-</span><span class="va">L</span><span class="op">/</span>(<span class="fl">6</span><span class="op">*</span><span class="va">EI</span>) <span class="op">;</span></span>
<span id="cb30-62"><a href="#cb30-62" aria-hidden="true" tabindex="-1"></a>           <span class="fl">0</span>   <span class="op">-</span><span class="va">L</span><span class="op">/</span>(<span class="fl">6</span><span class="op">*</span><span class="va">EI</span>)   <span class="va">L</span><span class="op">/</span>(<span class="fl">3</span><span class="op">*</span><span class="va">EI</span>)]<span class="op">;</span></span>
<span id="cb30-63"><a href="#cb30-63" aria-hidden="true" tabindex="-1"></a>    <span class="co">% index of continuous element deformations</span></span>
<span id="cb30-64"><a href="#cb30-64" aria-hidden="true" tabindex="-1"></a>    <span class="va">ide</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">;</span></span>
<span id="cb30-65"><a href="#cb30-65" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> <span class="va">isfield</span>(<span class="va">ElemData</span><span class="op">,</span><span class="ss">&#39;Release&#39;</span>)</span>
<span id="cb30-66"><a href="#cb30-66" aria-hidden="true" tabindex="-1"></a>      <span class="va">idr</span> <span class="op">=</span> <span class="va">find</span>(<span class="va">ElemData</span>.<span class="va">Release</span>)<span class="op">;</span></span>
<span id="cb30-67"><a href="#cb30-67" aria-hidden="true" tabindex="-1"></a>      <span class="va">ide</span> <span class="op">=</span> <span class="va">setdiff</span>(<span class="va">ide</span><span class="op">,</span><span class="va">idr</span>)<span class="op">;</span></span>
<span id="cb30-68"><a href="#cb30-68" aria-hidden="true" tabindex="-1"></a>    <span class="kw">end</span></span>
<span id="cb30-69"><a href="#cb30-69" aria-hidden="true" tabindex="-1"></a>    <span class="va">v0</span> <span class="op">=</span> <span class="va">v0</span>(<span class="va">ide</span>)<span class="op">;</span></span>
<span id="cb30-70"><a href="#cb30-70" aria-hidden="true" tabindex="-1"></a>    <span class="va">f</span>  <span class="op">=</span> <span class="va">f</span>(<span class="va">ide</span><span class="op">,</span><span class="va">ide</span>)<span class="op">;</span></span>
<span id="cb30-71"><a href="#cb30-71" aria-hidden="true" tabindex="-1"></a>    <span class="va">q0</span> <span class="op">=</span> <span class="op">-</span><span class="va">f</span><span class="op">\</span><span class="va">v0</span><span class="op">;</span></span>
<span id="cb30-72"><a href="#cb30-72" aria-hidden="true" tabindex="-1"></a>  <span class="kw">otherwise</span></span>
<span id="cb30-73"><a href="#cb30-73" aria-hidden="true" tabindex="-1"></a>    <span class="va">error</span> (<span class="ss">&#39;only linear truss and 2d frame elements supported&#39;</span>)</span>
<span id="cb30-74"><a href="#cb30-74" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div>
</div>
<p><a href="" id="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" data-replace="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" title="../../"><span style="color: blue;font-family: monospace;">FEDEAS</span>Lab</a> function <a href="../../Functions/latest/General/Ks_matrix" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Ks_matrix&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Ks_matrix&lt;/span&gt;"><span style="font-family: monospace">Ks_matrix</span></a>  collects the basic element stiffness matrices into the block-diagonal matrix <span class="math inline">\(\mathbf{K}_s\)</span> according to [B-E:Ks]. Similarly, the function <a href="../../Functions/latest/General/Q0_vector" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Q0_vector&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Q0_vector&lt;/span&gt;"><span style="font-family: monospace">Q0_vector</span></a>  collects the initial element forces into vector <span class="math inline">\(\boldsymbol{Q}_{\raisebox{-1pt}{\scriptstyle{0}}}\)</span>.</p>
<p>The function <a href="../../Functions/latest/General/Ks_matrix" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Ks_matrix&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Ks_matrix&lt;/span&gt;"><span style="font-family: monospace">Ks_matrix</span></a>  calls the internal function <code>k_matrix</code> to set up the stiffness matrix <span class="math inline">\(\mathbf{k}\)</span> for each element according to [B-E:qvgen] with the stiffness for the truss element in [B-E:ka] and the stiffness matrix of the 2d frame element in [B-E:kb] or [B-E:kb4beamwr] depending on the presence of an end moment release. The syntax of function <a href="../../Functions/latest/General/Ks_matrix" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Ks_matrix&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Ks_matrix&lt;/span&gt;"><span style="font-family: monospace">Ks_matrix</span></a>  is shown in [B:Ksmatimpl], while the syntax for the internal function <code>k_matrix</code> is given in [B:kimpl].</p>
<p>The syntax of function <a href="../../Functions/latest/General/Q0_vector" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Q0_vector&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Q0_vector&lt;/span&gt;"><span style="font-family: monospace">Q0_vector</span></a>  is very similar except for the collection of vectors instead of matrices. The function calls the internal function <code>q0_vector</code> with the function syntax in [B:q0impl] to set up the initial force vector <span class="math inline">\(\boldsymbol{q}_0\)</span> of each element according to [B-E:q01], [B-E:q04beam] and [B-E:q04beamwr].</p>
<h1 id="force-method-of-analysis">Force Method of Analysis</h1>
<p>The steps of the force method of analysis are summarized in [B-T:FMsteps]. This step sequence is implemented in the MATLAB  script file <code>S_ForceMethod</code>.</p>
<p>In contrast to a function, a script file operates on the variables in the workspace memory and stores its output also in the workspace memory. <a href="" id="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" data-replace="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" title="../../"><span style="color: blue;font-family: monospace;">FEDEAS</span>Lab</a> makes use of script files for two purposes:</p>
<ol type="1">
<li><p>to define several variables at once and place them in the workspace for easy access or to issue a few simple MATLAB  commands with a single call rather than individually;</p></li>
<li><p>to collect a series of commands involving <a href="" id="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" data-replace="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" title="../../"><span style="color: blue;font-family: monospace;">FEDEAS</span>Lab</a> functions into solution procedures that can be invoked with a single call from the workspace; such scripts are identified with prefix <code>S_</code> and can be easily modified to suit individual needs. The limitation of such a script, however, is that variables serving as input arguments to the functions in the script should be present in the workspace with the same syntax as the function arguments in the script.</p></li>
</ol>
<p>All script variables reside in the MATLAB  workspace and are, therefore, of global character. Such variables may lead to name conflicts, if care is not exercised. In contrast, variables in functions are local and can only be accessed if they appear in the input or output argument list. Clearly, this is the preferred approach for data protection in a modular computing environment. For this reason, scripts are used sparingly in <a href="" id="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" data-replace="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" title="../../"><span style="color: blue;font-family: monospace;">FEDEAS</span>Lab</a>.</p>
<div class="MLbox">
<div id="lst:FMsteps" class="listing matlab">
<p>Listing 8: </p>
<div class="sourceCode" id="cb31" data-startFrom="22"><pre class="sourceCode matlab"><code class="sourceCode matlab" style="counter-reset: source-line 21;"><span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a><span class="co">% form static matrix B for all dofs</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a><span class="va">B</span>  <span class="op">=</span> <span class="va">B_matrix</span> (<span class="va">Model</span>)<span class="op">;</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a><span class="co">% get element cell array for continuous element deformations</span></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a><span class="va">iced</span> <span class="op">=</span> <span class="va">H_index</span> (<span class="va">Model</span><span class="op">,</span><span class="va">ElemData</span>)<span class="op">;</span></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a><span class="co">% concatenate indices to single index vector ic</span></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a><span class="va">ic</span> <span class="op">=</span> [<span class="va">iced</span>{<span class="op">:</span>}]<span class="op">;</span></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a><span class="co">% form Bf matrix without columns corresponding to releases</span></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a><span class="va">Bf</span> <span class="op">=</span> <span class="va">B</span>(<span class="fl">1</span><span class="op">:</span><span class="va">Model</span>.<span class="va">nf</span><span class="op">,</span><span class="va">ic</span>)<span class="op">;</span></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a><span class="co">% determine force influence matrices Bbari, Bbarx</span></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="op">~</span><span class="va">exist</span>(<span class="ss">&#39;ind_r&#39;</span><span class="op">,</span><span class="ss">&#39;var&#39;</span>)<span class="op">,</span> <span class="va">ind_r</span> <span class="op">=</span> []<span class="op">;</span> <span class="kw">end</span></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>[<span class="va">Bbari</span><span class="op">,</span><span class="va">Bbarx</span>] <span class="op">=</span> <span class="va">ForceInfl_matrix</span> (<span class="va">Bf</span><span class="op">,</span><span class="va">ind_r</span>)<span class="op">;</span></span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a><span class="co">% set up Fs matrix and V0 vector</span></span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a><span class="va">Fs</span>  <span class="op">=</span> <span class="va">Fs_matrix</span> (<span class="va">Model</span><span class="op">,</span><span class="va">ElemData</span>)<span class="op">;</span></span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a><span class="va">V0</span>  <span class="op">=</span> <span class="va">V0_vector</span> (<span class="va">Model</span><span class="op">,</span><span class="va">ElemData</span>)<span class="op">;</span></span></code></pre></div>
</div>
<div class="sourceCode" id="cb32" data-startFrom="36"><pre class="sourceCode matlab"><code class="sourceCode matlab" style="counter-reset: source-line 35;"><span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a><span class="co">% determine redundant basic forces</span></span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a><span class="va">Qp</span>  <span class="op">=</span> <span class="va">Bbari</span><span class="op">*</span>(<span class="va">Pf</span><span class="op">-</span><span class="va">Pwf</span>)<span class="op">;</span></span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a><span class="va">Fxx</span> <span class="op">=</span> <span class="va">Bbarx</span><span class="op">&#39;*</span><span class="va">Fs</span><span class="op">*</span><span class="va">Bbarx</span><span class="op">;</span></span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a><span class="va">Qx</span>  <span class="op">=</span> <span class="op">-</span><span class="va">Fxx</span><span class="op">\</span>(<span class="va">Bbarx</span><span class="op">&#39;*</span>(<span class="va">Fs</span><span class="op">*</span><span class="va">Qp</span><span class="op">+</span><span class="va">V0</span>))<span class="op">;</span></span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a><span class="co">% determine final basic forces</span></span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a><span class="va">Q</span>   <span class="op">=</span> <span class="va">Qp</span> <span class="op">+</span> <span class="va">Bbarx</span><span class="op">*</span><span class="va">Qx</span><span class="op">;</span></span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a><span class="co">% determine element deformations Veps (Ve for short)</span></span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a><span class="va">Ve</span>  <span class="op">=</span> <span class="va">Fs</span><span class="op">*</span><span class="va">Q</span> <span class="op">+</span> <span class="va">V0</span><span class="op">;</span></span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a><span class="co">% determine free dof displacements</span></span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a><span class="va">Uf</span>  <span class="op">=</span> <span class="va">Bbari</span><span class="op">&#39;*</span><span class="va">Ve</span><span class="op">;</span></span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a><span class="co">% complete Q vector with release values and return Ve </span></span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a>[<span class="va">Q</span><span class="op">,</span><span class="va">Ve</span>] <span class="op">=</span> <span class="va">Complete_QV</span>(<span class="va">Model</span><span class="op">,</span><span class="va">ElemData</span><span class="op">,</span><span class="va">Q</span>)<span class="op">;</span></span></code></pre></div>
</div>
<p>The script <code>S_ForceMethod</code> depends on the definition of the structural model geometry in the data structure <a href="https://example.com" id="Model" data-replace="Model">Model</a> , and on the specification of the element property and loading information in the data structure <a href="" id="&lt;code&gt;ElemData&lt;/code&gt;" data-replace="&lt;code&gt;ElemData&lt;/code&gt;" title="#sec:Data"><code>ElemData</code></a> . The specification of an index <code>ind_r</code> for the redundant basic forces is optional, as is the specification of the nodal forces <span style="color: blue"><code>Pf</code></span> and <span style="color: blue"><code>Pwf</code></span>. The default value for the nodal forces is zero.</p>
<p>The command sequence for the implementation of the force method of analysis according to [B-T:FMsteps] is divided in two parts in [B:FMsteps]:</p>
<ol type="a">
<li>the setting up of the necessary matrices <span class="math inline">\(\mathbf{B}\)</span>, <span class="math inline">\(\bar{\mathbf{B}}_i\)</span>, <span class="math inline">\(\bar{\mathbf{B}}_x\)</span>, <span class="math inline">\(\mathbf{F}_s\)</span> and the vector <span class="math inline">\(\boldsymbol{V}_{\scriptstyle{0}}\)</span> from information in <a href="https://example.com" id="Model" data-replace="Model">Model</a>  and <a href="" id="&lt;code&gt;ElemData&lt;/code&gt;" data-replace="&lt;code&gt;ElemData&lt;/code&gt;" title="#sec:Data"><code>ElemData</code></a> , and (b) the solution steps of the force method. The script generates the basic forces <span class="math inline">\(\boldsymbol{Q}\)</span> of the structural model, the corresponding element deformations <span class="math inline">\(\boldsymbol{V}_{\varepsilon}\)</span>, and the free DOF displacements <span class="math inline">\(\boldsymbol{U}_f\)</span>. These can be used for response interpretation, as will be discussed in sec. <a href="#sec:Post">12</a>.</li>
</ol>
<p>The script <code>S_ForceMethod</code> uses two auxiliary functions: (a) [func:H_index] to set up a cell array of indices for continuous element deformations from information in the field <code>Release</code> of <a href="" id="&lt;code&gt;ElemData&lt;/code&gt;" data-replace="&lt;code&gt;ElemData&lt;/code&gt;" title="#sec:Data"><code>ElemData</code></a> , and (b) <code>Complete_QV</code> which uses the same information to pad the basic forces <span class="math inline">\(\boldsymbol{Q}\)</span> from the force method of analysis with zero values at the releases, so that it can determine the element deformations <span class="math inline">\(\boldsymbol{V}_{\varepsilon}\)</span> at the ends with flexural releases and plot the deformed shape of the corresponding element, if required.</p>
<h1 id="sec:DMinFL">Displacement Method of Analysis</h1>
<p>The steps of the displacement method of analysis are described in [B-S:KfP0] and [B-S:DMsol]. A summary of these steps for implementation in <a href="" id="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" data-replace="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" title="../../"><span style="color: blue;font-family: monospace;">FEDEAS</span>Lab</a> is:</p>
<ol type="1">
<li><p>With the kinematic matrix <span class="math inline">\(\mathbf{A}_f\)</span> set up the stiffness matrix <span class="math inline">\(\mathbf{K}_f\)</span> and the initial force vector <span class="math inline">\(\boldsymbol{P}_{0}\)</span> <span class="math display">\[
\mathbf{K}_f= \mathbf{A}_f^T\mspace{1.5mu}\mathbf{K}_s\mspace{1.5mu}\mathbf{A}_f
\quad \quad 
\boldsymbol{P}_{0}= \mathbf{A}_f^T\mspace{1.5mu}\boldsymbol{Q}_{0}+ \boldsymbol{P}_{wf}
\]</span></p></li>
<li><p>Solve the equilibrium equations for the free DOF displacements <span class="math inline">\(\boldsymbol{U}_f\)</span> <span class="math display">\[\boxed{ \boldsymbol{P}_f= \mathbf{K}_f\mspace{1.5mu}\boldsymbol{U}_f+ \boldsymbol{P}_{0}}\]</span></p></li>
<li><p>Determine the element deformations <span class="math inline">\(\boldsymbol{V}\)</span> from the kinematic relations <span class="math display">\[\boxed{ \boldsymbol{V}= \mathbf{A}_f\mspace{1.5mu}\boldsymbol{U}_f}\]</span></p></li>
<li><p>Determine the basic forces <span class="math inline">\(\boldsymbol{Q}\)</span> from the collection of element force-deformation relations <span class="math display">\[\boxed{ \boldsymbol{Q}= \mathbf{K}_s\mspace{1.5mu}\boldsymbol{V}+ \boldsymbol{Q}_{0}}\]</span></p></li>
</ol>
<p>[B:DMsteps] shows the implementation of these steps in the MATLAB  script file <code>S_DisplMethod</code>.</p>
<div class="MLbox">
<div id="lst:DMsteps" class="listing matlab">
<p>Listing 9: </p>
<div class="sourceCode" id="cb33" data-startFrom="24"><pre class="sourceCode matlab"><code class="sourceCode matlab" style="counter-reset: source-line 23;"><span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a><span class="co">% form kinematic matrix A for all dofs</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a><span class="va">A</span>  <span class="op">=</span> <span class="va">A_matrix</span> (<span class="va">Model</span>)<span class="op">;</span></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a><span class="co">% get element cell array for continuous element deformations</span></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a><span class="va">iced</span> <span class="op">=</span> <span class="va">H_index</span> (<span class="va">Model</span><span class="op">,</span><span class="va">ElemData</span>)<span class="op">;</span></span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a><span class="co">% concatenate indices to single index vector ic</span></span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a><span class="va">ic</span> <span class="op">=</span> [<span class="va">iced</span>{<span class="op">:</span>}]<span class="op">;</span></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a><span class="co">% form Af matrix for free dofs without rows with release deformations</span></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a><span class="va">Af</span> <span class="op">=</span> <span class="va">A</span>(<span class="va">ic</span><span class="op">,</span><span class="fl">1</span><span class="op">:</span><span class="va">Model</span>.<span class="va">nf</span>)<span class="op">;</span></span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a><span class="co">% set up Ks matrix and Q0 vector</span></span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a><span class="va">Ks</span> <span class="op">=</span> <span class="va">Ks_matrix</span> (<span class="va">Model</span><span class="op">,</span><span class="va">ElemData</span>)<span class="op">;</span></span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a><span class="va">Q0</span> <span class="op">=</span> <span class="va">Q0_vector</span> (<span class="va">Model</span><span class="op">,</span><span class="va">ElemData</span>)<span class="op">;</span></span></code></pre></div>
</div>
<div class="sourceCode" id="cb34" data-caption="" data-startFrom="35"><pre class="sourceCode matlab"><code class="sourceCode matlab" style="counter-reset: source-line 34;"><span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a><span class="co">% set up stiffness matrix Kf and initial force vector P0</span></span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a><span class="va">Kf</span> <span class="op">=</span> <span class="va">Af</span><span class="op">&#39;*</span><span class="va">Ks</span><span class="op">*</span><span class="va">Af</span><span class="op">;</span></span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a><span class="va">P0</span> <span class="op">=</span> <span class="va">Pwf</span> <span class="op">+</span> <span class="va">Af</span><span class="op">&#39;*</span><span class="va">Q0</span><span class="op">;</span></span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a><span class="co">% solve equilibrium equations for free dof displacements Uf</span></span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a><span class="va">Uf</span> <span class="op">=</span> <span class="va">Kf</span><span class="op">\</span>(<span class="va">Pf</span><span class="op">-</span><span class="va">P0</span>)<span class="op">;</span></span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a><span class="co">% determine continuous element deformations V</span></span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a><span class="va">V</span>  <span class="op">=</span> <span class="va">Af</span><span class="op">*</span><span class="va">Uf</span><span class="op">;</span></span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a><span class="co">% determine basic forces Q</span></span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a><span class="va">Q</span>  <span class="op">=</span> <span class="va">Ks</span><span class="op">*</span><span class="va">V</span> <span class="op">+</span> <span class="va">Q0</span><span class="op">;</span></span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a><span class="co">% complete Q vector with release values and return Ve</span></span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a>[<span class="va">Q</span><span class="op">,</span><span class="va">Ve</span>] <span class="op">=</span> <span class="va">Complete_QV</span>(<span class="va">Model</span><span class="op">,</span><span class="va">ElemData</span><span class="op">,</span><span class="va">Q</span>)<span class="op">;</span></span></code></pre></div>
</div>
<p>As is the case with the script for the force method of analysis, the script <code>S_DisplMethod</code> depends on the definition of the structural model geometry in the data structure <a href="https://example.com" id="Model" data-replace="Model">Model</a> , and on the specification of the element property and loading information in the data structure <a href="" id="&lt;code&gt;ElemData&lt;/code&gt;" data-replace="&lt;code&gt;ElemData&lt;/code&gt;" title="#sec:Data"><code>ElemData</code></a> . The specification of the nodal forces <span style="color: blue"><code>Pf</code></span> and <span style="color: blue"><code>Pwf</code></span> is optional with default values equal to zero. The script uses the same auxiliary functions as the script for the force method to remove the rows of the kinematic matrix <span class="math inline">\(\mathbf{A}\)</span> with release deformations and pad the vector of basic forces <span class="math inline">\(\boldsymbol{Q}\)</span> from the displacement method of analysis with zero values at the releases, so that it can determine the element deformations <span class="math inline">\(\boldsymbol{V}_{\varepsilon}\)</span> at the element ends with flexural releases and plot the deformed shape of the corresponding element, if required.</p>
<h1 id="direct-stiffness-assembly">Direct Stiffness Assembly</h1>
<p>[B-S:DStiffImpl] demonstrates the significant advantage of the displacement method over the force method of analysis: the direct assembly of the structure stiffness matrix <span class="math inline">\(\mathbf{K}_f\)</span> and the resisting forces <span class="math inline">\(\boldsymbol{P}_{r}\)</span>. We demonstrate briefly the ease of implementing the direct stiffness assembly in <a href="" id="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" data-replace="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" title="../../"><span style="color: blue;font-family: monospace;">FEDEAS</span>Lab</a> by taking advantage of the array indexing capabilities of MATLAB  described in Appendix [C:ArrayIndx] and avoiding the multiplication by the Boolean array in [B-E:Khat]. The latter approach is symbolically compact but computationally inefficient, because the Boolean matrix <span class="math inline">\(\mathbf{A}_b^{(el)}\)</span> in [B-E:Khat] contains only a few terms of unit value but mostly zeros.</p>
<p>In the direct assembly process the element <span class="math inline">\(\boldsymbol{id}\)</span> array serves as index of the element stiffness coefficients into the structure stiffness matrix <span class="math inline">\(\breve{\mathbf{K}}\)</span>. The <a href="" id="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" data-replace="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" title="../../"><span style="color: blue;font-family: monospace;">FEDEAS</span>Lab</a>  function <code>Kf_matrix.m</code> assembles the complete stiffness matrix <span class="math inline">\(\breve{\mathbf{K}}\)</span> and then extracts the stiffness <span class="math inline">\(\mathbf{K}\)</span> at the free dofs (in practice only the free dof stiffness <span class="math inline">\(\mathbf{K}\)</span> is assembled to save storage).</p>
<div class="MLbox">
<div id="lst:DSImpl" class="listing matlab">
<p>Listing 10: </p>
<div class="sourceCode" id="cb35" data-rulecolor="\color{red}" data-startFrom="1"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="va">Kf</span> <span class="op">=</span> <span class="va">Kf_matrix</span> (<span class="va">Model</span><span class="op">,</span><span class="va">ElemData</span>)</span></code></pre></div>
</div>
<div class="sourceCode" id="cb36" data-startFrom="23"><pre class="sourceCode matlab"><code class="sourceCode matlab" style="counter-reset: source-line 22;"><span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a><span class="va">K</span>  <span class="op">=</span> <span class="va">zeros</span>(<span class="va">nt</span><span class="op">,</span><span class="va">nt</span>)<span class="op">;</span>                     </span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a><span class="kw">for</span> <span class="va">el</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">ne</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>   <span class="co">% locate element in Model and return end coordinates and id array</span></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>   [<span class="va">xyz</span><span class="op">,</span><span class="va">id</span>] <span class="op">=</span> <span class="va">Localize</span>(<span class="va">Model</span><span class="op">,</span><span class="va">el</span>)<span class="op">;</span></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>   <span class="co">% form element stiffness matrix ke in global reference system</span></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>   <span class="va">ke</span> <span class="op">=</span> <span class="va">ke_matrix</span>(<span class="va">Model</span>.<span class="va">ElemName</span>{<span class="va">el</span>}<span class="op">,</span><span class="va">ElemData</span>{<span class="va">el</span>}<span class="op">,</span><span class="va">xyz</span>)<span class="op">;</span></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>   <span class="co">% assemble element stiffness matrix ke into structure matrix K </span></span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>   <span class="va">K</span> (<span class="va">id</span><span class="op">,</span><span class="va">id</span>) <span class="op">=</span> <span class="va">K</span> (<span class="va">id</span><span class="op">,</span><span class="va">id</span>) <span class="op">+</span> <span class="va">ke</span><span class="op">;</span></span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a><span class="va">Kf</span> <span class="op">=</span> <span class="va">K</span>(<span class="fl">1</span><span class="op">:</span><span class="va">nf</span><span class="op">,</span><span class="fl">1</span><span class="op">:</span><span class="va">nf</span>)<span class="op">;</span> <span class="co">% extract stiffness matrix of free dof&#39;s</span></span></code></pre></div>
</div>
<p>lst. <a href="#lst:DSImpl">10</a> shows the function excerpt with the operations of direct stiffness assembly. <code>K</code> corresponds to <span class="math inline">\(\breve{\mathbf{K}}\)</span> and <code>Kf</code> corresponds to <span class="math inline">\(\mathbf{K}\)</span> in the code. The function <code>Kf_matrix.m</code> calls each element by its name, as specified in the field <code>ElemName</code> of <code>Model</code>, gives it its end coordinates and element properties and expects its stiffness matrix in global coordinates as return argument. This operation should be implemented in a separate function for each element, so that new elements can be added with ease. Because we plan to pursue a different implementation in <a href="" id="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" data-replace="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" title="../../"><span style="color: blue;font-family: monospace;">FEDEAS</span>Lab</a>  as will be discussed in the course of Nonlinear Analysis, we include only the truss and the 2d frame element stiffness determination in a subfunction <code>ke_matrix</code> of <code>Kf_matrix.m</code>.</p>
<p>[B-E:kepo] gives the element stiffness matrix of the truss and the 2d frame element in global coordinates. The MATLAB  commands are excerpted in lst. <strong>¿lst:kaImpl?</strong> noting that the stiffness determination of the 2d frame element with basic force releases follows the description in [B-S:DStiffwvh].</p>
<div class="MLbox">
<div id="lst:kaImp" class="listing matlab">
<p>Listing 11: </p>
<div class="sourceCode" id="cb37" data-linclude="docs/Pages/Basic/Function_Code/Kf_matrix.m" data-rulecolor="\color{red}" data-startLine="35" data-endLine="35"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<div class="sourceCode" id="cb38" data-startFrom="40"><pre class="sourceCode matlab"><code class="sourceCode matlab" style="counter-reset: source-line 39;"><span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a><span class="co">% determine element length and orientation (direction cosines of x-axis)</span></span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>[<span class="va">L</span><span class="op">,</span><span class="va">dcx</span>] <span class="op">=</span> <span class="va">ElmLenOr</span>(<span class="va">xyz</span>)<span class="op">;</span></span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a><span class="co">% extract element properties from ElemData</span></span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a><span class="va">E</span>  <span class="op">=</span> <span class="va">ElemData</span>.<span class="va">E</span><span class="op">;</span></span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a><span class="va">A</span>  <span class="op">=</span> <span class="va">ElemData</span>.<span class="va">A</span><span class="op">;</span></span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a><span class="va">EA</span> <span class="op">=</span> <span class="va">E</span> <span class="op">*</span> <span class="va">A</span><span class="op">;</span></span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a><span class="kw">switch</span> <span class="va">ElemName</span></span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a>   <span class="kw">case</span> <span class="ss">&#39;LinTruss&#39;</span></span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a>      <span class="co">% linear truss element</span></span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a>      <span class="co">% transformation matrix from basic to global</span></span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a>      <span class="va">ag</span> <span class="op">=</span> [<span class="op">-</span><span class="va">dcx</span><span class="op">&#39;</span> <span class="va">dcx</span><span class="op">&#39;</span>]<span class="op">;</span></span>
<span id="cb38-53"><a href="#cb38-53" aria-hidden="true" tabindex="-1"></a>      <span class="va">k</span>  <span class="op">=</span> <span class="va">EA</span><span class="op">/</span><span class="va">L</span><span class="op">;</span></span>
<span id="cb38-54"><a href="#cb38-54" aria-hidden="true" tabindex="-1"></a>      <span class="va">ke</span> <span class="op">=</span> <span class="va">ag</span><span class="op">&#39;*</span><span class="va">k</span><span class="op">*</span><span class="va">ag</span><span class="op">;</span></span>
<span id="cb38-55"><a href="#cb38-55" aria-hidden="true" tabindex="-1"></a>   <span class="kw">case</span> <span class="ss">&#39;Lin2dFrm&#39;</span></span>
<span id="cb38-56"><a href="#cb38-56" aria-hidden="true" tabindex="-1"></a>      <span class="co">% 2d linear frame element with or w/o release</span></span>
<span id="cb38-57"><a href="#cb38-57" aria-hidden="true" tabindex="-1"></a>      <span class="co">% transformation matrix from basic to global</span></span>
<span id="cb38-58"><a href="#cb38-58" aria-hidden="true" tabindex="-1"></a>      <span class="va">dXL</span> <span class="op">=</span> <span class="va">dcx</span>(<span class="fl">1</span>)<span class="op">;</span>  <span class="va">dYL</span> <span class="op">=</span> <span class="va">dcx</span>(<span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb38-59"><a href="#cb38-59" aria-hidden="true" tabindex="-1"></a>      <span class="va">ag</span>  <span class="op">=</span> [<span class="op">-</span><span class="va">dXL</span>     <span class="op">-</span><span class="va">dYL</span>     <span class="fl">0</span>   <span class="va">dXL</span>      <span class="va">dYL</span>      <span class="fl">0</span><span class="op">;</span></span>
<span id="cb38-60"><a href="#cb38-60" aria-hidden="true" tabindex="-1"></a>             <span class="op">-</span><span class="va">dYL</span><span class="op">/</span><span class="va">L</span>    <span class="va">dXL</span><span class="op">/</span><span class="va">L</span>   <span class="fl">1</span>   <span class="va">dYL</span><span class="op">/</span><span class="va">L</span>   <span class="op">-</span><span class="va">dXL</span><span class="op">/</span><span class="va">L</span>    <span class="fl">0</span><span class="op">;</span></span>
<span id="cb38-61"><a href="#cb38-61" aria-hidden="true" tabindex="-1"></a>             <span class="op">-</span><span class="va">dYL</span><span class="op">/</span><span class="va">L</span>    <span class="va">dXL</span><span class="op">/</span><span class="va">L</span>   <span class="fl">0</span>   <span class="va">dYL</span><span class="op">/</span><span class="va">L</span>   <span class="op">-</span><span class="va">dXL</span><span class="op">/</span><span class="va">L</span>    <span class="fl">1</span>]<span class="op">;</span></span>
<span id="cb38-62"><a href="#cb38-62" aria-hidden="true" tabindex="-1"></a>      <span class="va">I</span>  <span class="op">=</span> <span class="va">ElemData</span>.<span class="va">I</span><span class="op">;</span></span>
<span id="cb38-63"><a href="#cb38-63" aria-hidden="true" tabindex="-1"></a>      <span class="va">EI</span> <span class="op">=</span> <span class="va">E</span> <span class="op">*</span> <span class="va">I</span><span class="op">;</span></span>
<span id="cb38-64"><a href="#cb38-64" aria-hidden="true" tabindex="-1"></a>      <span class="va">k</span>  <span class="op">=</span> [ <span class="va">EA</span><span class="op">/</span><span class="va">L</span>       <span class="fl">0</span>       <span class="fl">0</span><span class="op">;</span></span>
<span id="cb38-65"><a href="#cb38-65" aria-hidden="true" tabindex="-1"></a>               <span class="fl">0</span>    <span class="fl">4</span><span class="op">*</span><span class="va">EI</span><span class="op">/</span><span class="va">L</span>  <span class="fl">2</span><span class="op">*</span><span class="va">EI</span><span class="op">/</span><span class="va">L</span><span class="op">;</span></span>
<span id="cb38-66"><a href="#cb38-66" aria-hidden="true" tabindex="-1"></a>               <span class="fl">0</span>    <span class="fl">2</span><span class="op">*</span><span class="va">EI</span><span class="op">/</span><span class="va">L</span>  <span class="fl">4</span><span class="op">*</span><span class="va">EI</span><span class="op">/</span><span class="va">L</span>]<span class="op">;</span></span>
<span id="cb38-67"><a href="#cb38-67" aria-hidden="true" tabindex="-1"></a>      <span class="co">% introduce release indices MR</span></span>
<span id="cb38-68"><a href="#cb38-68" aria-hidden="true" tabindex="-1"></a>      <span class="va">MR</span> <span class="op">=</span> <span class="va">zeros</span>(<span class="fl">3</span><span class="op">,</span><span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb38-69"><a href="#cb38-69" aria-hidden="true" tabindex="-1"></a>      <span class="kw">if</span> <span class="va">isfield</span>(<span class="va">ElemData</span><span class="op">,</span><span class="ss">&#39;Release&#39;</span>)<span class="op">,</span> <span class="va">MR</span>(<span class="va">ElemData</span>.<span class="va">Release</span><span class="op">==</span><span class="fl">1</span>) <span class="op">=</span> <span class="fl">1</span><span class="op">;</span> <span class="kw">end</span></span>
<span id="cb38-70"><a href="#cb38-70" aria-hidden="true" tabindex="-1"></a>      <span class="co">% compatibility matrix in the presence of moment release(s)</span></span>
<span id="cb38-71"><a href="#cb38-71" aria-hidden="true" tabindex="-1"></a>      <span class="va">ah</span> <span class="op">=</span> [ <span class="fl">1</span><span class="op">-</span><span class="va">MR</span>(<span class="fl">1</span>)       <span class="fl">0</span>                    <span class="fl">0</span><span class="op">;</span></span>
<span id="cb38-72"><a href="#cb38-72" aria-hidden="true" tabindex="-1"></a>              <span class="fl">0</span>            <span class="fl">1</span><span class="op">-</span><span class="va">MR</span>(<span class="fl">2</span>)        <span class="op">-</span><span class="fl">0.5</span><span class="op">*</span>(<span class="fl">1</span><span class="op">-</span><span class="va">MR</span>(<span class="fl">3</span>))<span class="op">*</span><span class="va">MR</span>(<span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb38-73"><a href="#cb38-73" aria-hidden="true" tabindex="-1"></a>              <span class="fl">0</span>      <span class="op">-</span><span class="fl">0.5</span><span class="op">*</span>(<span class="fl">1</span><span class="op">-</span><span class="va">MR</span>(<span class="fl">2</span>))<span class="op">*</span><span class="va">MR</span>(<span class="fl">3</span>)       <span class="fl">1</span><span class="op">-</span><span class="va">MR</span>(<span class="fl">3</span>)        ]<span class="op">;</span></span>
<span id="cb38-74"><a href="#cb38-74" aria-hidden="true" tabindex="-1"></a>      <span class="co">% transform basic stiffness matrix for release(s)</span></span>
<span id="cb38-75"><a href="#cb38-75" aria-hidden="true" tabindex="-1"></a>      <span class="va">k</span>  <span class="op">=</span> <span class="va">ah</span><span class="op">&#39;*</span><span class="va">k</span><span class="op">*</span><span class="va">ah</span><span class="op">;</span></span>
<span id="cb38-76"><a href="#cb38-76" aria-hidden="true" tabindex="-1"></a>      <span class="co">% transform basic stiffness to global reference</span></span>
<span id="cb38-77"><a href="#cb38-77" aria-hidden="true" tabindex="-1"></a>      <span class="va">ke</span> <span class="op">=</span> <span class="va">ag</span><span class="op">&#39;*</span><span class="va">k</span><span class="op">*</span><span class="va">ag</span><span class="op">;</span></span></code></pre></div>
</div>
<h1 id="plastic-analysis">Plastic Analysis</h1>
<p>According to [B-C:PlAnal] the determination of the collapse load factor of a structural model is possible either with the lower bound theorem of plastic analysis that makes use of the equilibrium equations and the plastic conditions, or with the upper bound theorem of plastic analysis that makes use of the kinematic relations and the plastic work increment of structural mechanisms. Even though the <strong>uniqueness theorem</strong> of plastic analysis states that the collapse load factor is the same with these methods, <a href="" id="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" data-replace="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" title="../../"><span style="color: blue;font-family: monospace;">FEDEAS</span>Lab</a> uses two separate functions to better illustrate the resulting information from each method, which is of equilibrium nature for the lower bound theorem and of kinematic nature for the upper bound theorem. The basic forces at incipient collapse from the lower bound theorem can be used to display the moment distribution at <em>incipient collapse</em>, while the displacement and deformation increments from the upper bound theorem can be used to display the mechanism <em>after the onset of collapse</em>.</p>
<h2 id="sec:PlAnwFlab">Lower Bound Theorem</h2>
<p>The formulation of the lower bound theorem of plastic analysis in [B-E:LBeq] of [B-C:PlAnal] is a <strong>linear programming problem</strong>. Functions for the solution of such problems are available in the Optimization toolbox of MATLAB . In particular, the <code>linprog</code> function of the toolbox is suited for structural problems involving <strong>linear equalities and inequalities</strong>. To set up the input arguments for this function the <a href="" id="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" data-replace="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" title="../../"><span style="color: blue;font-family: monospace;">FEDEAS</span>Lab</a> function  takes the equilibrium matrix <code>Bf</code>, the array of plastic capacities <code>Qpl</code>, and the reference force vector <code>Pref</code> at the free DOFs of the structural model as input arguments. The latter is set up directly or with the help of the function [func:Create_NodalForces] , as discussed in sec. <a href="#sec:SpecNF">5.2</a>. Optional input arguments to the function  are the constant nodal forces <span class="math inline">\(\boldsymbol{P}_{cf}\)</span> and the data structure <code>Options</code> with parameters for the linear programming solution. The default value for the constant nodal forces is zero, while the default parameters for the linear programming function that MATLAB  selects work in most cases. They need to be modified only if numerical difficulties arise.</p>
<div class="MLbox">
<div class="sourceCode" id="cb39" data-startLine="33" data-endLine="43"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<div class="sourceCode" id="cb40" data-startLine="1" data-endLine="4" data-keywordstyle="\normalfont\color{black}"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<p>With this information the function  determines the collapse load factor <code>lambdac</code> and the corresponding basic forces <code>Qc</code> of the structure under the collapse load. The syntax of the plastic analysis function is</p>
<p>[B:PlAnal] shows the input arguments to  for the column-girder assembly of [B-X:PlAColGird]. The output arguments are the collapse load factor <code>lambdac</code> and the corresponding basic forces <code>Qc</code> of the structural model under the collapse load.</p>
<h2 id="sec:UBPlAnwFlab">Upper Bound Theorem</h2>
<p>The formulation of the upper bound theorem of plastic analysis in [B-E:LP4UB], [B-E:LP4UBINC], and [B-E:LPUBEQC] of [B-C:PlAnal] is also a <em>linear programming problem</em>, in fact it is the dual problem of the lower bound theorem in [B-E:LBeq] <span class="citation" data-cites="Strang_1988">[@Strang_1988]</span>.</p>
<p>The <a href="" id="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" data-replace="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" title="../../"><span style="color: blue;font-family: monospace;">FEDEAS</span>Lab</a> function [func:PlasticAnalysis_wUBT] sets up the necessary equality and inequality constraints with input arguments <span class="math inline">\(\mathbf{A}_f\)</span>, <span class="math inline">\(\boldsymbol{Q}_{pl}\)</span>, <span class="math inline">\(\boldsymbol{P}_{ref}\)</span>. It invokes the simplex algorithm for the solution of the linear programming problem and returns the collapse load factor <span class="math inline">\(\lambda_c\)</span>, and the displacement rates <span class="math inline">\(\dot{\boldsymbol{U}}_f\)</span> as displacement increments <code>DUf</code> and the plastic hinge deformation rates <span class="math inline">\(\dot{\boldsymbol{V}}_{hp}\)</span> as plastic deformation increments <code>DVhp</code> of the collapse mechanism. The syntax is</p>
<p>[B:UB4PorFr] shows the input arguments to <code>PlasticAnalysis_wUBT</code> for the portal frame of [B-X:PlUB4PortalFrame]. The function output consists of the collapse load factor <code>lambdac</code>, the corresponding displacement increments <code>DUf</code>, and the plastic hinge deformation increments <code>DVhp</code> of the collapse mechanism. The values match those from [B-X:PlUB4PortalFrame].</p>
<h1 id="sec:Post">Graphics Utility Functions</h1>
<p><a href="" id="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" data-replace="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" title="../../"><span style="color: blue;font-family: monospace;">FEDEAS</span>Lab</a>  has functions for displaying on the computer screen the geometry of the model and the results of the analysis in the form of internal force distributions, deformed shape, and plastic hinge locations. The graphics utility functions are listed in Table <a href="#tbl:GraphUtil">5</a> and are briefly described in the following. These functions depend on several supporting functions in the folder <code>Utilities</code>, which are of no further interest for the user.</p>
<p>Specifically:</p>
<ul>
<li><p>The function <a href="../../Functions/latest/Utilities/Plotting/Create_Window" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Create_Window&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Create_Window&lt;/span&gt;"><span style="font-family: monospace">Create_Window</span></a> opens an empty window with two input arguments <code>DX</code> and <code>DY</code> for the percentage of the computer screen that the window occupies in the horizontal and in the vertical direction, respectively. Thus, the function call <code class="sourceCode matlab"><span class="va">Create_Window</span>(<span class="fl">0.80</span><span class="op">,</span><span class="fl">0.60</span>)</code> creates an empty window centered on the computer display and occupying 80% of the horizontal display and 60% of the vertical display dimension.</p></li>
<li><p>The function <code>Plot_Model</code> displays the nodes of the structural model connected by straight lines (the element chords).</p></li>
<li><p>The presence of the optional input argument <code>Uf</code> in any plotting function ensures that the information is displayed in the deformed configuration.</p></li>
<li><p>The optional input argument <code>Options</code> in a plotting function is a data structure with fields specifying the attributes of graphical elements. Field descriptions of the data structure <code>Options</code> are given in Table <a href="#tbl:OptPlotModel">7</a>-Table <a href="#tbl:OptPlHng">12</a> for the different plotting functions. Because some fields appear in more than one function, the user should make sure to change the field value before invoking the corresponding function, lest the last definition of the field is used, which may not be the intention.</p></li>
<li><p>The function <code>Label_Model</code> displays node and element numbers of the structural model as well as the coordinate axes for the geometry description.</p></li>
<li><p>The functions for plotting the axial force, the bending moment and the curvature distribution support an optional numerical input argument <code>Scale</code> for the magnification of the distribution display without affecting the numerical values of the internal forces and deformations.</p></li>
<li><p>The functions for labeling the axial force and the bending moment distribution support an optional integer input argument <code>Digit</code> for the number of digits after the comma to display. The default is 1.</p></li>
<li><p>The functions for labeling the axial force and the bending moment distribution support an optional character input argument <code>Units</code>, so that the values of the corresponding internal force are scaled to the specified unit of axial force or bending moment. The function <code>Create_Units.m</code> generates different units of force, moment, length and area in the return argument. The user can define additional dependent units in terms of those already present in the fields of the return argument.</p></li>
<li><p>Plotting and labeling can be limited to some elements of the structural model with the optional argument <code>ElemList</code>. The default option is to display the requested information for all elements of the structural model.</p></li>
<li><p>In the absence of the input argument <code>ElemData</code> the corresponding plot function will display the moment distribution and the deformed shape for the homogeneous solution of the element equilibrium. The field <code>w</code> must be specified in <code>ElemData</code> for the function to display the moment distribution and the deformed shape for the complete solution that includes the particular solution under the element loading.</p></li>
<li><p>The variable <code>Ve</code> corresponds to <span class="math inline">\(\boldsymbol{V}_{\varepsilon}\)</span>, the element deformations of continuous nature.</p></li>
</ul>
<div id="tbl:OptPlotModel">
<table>
<caption>Table 7: Fields of the optional input argument <code>Options</code> for function <span style="color: blue"><code>Plot_Model</code></span></caption>
<thead>
<tr class="header">
<th style="text-align: center;"> Field name  </th>
<th style="text-align: left;"> Purpose  </th>
<th style="text-align: center;"> Default value  </th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"> <code>MAGF</code>  </td>
<td style="text-align: left;"> magnification for deformed wireframe  </td>
<td style="text-align: center;"> 10  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>PlNod</code> </td>
<td style="text-align: left;"> switch for displaying node symbols  </td>
<td style="text-align: center;">  <code>'no'</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>PlBnd</code> </td>
<td style="text-align: left;"> switch for displaying boundary symbols  </td>
<td style="text-align: center;">  <code>'no'</code>  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>NodSF</code> </td>
<td style="text-align: left;"> scale factor for node symbol  </td>
<td style="text-align: center;"> 1  </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>PlJnt</code> </td>
<td style="text-align: left;"> switch for displaying rigid joint offsets  </td>
<td style="text-align: center;"> <code>'yes'</code>  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>LnStl</code> </td>
<td style="text-align: left;"> line style for undeformed/deformed model  </td>
<td style="text-align: center;"> ‘-’ / ‘-.’  </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>LnWth</code> </td>
<td style="text-align: left;"> line thickness  </td>
<td style="text-align: center;"> 2  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>LnClr</code> </td>
<td style="text-align: left;"> line color for undeformed/deformed model  </td>
<td style="text-align: center;"> <code>'b'</code> / ‘k’  </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>BsClr</code> </td>
<td style="text-align: left;"> color for boundary node and symbol  </td>
<td style="text-align: center;"> [0.6 0 0.6]  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>ModSF</code> </td>
<td style="text-align: left;"> switch for adjusting the scale factor with element size  </td>
<td style="text-align: center;"> ‘yes’  </td>
</tr>
</tbody>
</table>
</div>
<div id="tbl:OptLabModel">
<table>
<caption>Table 8: Fields of the optional input argument <code>Options</code> for function <span style="color: blue"><code>Label_Model</code></span></caption>
<thead>
<tr class="header">
<th style="text-align: center;"> Field name  </th>
<th style="text-align: left;"> Purpose  </th>
<th style="text-align: center;"> Default value  </th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"> <code>Item</code>  </td>
<td style="text-align: left;"> ‘node’,‘elem’ or ‘axes’  </td>
<td style="text-align: center;">  <code>'all'</code> </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>FntSF</code> </td>
<td style="text-align: left;"> label font scale factor  </td>
<td style="text-align: center;"> 1  </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>AxsSF</code> </td>
<td style="text-align: left;"> coordinate axes arrow scale factor  </td>
<td style="text-align: center;"> 1  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>LOfSF</code> </td>
<td style="text-align: left;"> label offset scale factor  </td>
<td style="text-align: center;"> 1  </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>NList</code> </td>
<td style="text-align: left;"> list of nodes to label  </td>
<td style="text-align: center;"> <code>1:nn</code>  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>EList</code> </td>
<td style="text-align: left;"> list of elements to label  </td>
<td style="text-align: center;"> <code>1:ne</code>  </td>
</tr>
</tbody>
</table>
</div>
<div id="tbl:OptPlotNForc">
<table>
<caption>Table 9: Some fields of the optional input argument <code>Options</code> for function <span style="color: blue"><code>Plot_NodalForces</code></span></caption>
<thead>
<tr class="header">
<th style="text-align: center;"> Field name  </th>
<th style="text-align: left;"> Purpose  </th>
<th style="text-align: center;"> Default value  </th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"> <code>FrcSF</code>  </td>
<td style="text-align: left;"> scale factor for force arrow shaft  </td>
<td style="text-align: center;"> 1  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>TipSF</code> </td>
<td style="text-align: left;"> scale factor for force arrow tip  </td>
<td style="text-align: center;"> 1  </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>ArWth</code> </td>
<td style="text-align: left;"> line width for force arrow shaft  </td>
<td style="text-align: center;"> 3  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>ArClr</code> </td>
<td style="text-align: left;"> nodal force arrow color  </td>
<td style="text-align: center;"> ‘r’  </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>Label</code> </td>
<td style="text-align: left;"> ‘yes’ / ‘no’ for labeling nodal force    ‘No’  </td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>FntSF</code> </td>
<td style="text-align: left;"> scale factor for nodal force label  </td>
<td style="text-align: center;"> 1  </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>Digit</code> </td>
<td style="text-align: left;"> number of digits for nodal force label  </td>
<td style="text-align: center;"> 2  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>Units</code> </td>
<td style="text-align: left;"> force units  </td>
<td style="text-align: center;"> base unit  </td>
</tr>
</tbody>
</table>
</div>
<div id="tbl:OptPlRel">
<table>
<caption>Table 10: Fields of optional input argument <code>Options</code> for function <span style="color: blue"><code>Plot_Releases</code></span></caption>
<thead>
<tr class="header">
<th style="text-align: center;"> Field name  </th>
<th style="text-align: left;"> Purpose  </th>
<th style="text-align: center;"> Default value  </th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"> <code>MAGF</code>  </td>
<td style="text-align: left;"> magnification factor for deformed model  </td>
<td style="text-align: center;"> 10  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>HngSF</code>  </td>
<td style="text-align: left;"> scale factor for size of hinge symbol  </td>
<td style="text-align: center;"> 1  </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>HOfSF</code>  </td>
<td style="text-align: left;"> factor for hinge symbol offset from element end  </td>
<td style="text-align: center;"> 1  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>AHClr</code>  </td>
<td style="text-align: left;"> display color for axial releases  </td>
<td style="text-align: center;"> light gray  </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>FHClr</code>  </td>
<td style="text-align: left;"> display color for flexural releases  </td>
<td style="text-align: center;"> white  </td>
</tr>
</tbody>
</table>
</div>
<div id="tbl:OptDefoStr">
<table>
<caption>Table 11: Fields of optional input argument <code>Options</code> for function <span style="color: blue"><code>Plot_DeformedStructure</code></span></caption>
<thead>
<tr class="header">
<th style="text-align: center;"> Field name  </th>
<th style="text-align: left;"> Purpose  </th>
<th style="text-align: center;"> Default value  </th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"> <code>MAGF</code>  </td>
<td style="text-align: left;"> magnification for deformed configuration  </td>
<td style="text-align: center;"> 10  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>EList</code> </td>
<td style="text-align: left;"> list of elements to include in deformed shape  </td>
<td style="text-align: center;"> <code>1:ne</code>  </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>PlBnd</code> </td>
<td style="text-align: left;"> switch for displaying boundary symbols  </td>
<td style="text-align: center;"> ‘Yes’  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>NodSF</code> </td>
<td style="text-align: left;"> scale factor for size of boundary symbol  </td>
<td style="text-align: center;"> 1  </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>PlJnt</code> </td>
<td style="text-align: left;"> switch for displaying rigid joint offsets  </td>
<td style="text-align: center;"> ‘Yes’  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>PlCrd</code> </td>
<td style="text-align: left;"> switch for displaying element chord  </td>
<td style="text-align: center;"> ‘No’  </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>PlRel</code> </td>
<td style="text-align: left;"> switch for displaying element releases  </td>
<td style="text-align: center;"> ‘Yes’  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>LnStl</code> </td>
<td style="text-align: left;"> line style for deformed shape  </td>
<td style="text-align: center;"> ‘-’  </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>LnWth</code> </td>
<td style="text-align: left;"> line thickness for deformed shape  </td>
<td style="text-align: center;"> 2  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>LnClr</code> </td>
<td style="text-align: left;"> line color for deformed shape  </td>
<td style="text-align: center;"> ‘r’  </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>BsClr</code> </td>
<td style="text-align: left;"> color for boundary node and symbol  </td>
<td style="text-align: center;"> [0.6 0 0.6]  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>HngSF</code> </td>
<td style="text-align: left;"> scale factor for size of release symbol  </td>
<td style="text-align: center;"> 1  </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>HOfSF</code> </td>
<td style="text-align: left;"> scale factor for flexural hinge symbol offset from element end  </td>
<td style="text-align: center;"> 1  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>AHClr</code>  </td>
<td style="text-align: left;"> display color for axial releases  </td>
<td style="text-align: center;"> light gray  </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>FHClr</code>  </td>
<td style="text-align: left;"> display color for flexural releases  </td>
<td style="text-align: center;"> white  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>ModSF</code> </td>
<td style="text-align: left;"> switch for adjusting the scale factor with element size  </td>
<td style="text-align: center;"> ‘yes’  </td>
</tr>
</tbody>
</table>
</div>
<div id="tbl:OptPlHng">
<table>
<caption>Table 12: Fields of optional input argument <code>Options</code> for function <a href="../../Functions/latest/Utilities/Plotting/Structure/Plot_PlasticHinges" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Plot_PlasticHinges&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Plot_PlasticHinges&lt;/span&gt;"><span style="font-family: monospace">Plot_PlasticHinges</span></a></caption>
<thead>
<tr class="header">
<th style="text-align: center;"> Field name  </th>
<th style="text-align: left;"> Purpose  </th>
<th style="text-align: center;"> Default value  </th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"> <code>EList</code> </td>
<td style="text-align: left;"> list of elements for which plastic hinges are displayed  </td>
<td style="text-align: center;"> <code class="sourceCode matlab"><span class="fl">1</span><span class="op">:</span><span class="va">ne</span></code></td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>HngSF</code> </td>
<td style="text-align: left;"> scale factor for size of plastic hinge symbol  </td>
<td style="text-align: center;"><code>1</code> </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>HOfSF</code> </td>
<td style="text-align: left;"> scale factor for flexural hinge offset from element end  </td>
<td style="text-align: center;"><code>1</code> </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>FHClr</code> </td>
<td style="text-align: left;"> flexural hinge color  </td>
<td style="text-align: center;">  <code>'r'</code> </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>CHClr</code> </td>
<td style="text-align: left;"> color for column hinge with <span class="math inline">\(N\)</span>-<span class="math inline">\(M\)</span> interaction  </td>
<td style="text-align: center;"> <code class="sourceCode matlab">[<span class="fl">1</span> <span class="fl">0.6</span> <span class="fl">0</span>]</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>AHClr</code> </td>
<td style="text-align: left;"> axial hinge color in truss elements  </td>
<td style="text-align: center;"> <code>[1 0.6 0]</code>  </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>tol</code> </td>
<td style="text-align: left;"> relative tolerance for plastic capacity check  </td>
<td style="text-align: center;"> <span class="math inline">\(10^{-6}\)</span>  </td>
</tr>
</tbody>
</table>
</div>
<h1 id="examples">Examples</h1>
<p>The examples in this section showcase the main graphics utility functions with further details about features. A separate MATLAB  script file is available for each example in the course reader with the file name starting with the prefix <code>ChmExn</code> corresponding to the example n in Chapter m of the reader. Salient excerpts from some of these script files are used in the following to showcase the <a href="" id="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" data-replace="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" title="../../"><span style="color: blue;font-family: monospace;">FEDEAS</span>Lab</a> functions in the preceding sections and, in particular, the graphics utility functions.</p>
<h2 id="plotting-and-labeling-of-model">Plotting and Labeling of Model</h2>
<p>Once the function [func:Create_SimpleModel] creates the data structure <a href="https://example.com" id="Model" data-replace="Model">Model</a>   the information about the geometry of the model can be displayed with the functions <code>Plot_Model</code> and <code>Label_Model</code>. The default values for the graphic objects of these functions may result in an unsatisfactory image: disproportionately small size of labels and disproportionately large coordinate axes. Moreover, the default option for the function <a href="../../Functions/latest/Utilities/Plotting/Structure/Plot_Model" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Plot_Model&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Plot_Model&lt;/span&gt;"><span style="font-family: monospace">Plot_Model</span></a> does not display node and boundary symbols in Fig. <a href="#fig:PoorSizeMod">3</a>.</p>
<div class="sourceCode" id="cb41" data-startFrom="62"><pre class="sourceCode matlab"><code class="sourceCode matlab" style="counter-reset: source-line 61;"><span id="cb41-62"><a href="#cb41-62" aria-hidden="true" tabindex="-1"></a><span class="va">Create_Window</span> (<span class="fl">0.50</span><span class="op">,</span><span class="fl">0.80</span>)<span class="op">;</span></span>
<span id="cb41-63"><a href="#cb41-63" aria-hidden="true" tabindex="-1"></a><span class="va">Plot_Model</span>  (<span class="va">Model</span>)<span class="op">;</span>               </span>
<span id="cb41-64"><a href="#cb41-64" aria-hidden="true" tabindex="-1"></a><span class="va">Label_Model</span> (<span class="va">Model</span>)<span class="op">;</span>               </span></code></pre></div>
<figure>
<img src="Function_Code/Ex4_1F2a.png" id="fig:PoorSizeMod" style="width:95.0%" alt="Figure 3: Display of 2d truss model with default values for graphic objects" /><figcaption aria-hidden="true">Figure 3: Display of 2d truss model with default values for graphic objects</figcaption>
</figure>
<p>After turning on the fields <code>PlNod</code> and <code>PlBnd</code> in <code>PlotOpt</code>, adjusting the size of the node and boundary symbols with <code>NodSF</code>, adjusting the size of the coordinate axes with <code>AxsSF</code>, and adjusting the size and offset of labels with <code>FntSz</code> and <code>LOfSz</code>, respectively, the resulting display in Fig. <a href="#fig:GoodSizeMod">4</a> is improved significantly.</p>
<div class="sourceCode" id="cb42" data-caption="" data-startFrom="68"><pre class="sourceCode matlab"><code class="sourceCode matlab" style="counter-reset: source-line 67;"><span id="cb42-68"><a href="#cb42-68" aria-hidden="true" tabindex="-1"></a><span class="va">Create_Window</span> (<span class="fl">0.50</span><span class="op">,</span><span class="fl">0.80</span>)<span class="op">;</span>                </span>
<span id="cb42-69"><a href="#cb42-69" aria-hidden="true" tabindex="-1"></a><span class="va">PlotOpt</span>.<span class="va">PlNod</span> <span class="op">=</span> <span class="ss">&#39;yes&#39;</span><span class="op">;</span></span>
<span id="cb42-70"><a href="#cb42-70" aria-hidden="true" tabindex="-1"></a><span class="va">PlotOpt</span>.<span class="va">PlBnd</span> <span class="op">=</span> <span class="ss">&#39;yes&#39;</span><span class="op">;</span></span>
<span id="cb42-71"><a href="#cb42-71" aria-hidden="true" tabindex="-1"></a><span class="va">PlotOpt</span>.<span class="va">NodSF</span> <span class="op">=</span> <span class="fl">0.6</span><span class="op">;</span></span>
<span id="cb42-72"><a href="#cb42-72" aria-hidden="true" tabindex="-1"></a><span class="va">Plot_Model</span>  (<span class="va">Model</span><span class="op">,</span>[]<span class="op">,</span><span class="va">PlotOpt</span>)<span class="op">;</span>           </span>
<span id="cb42-73"><a href="#cb42-73" aria-hidden="true" tabindex="-1"></a><span class="va">LblOpt</span>.<span class="va">AxsSF</span> <span class="op">=</span> <span class="fl">0.5</span><span class="op">;</span></span>
<span id="cb42-74"><a href="#cb42-74" aria-hidden="true" tabindex="-1"></a><span class="va">LblOpt</span>.<span class="va">FntSF</span> <span class="op">=</span> <span class="fl">2</span><span class="op">;</span></span>
<span id="cb42-75"><a href="#cb42-75" aria-hidden="true" tabindex="-1"></a><span class="va">LblOpt</span>.<span class="va">LOfSF</span> <span class="op">=</span> <span class="fl">1.3</span><span class="op">;</span></span>
<span id="cb42-76"><a href="#cb42-76" aria-hidden="true" tabindex="-1"></a><span class="va">Label_Model</span> (<span class="va">Model</span><span class="op">,</span><span class="va">LblOpt</span>)<span class="op">;</span>               </span></code></pre></div>
<figure>
<img src="Function_Code/Ex4_1F2b.png" id="fig:GoodSizeMod" style="width:95.0%" alt="Figure 4: Improved display of 2d truss with custom values for plot options" /><figcaption aria-hidden="true">Figure 4: Improved display of 2d truss with custom values for plot options</figcaption>
</figure>
<p>The default sizing and labeling values produce satisfactory results for the 3d truss model in Fig. <a href="#fig:GoodSz3dTruss">5</a>, as long as the user requests that the node and boundary symbols be displayed.</p>
<div class="sourceCode" id="cb43" data-startLine="55" data-endLine="59"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<figure>
<img src="Function_Code/Ex4_2F1.png" id="fig:GoodSz3dTruss" style="width:75.0%" alt="Figure 5: Satisfactory display of 3d truss with default values for graphic objects" /><figcaption aria-hidden="true">Figure 5: Satisfactory display of 3d truss with default values for graphic objects</figcaption>
</figure>
<h2 id="plotting-of-nodal-forces-and-element-loading">Plotting of Nodal Forces and Element Loading</h2>
<p>The function <code>Plot_NodalForces</code> displays the nodal forces <code>Pe</code> <strong>before these are assigned to the free DOFs of the structural model by the function</strong> <code>Create_NodalForces</code>. It is expedient to prevent the display of node symbols in <code>Plot_Model</code>. The nodal force values are displayed by turning on the field <code>Label</code> in <code>PlotOpt</code>. The size of the arrow can be customized with the field <code>FrcSF</code>.</p>
<div class="sourceCode" id="cb44" data-startLine="77" data-endLine="82"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<figure>
<img src="Function_Code/Ex4_2F2.png" style="width:75.0%" alt="image" /><figcaption aria-hidden="true">image</figcaption>
</figure>
<p>The function <code>Plot_ElemLoading</code> displays the element loads specified in field <code>w</code> and the element deformations in field <code>e0</code> of the data object <a href="" id="&lt;code&gt;ElemData&lt;/code&gt;" data-replace="&lt;code&gt;ElemData&lt;/code&gt;" title="#sec:Data"><code>ElemData</code></a> . The size of the arrow for the element loading can be customized with the field <code>FrcSF</code> and the size of the arrow tip with the field <code>TipSF</code>. Calling the function <code>Plot_Model</code> <strong>after</strong> calling <code>Plot_ElemLoading</code> and <strong>not before</strong> ensures that the node and boundary symbols are clearly visible in Fig. <a href="#fig:ElemLoad">6</a>.</p>
<div class="sourceCode" id="cb45" data-startLine="59" data-endLine="65"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<figure>
<img src="Function_Code/Ex4_5F2.png" id="fig:ElemLoad" style="width:65.0%" alt="Figure 6: Display of the uniformly distributed element load w for the simple frame with an inclined element from [B-X:InclFrm]" /><figcaption aria-hidden="true">Figure 6: Display of the uniformly distributed element load <span class="math inline">\(w\)</span><br />
for the simple frame with an inclined element from [B-X:InclFrm]</figcaption>
</figure>
<h2 id="plotting-of-releases-for-internal-forces">Plotting of Releases for Internal Forces</h2>
<p>The function <code>Plot_Releases</code> displays the internal force releases. End moment releases for truss elements are displayed automatically with default values when invoking the function. The size and offset of the moment release symbol can be adjusted with the fields <code>HngSF</code> and <code>HOfSF</code>.</p>
<div class="sourceCode" id="cb46" data-startLine="49" data-endLine="58"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<figure>
<img src="Function_Code/Ex4_7F1.png" alt="image" /><figcaption aria-hidden="true">image</figcaption>
</figure>
<div class="sourceCode" id="cb47" data-startLine="47" data-endLine="59"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<figure>
<img src="Function_Code/Ex4_6F1.png" id="fig:MomRel" alt="Figure 7: Display of the end moment release for the three hinge portal frame of [B-X:StatDetFrm]" /><figcaption aria-hidden="true">Figure 7: Display of the end moment release for the three hinge portal frame of [B-X:StatDetFrm]</figcaption>
</figure>
<p>For frame elements the display of internal force releases depends on the field <code>Release</code> of the data structure <a href="" id="&lt;code&gt;ElemData&lt;/code&gt;" data-replace="&lt;code&gt;ElemData&lt;/code&gt;" title="#sec:Data"><code>ElemData</code></a> . The entries of the field in Fig. <a href="#fig:MomRel">7</a> indicate the presence of an end moment release at end <span class="math inline">\(i\)</span> of element <span class="math inline">\(c\)</span> for the model of a three hinge portal frame.</p>
<h2 id="plotting-and-labeling-of-axial-force-distribution">Plotting and Labeling of Axial Force Distribution</h2>
<p>The script excerpt in [B:Qplotcom] displays and labels the axial forces <span class="math inline">\(\boldsymbol{Q}\)</span> in Fig. <a href="#fig:Qplot">8</a> for the plane truss of [B-X:StatDetTruss]. The optional input argument <code>ScaleN</code> in <code>Plot_AxialForces</code> controls the scaling of the axial force distribution, while the optional input argument <code>NDigt=2</code> in <code>Label_AxialForces</code> requests 2 digits after the comma for the label of the axial force value. A tensile axial force distribution is shown in blue and a compressive axial force in red.</p>
<div class="sourceCode" id="cb48" data-startLine="105" data-endLine="110"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<figure>
<img src="Function_Code/Ex4_1F1.png" id="fig:Qplot" style="width:70.0%" alt="Figure 8: Axial force distribution for the truss of [B-X:StatDetTruss]" /><figcaption aria-hidden="true">Figure 8: Axial force distribution for the truss of [B-X:StatDetTruss]</figcaption>
</figure>
<h2 id="plotting-and-labeling-of-bending-moment-distribution">Plotting and Labeling of Bending Moment Distribution</h2>
<div class="sourceCode" id="cb49" data-startLine="88" data-endLine="93"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<figure>
<img src="Function_Code/Ex4_4F2.png" id="fig:MomPlotwow" style="width:55.0%" alt="Figure 9: Bending moment distribution for the homogeneous solution of the beam from [B-X:StatDetBeamww]" /><figcaption aria-hidden="true">Figure 9: Bending moment distribution for the homogeneous solution of the beam from [B-X:StatDetBeamww]</figcaption>
</figure>
<p>The script excerpt in [B:MPlotwow] uses the basic forces <span class="math inline">\(\boldsymbol{Q}\)</span> to display and label the bending moments in Fig. <a href="#fig:MomPlotwow">9</a> for the beam with overhang of [B-X:StatDetBeamww]. Without specification of the value for the distributed element loading in the field <code>w</code> of <a href="" id="&lt;code&gt;ElemData&lt;/code&gt;" data-replace="&lt;code&gt;ElemData&lt;/code&gt;" title="#sec:Data"><code>ElemData</code></a>  the function "is not aware" of the presence of element loads and <em>only displays the homogeneous solution</em> for the bending moment distribution.</p>
<div class="MLbox">
<div class="sourceCode" id="cb50" data-startLine="97" data-endLine="100"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<figure>
<img src="Function_Code/Ex4_4F3.png" id="fig:MomPlotww" style="width:55.0%" alt="Figure 10: Bending moment distribution for the complete solution of the beam from [B-X:StatDetBeamww]" /><figcaption aria-hidden="true">Figure 10: Bending moment distribution for the complete solution of the beam from [B-X:StatDetBeamww]</figcaption>
</figure>
<p>The script excerpt in [B:MPlotww] includes the input argument <a href="" id="&lt;code&gt;ElemData&lt;/code&gt;" data-replace="&lt;code&gt;ElemData&lt;/code&gt;" title="#sec:Data"><code>ElemData</code></a>  in the call to the function <code>Plot_2dMomntDistr</code>, so that it can display the complete solution by superposing the particular solution for element <span class="math inline">\(b\)</span> to the homogeneous solution of Fig. <a href="#fig:MomPlotwow">9</a>.</p>
<h2 id="plotting-of-deformed-shape">Plotting of Deformed Shape</h2>
<p>The script excerpt in Fig. <a href="#fig:DefoTrwDV">11</a> uses the free DOF displacements <code>Uf</code> under the initial element deformations <code>V0</code> in [B:TrussKinem] to display the resulting deformed shape for the truss of [B-X:KinDetTruss] with the help of the function <code>Plot_DeformedStructure</code>. The input arguments <code>ElemData</code> and <code>Veps</code> to the function are not required for the case in hand.</p>
<div class="sourceCode" id="cb51" data-startLine="67" data-endLine="70"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<figure>
<img src="Function_Code/Ex5_1F1.png" id="fig:DefoTrwDV" alt="Figure 11: Deformed shape for plane truss of [B-X:KinDetTruss]" /><figcaption aria-hidden="true">Figure 11: Deformed shape for plane truss of [B-X:KinDetTruss]</figcaption>
</figure>
<p>Fig. <a href="#fig:DefoTrwDV">11</a> shows the deformed shape of the truss with default values under a magnification factor <code>MAGF</code> of 30. The function displays the releases of internal forces by default, which may not be desirable for truss models. The function also displays the boundary symbols by default, but the default size value is disproportionately large for the model in Fig. <a href="#fig:DefoTrwDV">11</a>.</p>
<div class="sourceCode" id="cb52" data-startLine="73" data-endLine="78"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<figure>
<img src="Function_Code/Ex5_1F2.png" id="fig:DefoTrwCV" style="width:92.0%" alt="Figure 12: Improved display of deformed shape for plane truss of [B-X:KinDetTruss]" /><figcaption aria-hidden="true">Figure 12: Improved display of deformed shape for plane truss of [B-X:KinDetTruss]</figcaption>
</figure>
<p>Fig. <a href="#fig:DefoTrwCV">12</a> shows the improvement of the display for the deformed shape of the truss by suppressing the display of internal force releases and scaling the boundary symbols to a quarter of the default value.</p>
<div class="sourceCode" id="cb53" data-startLine="61" data-endLine="64"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<figure>
<img src="Function_Code/Ex5_1F3.png" id="fig:DefoTrCrd" width="0" alt="Figure 13: Deformed shape for the plane truss of [B-X:KinDetTruss]" /><figcaption aria-hidden="true">Figure 13: Deformed shape for the plane truss of [B-X:KinDetTruss]</figcaption>
</figure>
<p>Fig. <a href="#fig:DefoTrCrd">13</a> shows that the deformed shape of a truss model can also be displayed with the function <code>Plot_Model</code> by including the free dof displacements <code>Uf</code> as the second input argument. This instructs the function to connect the nodes of the model in the deformed configuration by straight lines and can, therefore, be used for elements with straight edges to display the deformed shape of the structure. The default option is not to display the boundary conditions. The default values for the line color and line style reflect the color and style selection for element chords of deformed frame elements. These values can be overwritten with the field <code>PlBnd</code> for displaying the the boundary symbols, and with the fields <code>LnClr</code> and <code>LnStl</code> of <code>PlotOpt</code> for setting the line color and style for the deformed shape of the structure, respectively.</p>
<p>[B:SpecV04Frm] shows the specification of the element deformations <span class="math inline">\(\boldsymbol{V}_{\varepsilon}\)</span> for the three hinge portal frame of [B-X:KinDetFrame]. It is important to initialize <span class="math inline">\(\boldsymbol{V}_{\varepsilon}\)</span> to its full size. The script uses the function <code>Localize</code> to extract the end coordinates of each element, which are then used with the function <code>ElmLenOr</code> to determine the element length. The axial deformations in elements a through d are set equal to zero on account of their inextensible character. The index of continuous element deformations <code>ic</code> is set up with the MATLAB  function <code>setdiff</code> after specification of the flexural release locations at end <span class="math inline">\(i\)</span> of element a, end <span class="math inline">\(i\)</span> of element c, and end <span class="math inline">\(j\)</span> of element d for the three hinge portal frame in <a href="a">B-F:KineFrEx2F1</a>.</p>
<div class="MLbox">
<div class="sourceCode" id="cb54" data-startLine="45" data-endLine="55"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<p>The command sequence in [B:Uf4Frm] sets up the kinematic matrix <span class="math inline">\(\mathbf{A}\)</span> and extracts the submatrix <span class="math inline">\(\mathbf{A}_f\)</span> corresponding to the free DOFs of the model in <a href="a">B-F:KineFrEx2F1</a> without taking advantage of the inextensibility of elements a through d to reduce the size of the matrix, as was done for the hand calculations in [B-X:KinDetFrame]. The matrix <span class="math inline">\(\mathbf{A}_f\)</span> refers to element deformations at continuous element ends. In this case the kinematic relations in [B-E:VAfUf] result in a system of 9 equations with 9 unknowns that gives a unique solution for the free DOF displacements under the given element deformations <span class="math inline">\(\boldsymbol{V}_{\varepsilon}\)</span>. Following the determination of the free DOF displacements <span class="math inline">\(\boldsymbol{U}_f\)</span> the release deformations can be determined with the relation</p>
<p><span class="math display">\[
\boxed{ \boldsymbol{V}_h= \breve{\mathbf{A}}_f\mspace{1.5mu}\boldsymbol{U}_f- \boldsymbol{V}_{\varepsilon} }
\]</span>{#E:VhVeps}</p>
<div class="MLbox">
<div class="sourceCode" id="cb55" data-startLine="58" data-endLine="67"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<div class="MLbox">
<div class="sourceCode" id="cb56" data-startLine="78" data-endLine="88"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<p>The command sequence in [B:DefoFrmcom] draws the model in Fig. <a href="#fig:DefoFrm">14</a> in the original configuration in blue color. The command <code>Plot_Model</code> with the optional argument <code>Uf</code> draws the nodes and the element chords in the deformed configuration. The element chords are displayed with a black, dash-dotted line by default. Finally, the function call <code>Plot_DeformedStructure</code> draws the deformed shape of the model in the deformed configuration with a red solid line by default. The default line color, line style and line width of most plotting functions can be overwritten with specification of the <code>PlotOpt</code> fields <code>LnClr</code>, <code>LnStl</code>, and <code>LnWth</code>, respectively.</p>
<figure>
<img src="Function_Code/Ex5_3F2.png" id="fig:DefoFrm" style="width:55.0%" alt="Figure 14: Deformed shape for the three hinge portal frame of [B-X:KinDetFrame] under given element deformations \boldsymbol{V}_0" /><figcaption aria-hidden="true">Figure 14: Deformed shape for the three hinge portal frame of [B-X:KinDetFrame]<br />
under given element deformations <span class="math inline">\(\boldsymbol{V}_0\)</span></figcaption>
</figure>
<p>The presence of flexural releases at end <span class="math inline">\(i\)</span> of element a, end <span class="math inline">\(i\)</span> of element c, and end <span class="math inline">\(j\)</span> of element d results in concentrated rotations at these locations. For the correct deformed shape it is imperative to specify the element deformations <span class="math inline">\(\boldsymbol{V}_{\varepsilon}\)</span> as the fourth input argument to <code>Plot_DeformedStructure</code> in [B:DefoFrmcom]. Furthermore, the function displays the end moment releases in elements a, c and d, as long as <a href="" id="&lt;code&gt;ElemData&lt;/code&gt;" data-replace="&lt;code&gt;ElemData&lt;/code&gt;" title="#sec:Data"><code>ElemData</code></a>  appears as the second input argument of the function with the release specification in the field <code>Release</code>, as [B:DefoFrmcom] shows.</p>
<p>If the element deformations <code>Veps</code> are not specified as the fourth input argument to the function <code>Plot_DeformedStructure</code>, as in [B:DefoWrong], the function draws the deformed shape in Fig. <a href="#fig:WrongDefoFrm">15</a> under the assumption that the element tangents are continuous at the nodes. Consequently, instead of determining <span class="math inline">\(\boldsymbol{V}_h\)</span> according to <span class="citation" data-cites="E:VhVeps">[@E:VhVeps]</span> and the element deformations <span class="math inline">\(\boldsymbol{V}\)</span> from <span class="math inline">\(\boldsymbol{V}_{\varepsilon}+\boldsymbol{V}_h\)</span>, the function simply uses <span class="math inline">\(\boldsymbol{V}= \mathbf{A}_f\mspace{1.5mu}\boldsymbol{U}_f\)</span> resulting in the wrong deformed shape in Fig. <a href="#fig:WrongDefoFrm">15</a> with fixed ends at the two supports and a continuous tangent at the midspan of the girder.</p>
<div class="MLbox">
<div class="sourceCode" id="cb57" data-startLine="70" data-endLine="76"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<figure>
<img src="Function_Code/Ex5_3WF1.png" id="fig:WrongDefoFrm" style="width:55.0%" alt="Figure 15: Wrong deformed shape for the portal frame of [@B-X:KinDetFrame] with continuous element deformations throughout" /><figcaption aria-hidden="true">Figure 15: Wrong deformed shape for the portal frame of <span class="citation" data-cites="B-X:KinDetFrame">[@B-X:KinDetFrame]</span> with continuous element deformations throughout</figcaption>
</figure>
<p>The specification of the element release locations in [B:SpecV04Frm] by setting up the global index <code>ic</code> into the element deformation vector <span class="math inline">\(\boldsymbol{V}\)</span> is inconvenient for large structural models. In such case it is advisable to take advantage of the field <code>Release</code> in <a href="" id="&lt;code&gt;ElemData&lt;/code&gt;" data-replace="&lt;code&gt;ElemData&lt;/code&gt;" title="#sec:Data"><code>ElemData</code></a>  for specifying the release locations of each element. <code>Release</code> is a 3-component column vector, with component 1 corresponding to the axial force, component 2 to the moment at end <span class="math inline">\(i\)</span>, and component 3 to the moment at end <span class="math inline">\(j\)</span> of the element. A value of 1 indicates the presence of a release for the corresponding basic element force. [B:Icgen] shows the specification of the flexural releases at end <span class="math inline">\(i\)</span> of element a, end <span class="math inline">\(i\)</span> of element c, and end <span class="math inline">\(j\)</span> of element d for the three hinge portal frame in <a href="a">B-F:KineFrEx2F1</a>. This information is used by <code>FEDEASlab</code> function [func:H_index] to set up the collection of cell arrays <code>iced</code> in [B:Icgen] with the indices for the continuous element deformations. Concatenating these cell arrays produces the global index <code>ic</code> for the continuous element deformations and the use of the MATLAB  function <code>setdiff</code> gives the global index <code>ih</code> for the release locations in [B:Icgen].</p>
<div class="MLbox">
<div class="sourceCode" id="cb58" data-startLine="54" data-endLine="63"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<h2 id="linear-analysis">Linear Analysis</h2>
<p>Following the specification of the model geometry and the generation of the data structure <a href="https://example.com" id="Model" data-replace="Model">Model</a>  with the function [func:Create_SimpleModel] [B:ElProp4DM] shows the specification of the element properties for the portal frame of [B-X:FramewDM] in <a href="a">B-F:DMFrEx1F1</a>. To account for the inextensible character of elements a, b, c and d a large value for the cross section area <span class="math inline">\(A\)</span> is specified in <a href="" id="&lt;code&gt;ElemData&lt;/code&gt;" data-replace="&lt;code&gt;ElemData&lt;/code&gt;" title="#sec:Data"><code>ElemData</code></a> . The value of <span class="math inline">\(A=10^6\)</span> suffices for the purpose.</p>
<div class="MLbox">
<div class="sourceCode" id="cb59" data-startLine="42" data-endLine="49"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<p>[B:Load4DM] shows the determination of the equivalent nodal forces for the uniform element load in elements a and b in [B-F:DMFrEx1F16]. The uniform element load values are specified in <a href="" id="&lt;code&gt;ElemData&lt;/code&gt;" data-replace="&lt;code&gt;ElemData&lt;/code&gt;" title="#sec:Data"><code>ElemData</code></a>  and used as input to the function <code>Create_PwForces</code> to generate the equivalent nodal forces at all DOFs. The equivalent nodal forces <span class="math inline">\(\boldsymbol{P}_{wf}\)</span> at the free DOFs are extracted from <code>Pw</code>. The element load is defined in the local reference system with the <span class="math inline">\(x\)</span>-axis pointing from end <span class="math inline">\(i\)</span> to end <span class="math inline">\(j\)</span>. Consequently, the <span class="math inline">\(y\)</span>-axis of element a points to the left and that of element b upward, with the element load <span class="math inline">\(w\)</span> in [B-F:DMFrEx1F16] pointing in the negative <span class="math inline">\(y\)</span> direction in both in agreement with the sign for the field <code>w</code> of <a href="" id="&lt;code&gt;ElemData&lt;/code&gt;" data-replace="&lt;code&gt;ElemData&lt;/code&gt;" title="#sec:Data"><code>ElemData</code></a>  in [B:Load4DM].</p>
<div class="MLbox">
<div class="sourceCode" id="cb60" data-startLine="51" data-endLine="55"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<p>Following the element property and loading specification, [B:Mdistr4DM] shows the command sequence for the displacement method of analysis of the portal frame and for plotting and labeling the bending moment distribution under the uniform element load in elements a and b with a scale factor of <span class="math inline">\(0.5\)</span>.</p>
<div class="MLbox">
<div class="sourceCode" id="cb61" data-startLine="56" data-endLine="62"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<figure>
<img src="Function_Code/Ex10_3F1.png" id="fig:Mdistr4DM" style="width:60.0%" alt="Figure 16: Bending moment distribution of the portal frame under uniform load w in elements a and b" /><figcaption aria-hidden="true">Figure 16: Bending moment distribution of the portal frame under uniform load <span class="math inline">\(w\)</span> in elements a and b</figcaption>
</figure>
<p>[B:e0Prop4DM] shows the specification of the uniform thermal curvature in elements a and b for the portal frame of [B-X:FramewDM]. Note the clearing of the values from the preceding load case of uniform element loading. Finally, [B:MCurv4DM] shows the command sequence for producing the result display in Fig. <a href="#fig:Ex8_3F3">17</a> under the uniform thermal curvature in elements a and b.</p>
<div class="MLbox">
<div class="sourceCode" id="cb62" data-startLine="76" data-endLine="83"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<div class="MLbox">
<div class="sourceCode" id="cb63" data-linerange="97-103,105-108,110-117"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<p><img src="Function_Code/Ex10_3F3.png" title="fig:" id="fig:Ex8_3F3" alt="Figure 17: Bending moment, curvature distribution, and deformed shape under uniform curvature in elements a and b" /> (a) Bending moment distribution</p>
<p><img src="Function_Code/Ex10_3F4.png" title="fig:" id="fig:Ex8_3F4" style="width:80.0%" alt="Figure 18: Bending moment, curvature distribution, and deformed shape under uniform curvature in elements a and b" /><br />
(b) Curvature distribution<br />
<img src="Function_Code/Ex10_3F5.png" title="fig:" id="fig:Ex8_3F5" style="width:85.0%" alt="Figure 19: Bending moment, curvature distribution, and deformed shape under uniform curvature in elements a and b" /><br />
(c) Deformed shape</p>
<h2 id="plastic-analysis-1">Plastic Analysis</h2>
<p>sec. <a href="#sec:PlAnwFlab">11.1</a> discusses the use of <a href="" id="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" data-replace="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" title="../../"><span style="color: blue;font-family: monospace;">FEDEAS</span>Lab</a> function  for determining the collapse load factor <span class="math inline">\(\lambda_c\)</span> and the corresponding basic forces <span class="math inline">\(\boldsymbol{Q}_c\)</span> of a structural model under a given reference load vector <span class="math inline">\(\boldsymbol{P}_{ref}\)</span> at the free DOFs. The input arguments to the function are the equilibrium matrix <code>Bf</code> at the free DOFs, the vector of plastic capacities <code>Qpl</code> and the reference load vector <code>Pref</code>. The script in [B:PlAnal] shows the set-up of the input arguments to the function  for the column-girder assembly of [B-X:PlAColGird].</p>
<div class="MLbox">
<div class="sourceCode" id="cb64" data-startLine="47" data-endLine="57"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<p>Because the end forces <code>Qc</code> in [B:PlAnal] do not include the axial basic forces nor the end moment at the roller support, it is not possible to use the post-processing functions of <a href="" id="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" data-replace="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" title="../../"><span style="color: blue;font-family: monospace;">FEDEAS</span>Lab</a> to display the moment distribution and the plastic hinge locations at collapse without information about the missing basic element forces. To accomplish this we append the field <code>Qmis</code> to the data structure <a href="https://example.com" id="Model" data-replace="Model">Model</a>  to supply the index of the missing basic forces. The plotting and labeling functions of <a href="" id="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" data-replace="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" title="../../"><span style="color: blue;font-family: monospace;">FEDEAS</span>Lab</a> use the entries in this field, if present, to adjust the incoming basic force vector <span class="math inline">\(\boldsymbol{Q}\)</span>, so that its terms end up in the right location of the full basic force vector <span class="math inline">\(\boldsymbol{Q}\)</span> before performing the display and labeling operations.</p>
<figure>
<img src="Function_Code/Ex12_2F1.png" title="fig:" id="fig:PlotColGird" style="width:60.0%" alt="Figure 20: Moment distribution with plastic hinge locations at collapse for the column-girder assembly of [B-X:PlAColGird]" /><figcaption aria-hidden="true">Figure 20: Moment distribution with plastic hinge locations at collapse<br />
for the column-girder assembly of [B-X:PlAColGird]</figcaption>
</figure>
<p>[B:PlotColGirdCom] shows the specification of the element index <code>Qmis</code> for the missing basic element forces and the command sequence for plotting the moment distribution and the plastic hinge locations at collapse for the girder-column assembly of [B-X:PlAColGird] in Fig. <a href="#fig:PlotColGird">20</a>. Because the plastic flexural capacity of elements b and c is the same, a plastic hinge is displayed at end <span class="math inline">\(j\)</span> of element b as well as at end <span class="math inline">\(i\)</span> of element c indicating, in fact, that a plastic hinge forms at the girder midspan. To avoid the display of a double hinge the plastic capacity of element b should be slightly different from element c.</p>
<p>The last example deals with the determination and display of the collapse mechanism of the portal frame in [B-X:PlUB4PortalFrame]. In [B:UB4PorFr] the collapse load factor and the kinematics of the collapse mechanism were determined by specifying explicitly the kinematic matrix <span class="math inline">\(\mathbf{A}_f\)</span> of the portal frame and invoking the <a href="" id="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" data-replace="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" title="../../"><span style="color: blue;font-family: monospace;">FEDEAS</span>Lab</a> function for the upper bound theorem. In [B:UB4PorFrB] we let <a href="" id="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" data-replace="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" title="../../"><span style="color: blue;font-family: monospace;">FEDEAS</span>Lab</a> set up the kinematic matrix with the function <a href="../../Functions/latest/General/A_matrix" id="&lt;span style=&quot;font-family: monospace&quot;&gt;A_matrix&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;A_matrix&lt;/span&gt;"><span style="font-family: monospace">A_matrix</span></a>  based on the geometric information of the structural model in data structure <a href="https://example.com" id="Model" data-replace="Model">Model</a> . Because this function includes also the axial deformations of the frame elements in the entries of the kinematic matrix <span class="math inline">\(\mathbf{A}_f\)</span> it is important to specify a plastic capacity vector of equal length with the number of rows of <span class="math inline">\(\mathbf{A}_f\)</span>. For this reason the plastic axial capacity is included in the plastic capacity vector <code>Qpl</code> in [B:UB4PorFrB]. It is set to a relatively high value to exclude the possibility of an axial plastic hinge forming in the portal frame.</p>
<div class="sourceCode" id="cb65" data-startLine="42" data-endLine="52"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<div class="sourceCode" id="cb66" data-startLine="53" data-endLine="58"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<p>[B:UB4PorFrB] shows the required sequence of commands for plotting the collapse mechanism of the portal frame with the plastic hinge locations in Fig. <a href="#fig:Mech4PorFrm">21</a>. After creating a new window and displaying the structural model in the undeformed configuration the magnification factor <code>MAGF</code> is set and the <code>Plot_Model</code> function is invoked a second time with an additional argument the displacement increments <code>DUf</code> of the collapse mechanism. Finally the function <code>Plot_PlasticHinges</code> with the optional argument <code>DUf</code> displays the plastic hinge locations on the collapse mechanism.</p>
<figure>
<img src="Function_Code/Ex12_6F1.png" title="fig:" id="fig:Mech4PorFrm" style="width:50.0%" alt="Figure 21: Collapse mechanism of portal frame" /><figcaption aria-hidden="true">Figure 21: Collapse mechanism of portal frame</figcaption>
</figure>
<p>We note that the third input argument of the <code>Plot_PlasticHinges</code> function can be either the basic forces <code>Qc</code> at incipient collapse, as is the case in [B:PlotColGirdCom], in which case the plastic capacity at the corresponding location needs to be specified as the second argument to the function, or the plastic hinge deformation increments <code>DVhp</code>, as shown in [B:UB4PorFrC].</p>
<h1 id="summary-of-basic-fedeaslab-functions-and-scripts">Summary of Basic <a href="" id="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" data-replace="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" title="../../"><span style="color: blue;font-family: monospace;">FEDEAS</span>Lab</a> Functions and Scripts</h1>
<p>The basic <a href="" id="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" data-replace="&lt;span style=&quot;color: blue;font-family: monospace;&quot;&gt;FEDEAS&lt;/span&gt;Lab" title="../../"><span style="color: blue;font-family: monospace;">FEDEAS</span>Lab</a>  functions and script files are summarized below.</p>
<h2 id="model-and-loading-functions">Model and Loading Functions</h2>
<table>
<thead>
<tr class="header">
<th style="text-align: left;"><span style="color: blue"> Function name</span></th>
<th style="text-align: left;"> <span style="color: blue">Input arguments</span></th>
<th style="text-align: left;"> <span style="color: blue">Output</span>  </th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"> [func:Create_SimpleModel]  </td>
<td style="text-align: left;"> <code>XYZ</code>, <code>CON</code>, <code>BOUN</code>, <code>ElemName</code>  </td>
<td style="text-align: left;"> <code>Model</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"> [func:Create_NodalForces]  </td>
<td style="text-align: left;"> <code>Model</code>, <code>Pe</code></td>
<td style="text-align: left;"> <code>Pf</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"> [func:Create_PwForces]  </td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code></td>
<td style="text-align: left;"> <code>Pw</code></td>
</tr>
</tbody>
</table>
<h2 id="functions-for-structural-matrices-and-vectors">Functions for Structural Matrices and Vectors</h2>
<table>
<thead>
<tr class="header">
<th style="text-align: left;"> Function name  </th>
<th style="text-align: center;">Input arguments (optional)</th>
<th style="text-align: left;"> Output</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"> <a href="../../Functions/latest/General/B_matrix" id="&lt;span style=&quot;font-family: monospace&quot;&gt;B_matrix&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;B_matrix&lt;/span&gt;"><span style="font-family: monospace">B_matrix</span></a></td>
<td style="text-align: center;"> <code>Model</code></td>
<td style="text-align: left;"> <code>B</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"> <a href="../../Functions/latest/General/BbariBbarx_matrix" id="&lt;span style=&quot;font-family: monospace&quot;&gt;BbariBbarx_matrix&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;BbariBbarx_matrix&lt;/span&gt;"><span style="font-family: monospace">BbariBbarx_matrix</span></a>  </td>
<td style="text-align: center;"> <code>Bf</code>, (<code>ind_r</code>)</td>
<td style="text-align: left;"> <code>Bbari</code>, <code>Bbarx</code>  </td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <a href="../../Functions/latest/General/A_matrix" id="&lt;span style=&quot;font-family: monospace&quot;&gt;A_matrix&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;A_matrix&lt;/span&gt;"><span style="font-family: monospace">A_matrix</span></a></td>
<td style="text-align: center;"> <code>Model</code></td>
<td style="text-align: left;"> <code>A</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"> <a href="../../Functions/latest/General/Fs_matrix" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Fs_matrix&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Fs_matrix&lt;/span&gt;"><span style="font-family: monospace">Fs_matrix</span></a></td>
<td style="text-align: center;"> <code>Model</code>, <code>ElemData</code>, <code>(Roption)</code>  </td>
<td style="text-align: left;"> <code>Fs</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <a href="../../Functions/latest/General/V0_vector" id="&lt;span style=&quot;font-family: monospace&quot;&gt;V0_vector&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;V0_vector&lt;/span&gt;"><span style="font-family: monospace">V0_vector</span></a></td>
<td style="text-align: center;"> <code>Model</code>, <code>ElemData</code>, <code>(Roption)</code>  </td>
<td style="text-align: left;"> <code>V0</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"> <a href="../../Functions/latest/General/Ks_matrix" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Ks_matrix&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Ks_matrix&lt;/span&gt;"><span style="font-family: monospace">Ks_matrix</span></a></td>
<td style="text-align: center;"> <code>Model</code>, <code>ElemData</code>  </td>
<td style="text-align: left;"> <code>Ks</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <a href="../../Functions/latest/General/Q0_vector" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Q0_vector&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Q0_vector&lt;/span&gt;"><span style="font-family: monospace">Q0_vector</span></a></td>
<td style="text-align: center;"> <code>Model</code>, <code>ElemData</code>  </td>
<td style="text-align: left;"> <code>Q0</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"> <a href="../../Functions/latest/General/Kf_matrix" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Kf_matrix&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Kf_matrix&lt;/span&gt;"><span style="font-family: monospace">Kf_matrix</span></a></td>
<td style="text-align: center;"> <code>Model</code>, <code>ElemData</code>  </td>
<td style="text-align: left;"> <code>Kf</code></td>
</tr>
</tbody>
</table>
<h2 id="analysis-scripts-and-functions">Analysis Scripts and Functions</h2>
<table>
<thead>
<tr class="header">
<th style="text-align: center;"> Script name</th>
<th style="text-align: left;">  Input variables (optional)</th>
<th style="text-align: left;">  Output variables  </th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"> <code>S_ForceMethod</code>  </td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code>, (<code>Pf</code>), (<code>Pwf</code>)  </td>
<td style="text-align: left;"> <code>Q</code>, <code>Ve</code>, <code>Uf</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>S_DisplMethod</code>  </td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code>, (<code>Pf</code>), (<code>Pwf</code>)  </td>
<td style="text-align: left;"> <code>Uf</code>, <code>Q</code>, <code>Ve</code></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th style="text-align: center;"> Function name</th>
<th style="text-align: center;"> Input arguments  </th>
<th style="text-align: left;">  Output</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"> <code>PlasticAnalysis_wLBT</code>  </td>
<td style="text-align: center;"> <code>Bf</code>, <code>Qpl</code>, <code>Pref</code>, <code>(Pcf)</code>, <code>(Options)</code>  </td>
<td style="text-align: left;"> <code>lambdac</code>, <code>Qc</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>PlasticAnalysis_wUBT</code>  </td>
<td style="text-align: center;"> <code>Af</code>, <code>Qpl</code>, <code>Pref</code>, <code>(Pcf)</code>, <code>(Options)</code>  </td>
<td style="text-align: left;"> <code>lambdac</code>, <code>DUf</code>, <code>DVhp</code>  </td>
</tr>
</tbody>
</table>
<h2 id="general-utility-functions-1">General Utility Functions</h2>
<table>
<thead>
<tr class="header">
<th style="text-align: left;"><span style="color: blue"> Function name</span>  </th>
<th style="text-align: left;"><span style="color: blue"> Input arguments</span>  </th>
<th style="text-align: left;"><span style="color: blue"> Output</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"> <a href="../../Functions/latest/Utilities/General/CleanStart" id="&lt;span style=&quot;font-family: monospace&quot;&gt;CleanStart&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;CleanStart&lt;/span&gt;"><span style="font-family: monospace">CleanStart</span></a>  </td>
<td style="text-align: left;"><code>'---'</code></td>
<td style="text-align: left;"><code>'---'</code> </td>
</tr>
<tr class="even">
<td style="text-align: left;"> <a href="../../Functions/latest/Utilities/General/Create_Units" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Create_Units&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Create_Units&lt;/span&gt;"><span style="font-family: monospace">Create_Units</span></a></td>
<td style="text-align: left;"><code>'US'</code> or <code>'SI'</code></td>
<td style="text-align: left;"> <code>Units</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <a href="../../Functions/latest/General/Localize" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Localize&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Localize&lt;/span&gt;"><span style="font-family: monospace">Localize</span></a>  </td>
<td style="text-align: left;"> <code>Model</code>, <code>el</code>  </td>
<td style="text-align: left;"> <code>xyz</code>, <code>id</code>  </td>
</tr>
<tr class="even">
<td style="text-align: left;"> [func:ElemLenOr]</td>
<td style="text-align: left;"> <code>xyz</code></td>
<td style="text-align: left;"> <code>L</code>, <code>dcx</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"> [func:func:H_index]</td>
<td style="text-align: left;"> [Model], <code>ElemData</code></td>
<td style="text-align: left;"> <code>iced</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"> [func:D_index]</td>
<td style="text-align: left;"> <code>Model</code></td>
<td style="text-align: left;"> <code>ied</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <a href="../../Functions/latest/Utilities/PostProcessing/Complete_QV" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Complete_QV&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Complete_QV&lt;/span&gt;"><span style="font-family: monospace">Complete_QV</span></a></td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code>, <code>Q</code></td>
<td style="text-align: left;"> <code>Q</code>, <code>Ve</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"> <a href="../../Functions/latest/Utilities/PreProcessing/Elements/ElemData2Qpl" id="&lt;span style=&quot;font-family: monospace&quot;&gt;ElemData2Qpl&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;ElemData2Qpl&lt;/span&gt;"><span style="font-family: monospace">ElemData2Qpl</span></a></td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code></td>
<td style="text-align: left;"> <code>Qpl</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <a href="../../Functions/latest/Utilities/PostProcessing/Q2Post" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Q2Post&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Q2Post&lt;/span&gt;"><span style="font-family: monospace">Q2Post</span></a></td>
<td style="text-align: left;"> <code>Model</code>, <code>Q</code></td>
<td style="text-align: left;"> <code>Post</code></td>
</tr>
</tbody>
</table>
<h2 id="graphics-utility-functions">Graphics Utility Functions</h2>
<table>
<thead>
<tr class="header">
<th style="text-align: left;"> <span style="color: blue">Function name</span></th>
<th style="text-align: left;"> <span style="color: blue">Input arguments (optional)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"> <a href="../../Functions/latest/Utilities/Plotting/Create_Window" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Create_Window&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Create_Window&lt;/span&gt;"><span style="font-family: monospace">Create_Window</span></a></td>
<td style="text-align: left;"> <code>DX</code>, <code>DY</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"> <a href="../../Functions/latest/Utilities/Plotting/Structure/Plot_Model" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Plot_Model&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Plot_Model&lt;/span&gt;"><span style="font-family: monospace">Plot_Model</span></a></td>
<td style="text-align: left;"> <code>Model</code>, (<code>Uf</code>) , (<code>Options</code>)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <a href="../../Functions/latest/Utilities/Plotting/Structure/Label_Model" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Label_Model&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Label_Model&lt;/span&gt;"><span style="font-family: monospace">Label_Model</span></a></td>
<td style="text-align: left;"> <code>Model</code>, (<code>Options</code>)</td>
</tr>
<tr class="even">
<td style="text-align: left;"> <a href="../../Functions/latest/Utilities/Plotting/Structure/Plot_NodalForces" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Plot_NodalForces&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Plot_NodalForces&lt;/span&gt;"><span style="font-family: monospace">Plot_NodalForces</span></a></td>
<td style="text-align: left;"> <code>Model</code>, <code>Pe</code> , (<code>Options</code>) </td>
</tr>
<tr class="odd">
<td style="text-align: left;"> [func:Plot_ElementLoading]</td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code> , (<code>Options</code>) </td>
</tr>
<tr class="even">
<td style="text-align: left;"> <a href="../../Functions/latest/Utilities/Plotting/Structure/Plot_Releases" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Plot_Releases&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Plot_Releases&lt;/span&gt;"><span style="font-family: monospace">Plot_Releases</span></a></td>
<td style="text-align: left;"> <code>Model</code>, (<code>ElemData</code>) , (<code>Uf</code>) , (<code>Options</code>) </td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <a href="../../Functions/latest/Utilities/Plotting/Elements/Plot_AxialForces" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Plot_AxialForces&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Plot_AxialForces&lt;/span&gt;"><span style="font-family: monospace">Plot_AxialForces</span></a></td>
<td style="text-align: left;"> <code>Model</code>, <code>Q</code>, (<code>ElemList</code>), (<code>Scale</code>)</td>
</tr>
<tr class="even">
<td style="text-align: left;"> <a href="../../Functions/latest/Utilities/Plotting/Elements/Label_AxialForces" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Label_AxialForces&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Label_AxialForces&lt;/span&gt;"><span style="font-family: monospace">Label_AxialForces</span></a></td>
<td style="text-align: left;"> <code>Model</code>, <code>Q</code>, (<code>ElemList</code>), (<code>Digit</code>), (<code>Force Units</code>)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <a href="../../Functions/latest/Utilities/Plotting/Elements/Plot_2dMomntDistr" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Plot_2dMomntDistr&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Plot_2dMomntDistr&lt;/span&gt;"><span style="font-family: monospace">Plot_2dMomntDistr</span></a></td>
<td style="text-align: left;"> <code>Model</code>, (<code>ElemData</code>), <code>Q</code>, (<code>ElemList</code>), (<code>Scale</code>)  </td>
</tr>
<tr class="even">
<td style="text-align: left;"> <a href="../../Functions/latest/Utilities/Plotting/Elements/Label_2dMoments" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Label_2dMoments&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Label_2dMoments&lt;/span&gt;"><span style="font-family: monospace">Label_2dMoments</span></a></td>
<td style="text-align: left;"> <code>Model</code>, <code>Q</code>, (<code>ElemList</code>), (<code>Digit</code>), (<code>Moment Units</code>)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <a href="../../Functions/latest/Utilities/Plotting/Elements/Plot_2dCurvDistr" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Plot_2dCurvDistr&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Plot_2dCurvDistr&lt;/span&gt;"><span style="font-family: monospace">Plot_2dCurvDistr</span></a></td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code>, <code>Q</code>, (<code>ElemList</code>), (<code>Scale</code>)  </td>
</tr>
<tr class="even">
<td style="text-align: left;"> <a href="../../Functions/latest/Utilities/Plotting/Structure/Plot_DeformedStructure" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Plot_DeformedStructure&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Plot_DeformedStructure&lt;/span&gt;"><span style="font-family: monospace">Plot_DeformedStructure</span></a>  </td>
<td style="text-align: left;"> <code>Model</code>, (<code>ElemData</code>), <code>Uf</code>, (<code>Ve</code>), (<code>Options</code>)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <a href="../../Functions/latest/Utilities/Plotting/Structure/Plot_PlasticHinges" id="&lt;span style=&quot;font-family: monospace&quot;&gt;Plot_PlasticHinges&lt;/span&gt;" data-replace="&lt;span style=&quot;font-family: monospace&quot;&gt;Plot_PlasticHinges&lt;/span&gt;"><span style="font-family: monospace">Plot_PlasticHinges</span></a></td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code>, (<code>Uf</code>), <code>Q</code>, (<code>Options</code>)</td>
</tr>
</tbody>
</table>
<h2 id="auxiliary-functions">Auxiliary Functions</h2>
<h2 id="function-name">Function Name</h2>
<p><code>Get_ModelScale</code> <code>Plot_BounCond</code> <code>DeformShape2dFrm</code> <code>Draw_Arrow</code> <code>Draw_Cube</code> ——————–</p>
<!-- footnotes -->
<!-- tag                URL                                                    Display text  -->
<!--
[func:A_matrix]:  /Functions/latest/General_Functions/A_matrix  {replace="<span style=\"font-family: monospace\">A_matrix</span>"}
[func:B_matrix]:  /Functions/latest/General_Functions/B_matrix  {replace="<span style=\"font-family: monospace\">B_matrix</span>"}
[func:Ks_matrix]: /Functions/latest/General_Functions/Ks_matrix {replace="<span style=\"font-family: monospace\">Ks_matrix</span>"}
[func:Kf_matrix]: /Functions/latest/General_Functions/Kf_matrix {replace="<span style=\"font-family: monospace\">Kf_matrix</span>"}
[func:Fs_matrix]: /Functions/latest/General_Functions/Fs_matrix {replace="<span style=\"font-family: monospace\">Fs_matrix</span>"}
[func:H_index]:  /Functions/latest/General_Functions/H_index  {replace="<span style=\"font-family: monospace\">H_index</span>"}

[func:V0_vector]:  /Functions/latest/General_Functions/V0_vector  {replace="<span style=\"font-family: monospace\">V0_vector</span>"}
[func:Q0_vector]:  /Functions/latest/General_Functions/Q0_vector  {replace="<span style=\"font-family: monospace\">Q0_vector</span>"}

[func:BbariBbarx_matrix]: /Functions/latest/Basic/BbariBbarx_matrix {replace="BbariBbarx_matrix"}

[func:Create_NodalForces]:  /Functions/latest/General_Functions/Create_NodalForces  {replace="<span style=\"font-family: monospace\">Create_NodalForces</span>"}
[func:Create_SimpleModel]:  /Functions/latest/General_Functions/Create_SimpleModel  {replace="<span style=\"font-family: monospace\">Create_SimpleModel</span>"}
[func:Localize]:  /Functions/latest/General_Functions/Localize  {replace="<span style=\"font-family: monospace\">Localize</span>"}
[func:ElmLenOr]:  /Functions/latest/General_Functions/ElmLenOr  {replace="<span style=\"font-family: monospace\">ElmLenOr</span>"}
-->
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>The prefix R in this report refers to material in the course reader<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p><code>Roption</code> specifies whether release information is used to strip matrix rows and columns corresponding to releases<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

                        

<div class="container mt-3 pt-3">

</div>

                        </article>
                        <!-- <div class="col-md-8" role="main"></div> -->
                    
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>&copy 1998-2021 UC Regents, Filip C. Filippou</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="elstir_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="elstir-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="elstir-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="elstir_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
