<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://claudioperez.github.io/FEDEASdocs/Pages/Teaching/FL_Basic2/">
        <link rel="shortcut icon" href="../../../img/favicon.ico">
        <title>FL Basic2 - FEDEASLab</title>
        <link href="../../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
        <link href="../../../_static/css/extra.css" rel="stylesheet">


        <script src="../../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/matlab.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <!-- <script>
            $(".nav .nav-link").on("click", function(){
            $(".nav").find(".active").removeClass("active");
            $(this).addClass("active");
         });
         </script> -->


        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-170527070-1', 'auto');
            ga('send', 'pageview');
        </script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../../..">FEDEASLab</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav ml-auto">
                        <!--<ul class="nav navbar-nav">-->
                            <li class="navitem">
                                <a href="../../../About/" class="nav-link">About</a>
                            </li>
                            <li class="navitem">
                                <a href="../../" class="nav-link">Pages</a>
                            </li>
                            <li class="navitem">
                                <a href="../../../Functions/Help" class="nav-link">Functions</a>
                            </li>
                            <li class="navitem">
                                <a href="../../../Gallery/" class="nav-link">Gallery</a>
                            </li>
                        <!--</ul>-->
                        <!--</div>-->

                    <!-- <ul class="nav navbar-nav ml-auto"> -->
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#elstir_search_modal">
                               <!--<img src="img/search.png" class="icon">--> <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="container">
            
            <!-- <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                  <li class="breadcrumb-item"><a href="#">Home</a></li>
                  <li class="breadcrumb-item"><a href="#">Library</a></li>
                  <li class="breadcrumb-item active" aria-current="page">Data</li>
                </ol>
            </nav> -->
            
            <div class="row">
                    
                        <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>
    
    <div id="toc-collapse" class="navbar-collapse collapse card ">
        <ul class="nav flex-column">
        
            
            <li class="nav-item " data-level="1">
              <a href="/FEDEASdocs/Pages/Teaching/" class="">FEDEASLab Basic Structural Analysis Functions</a>
              <!-- <a href="/FEDEASdocs/Pages/Teaching/" class="nav-link ">FEDEASLab Basic Structural Analysis Functions</a> -->
              
              <ul class="nav flex-column">
              <div class="dropdown-divider"></div>
                    
            <li class="nav-item " data-level="2">
              <a href="/FEDEASdocs/Pages/Teaching/01_Functions/" class="">Function Organization</a>
              <!-- <a href="/FEDEASdocs/Pages/Teaching/01_Functions/" class="nav-link ">Function Organization</a> -->
              
              <ul class="nav flex-column">
              
              </ul>
              
            </li>
                    
                    
            <li class="nav-item " data-level="2">
              <a href="/FEDEASdocs/Pages/Teaching/02_Data/" class="">Data Organization</a>
              <!-- <a href="/FEDEASdocs/Pages/Teaching/02_Data/" class="nav-link ">Data Organization</a> -->
              
              <ul class="nav flex-column">
              
              </ul>
              
            </li>
                    
                    
            <li class="nav-item " data-level="2">
              <a href="/FEDEASdocs/Pages/Teaching/03_General-Utilities/" class="">General Utility Functions</a>
              <!-- <a href="/FEDEASdocs/Pages/Teaching/03_General-Utilities/" class="nav-link ">General Utility Functions</a> -->
              
              <ul class="nav flex-column">
              
              </ul>
              
            </li>
                    
                    
            <li class="nav-item " data-level="2">
              <a href="/FEDEASdocs/Pages/Teaching/04/" class="">Structural Equilibrium</a>
              <!-- <a href="/FEDEASdocs/Pages/Teaching/04/" class="nav-link ">Structural Equilibrium</a> -->
              
              <ul class="nav flex-column">
              
              </ul>
              
            </li>
                    
                    
            <li class="nav-item " data-level="2">
              <a href="/FEDEASdocs/Pages/Teaching/05/" class="">Structural Kinematics</a>
              <!-- <a href="/FEDEASdocs/Pages/Teaching/05/" class="nav-link ">Structural Kinematics</a> -->
              
              <ul class="nav flex-column">
              
              </ul>
              
            </li>
                    
                    
            <li class="nav-item " data-level="2">
              <a href="/FEDEASdocs/Pages/Teaching/06/" class="">Force-Deformation Relations for Linear Material Response</a>
              <!-- <a href="/FEDEASdocs/Pages/Teaching/06/" class="nav-link ">Force-Deformation Relations for Linear Material Response</a> -->
              
              <ul class="nav flex-column">
              
              </ul>
              
            </li>
                    
                    
            <li class="nav-item active" data-level="2">
              <a href="/FEDEASdocs/Pages/Teaching/FL_Basic2/" class="active">FL Basic2</a>
              <!-- <a href="/FEDEASdocs/Pages/Teaching/FL_Basic2/" class="nav-link active">FL Basic2</a> -->
              
              <ul class="nav flex-column">
              
              </ul>
              
            </li>
                    
              </ul>
              
            </li>
        
        </ul>
    </div>
</div></div>
                    

                    
                        <article class="col-md-9 p-3">
                        <!-- <article class="col-md-9"> -->
                        

<!-- tag                URL                                                    Display text  -->
<h1 id="basic-structural-analysis-functions">Basic Structural Analysis Functions</h1>
<h2 id="introduction">Introduction</h2>
<p>[FEDEASlab] functions implement structural analysis concepts in parallel with their theoretical presentation in the introductory structural analysis course, thus illustrating the generality of the methods and their application to large scale and complex structural models. The intent is not only to reinforce the understanding of the structural response under different types and arrangements of loading, but also to facilitate system and parameter studies.</p>
<h2 id="function-organization">Function Organization</h2>
<p>The structural analysis functions for the introductory course are organized in two folders: <code>Basic</code> and <code>Utilities</code>. The <code>Basic</code> folder contains 20 functions that directly implement the analysis concepts of the course in . Many functions in this folder are provided in open source form (<code>.m</code> file format), so that interested readers can relate the implementation details with the theory presented in the course.</p>
<div id="T:StructMat">
<table>
<caption>Functions for Structural Matrices and Vectors</caption>
<thead>
<tr class="header">
<th style="text-align: left;"><span style="color: blue"> Function name</span></th>
<th style="text-align: left;"><span style="color: blue"> Input arguments (optional)</span></th>
<th style="text-align: left;"><span style="color: blue"> Output</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"> [func:B_matrix]</td>
<td style="text-align: left;"> <code>Model</code></td>
<td style="text-align: left;"> <code>B</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"> <code>BbariBbarx_matrix</code>  </td>
<td style="text-align: left;"> <code>Bf</code>, (<code>ind_r</code>)</td>
<td style="text-align: left;"> <code>Bbari</code>, <code>Bbarx</code>  </td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <code>A_matrix</code></td>
<td style="text-align: left;"> <code>Model</code></td>
<td style="text-align: left;"> <code>A</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"> <code>Fs_matrix</code></td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code>, <code>(Roption)</code>  </td>
<td style="text-align: left;"> <code>Fs</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <code>V0_vector</code></td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code>, <code>(Roption)</code>  </td>
<td style="text-align: left;"> <code>V0</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"> <code>Ks_matrix</code></td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code>  </td>
<td style="text-align: left;"> <code>Ks</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <code>Q0_vector</code></td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code>  </td>
<td style="text-align: left;"> <code>Q0</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"> <code>Kf_matrix</code></td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code>  </td>
<td style="text-align: left;"> <code>Kf</code></td>
</tr>
</tbody>
</table>
</div>
<p>The  functions in the <code>Basic</code> folder can be classified in the following categories:</p>
<ol type="1">
<li><p>: 8. These are listed in .</p></li>
<li><p>: 4. These are listed in .</p></li>
<li><p>: 3. These are listed in .</p></li>
<li><p>: 6, namely <code>Localize</code>, <code>ElmLenOr</code>, <code>Create_PlasticLimitSurface</code>, <code>DefGeom_2dFrm</code>, <code>DeformShape2dFrm</code> and <code>Large2du2v_Frm</code> which are not invoked directly, but are used either by the Model and Loading Functions or by Graphics Utility Functions to be discussed subsequently.</p></li>
</ol>
<div id="T:AnalFunScr">
<table>
<caption>Analysis Functions and Scripts</caption>
<thead>
<tr class="header">
<th style="text-align: left;"><span style="color: blue"> Script name</span></th>
<th style="text-align: left;"> <span style="color: blue">Input variables (optional)</span></th>
<th style="text-align: left;"> <span style="color: blue">Output variables</span>  </th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"> <code>S_ForceMethod</code>  </td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code>, (<code>Pf</code>), (<code>Pwf</code>)  </td>
<td style="text-align: left;"> <code>Q</code>, <code>Ve</code>, <code>Uf</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"> <code>S_DisplMethod</code>  </td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code>, (<code>Pf</code>), (<code>Pwf</code>)  </td>
<td style="text-align: left;"> <code>Uf</code>, <code>Q</code>, <code>Ve</code></td>
</tr>
</tbody>
</table>
</div>
<div id="T:AnalFunScr">
<table>
<caption>Analysis Functions and Scripts</caption>
<thead>
<tr class="header">
<th style="text-align: left;"><span style="color: blue"> Function name</span></th>
<th style="text-align: left;"><span style="color: blue"> Input arguments</span>  </th>
<th style="text-align: left;"> <span style="color: blue">Output</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"> <code>PlasticAnalysis_wLBT</code>  </td>
<td style="text-align: left;"> <code>Bf</code>, <code>Qpl</code>, <code>Pref</code>, <code>(Pcf)</code>, <code>(Options)</code>  </td>
<td style="text-align: left;"> <code>lambdac</code>, <code>Qc</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"> <code>PlasticAnalysis_wUBT</code>  </td>
<td style="text-align: left;"> <code>Af</code>, <code>Qpl</code>, <code>Pref</code>, <code>(Pcf)</code>, <code>(Options)</code>  </td>
<td style="text-align: left;"> <code>lambdac</code>, <code>DUf</code>, <code>DVhp</code>  </td>
</tr>
</tbody>
</table>
</div>
<div id="T:ModLoad">
<table>
<caption>Model and Loading Functions</caption>
<thead>
<tr class="header">
<th style="text-align: left;"><span style="color: blue"> Function name</span></th>
<th style="text-align: left;"> <span style="color: blue">Input arguments</span></th>
<th style="text-align: left;"> <span style="color: blue">Output</span>  </th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"> <code>Create_SimpleModel</code>  </td>
<td style="text-align: left;"> <code>XYZ</code>, <code>CON</code>, <code>BOUN</code>, <code>ElemName</code>  </td>
<td style="text-align: left;"> <code>Model</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"> <code>Create_NodalForces</code>  </td>
<td style="text-align: left;"> <code>Model</code>, <code>Pe</code></td>
<td style="text-align: left;"> <code>Pf</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <code>Create_PwForces</code>  </td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code></td>
<td style="text-align: left;"> <code>Pw</code></td>
</tr>
</tbody>
</table>
</div>
<p>The folder <code>Utilities</code> contains 28 functions. Almost all functions in this folder are provided in content-obscured form (encoded <code>.p</code> file format), since the implementation details have no bearing on the structural analysis concepts and may only be of interest to readers with programming curiosity and skills. They can be classified in the following categories:</p>
<ol type="1">
<li><p>: 2, namely <code>CleanStart</code> and <code>Print_PDFile</code>.</p></li>
<li><p>: 13. These are listed in .</p></li>
<li><p>: 13. These are not invoked directly, but are used by the analysis functions and scripts and by the graphics utility functions. They are not described further in this text, since they are of little interest to the user, but details about input and output arguments may be found in the online help.</p></li>
</ol>
<div id="T:GraphUtil">
<table>
<caption>Graphics Utility Functions</caption>
<thead>
<tr class="header">
<th style="text-align: left;"> <span style="color: blue">Function name</span></th>
<th style="text-align: left;"> <span style="color: blue">Input arguments (optional)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"> <code>Create_Window</code></td>
<td style="text-align: left;"> <code>DX</code>, <code>DY</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"> <code>Plot_Model</code></td>
<td style="text-align: left;"> <code>Model</code>, (<code>Uf</code>) , (<code>Options</code>)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <code>Label_Model</code></td>
<td style="text-align: left;"> <code>Model</code>, (<code>Options</code>)</td>
</tr>
<tr class="even">
<td style="text-align: left;"> <code>Plot_NodalForces</code></td>
<td style="text-align: left;"> <code>Model</code>, <code>Pe</code> , (<code>Options</code>) </td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <code>Plot_ElementLoading</code></td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code> , (<code>Options</code>) </td>
</tr>
<tr class="even">
<td style="text-align: left;"> <code>Plot_Releases</code></td>
<td style="text-align: left;"> <code>Model</code>, (<code>ElemData</code>) , (<code>Uf</code>) , (<code>Options</code>) </td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <code>Plot_AxialForces</code></td>
<td style="text-align: left;"> <code>Model</code>, <code>Q</code>, (<code>ElemList</code>), (<code>Scale</code>)</td>
</tr>
<tr class="even">
<td style="text-align: left;"> <code>Label_AxialForces</code></td>
<td style="text-align: left;"> <code>Model</code>, <code>Q</code>, (<code>ElemList</code>), (<code>Digit</code>), (<code>Units</code>)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <code>Plot_2dMomntDistr</code></td>
<td style="text-align: left;"> <code>Model</code>, (<code>ElemData</code>), <code>Q</code>, (<code>ElemList</code>), (<code>Scale</code>)  </td>
</tr>
<tr class="even">
<td style="text-align: left;"> <code>Label_2dMoments</code></td>
<td style="text-align: left;"> <code>Model</code>, <code>Q</code>, (<code>ElemList</code>), (<code>Digit</code>), (<code>Units</code>)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <code>Plot_2dCurvDistr</code></td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code>, <code>Q</code>, (<code>ElemList</code>), (<code>Scale</code>)  </td>
</tr>
<tr class="even">
<td style="text-align: left;"> <code>Plot_DeformedStructure</code>  </td>
<td style="text-align: left;"> <code>Model</code>, (<code>ElemData</code>), <code>Uf</code>, (<code>Ve</code>), (<code>Options</code>)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <code>Plot_PlasticHinges</code></td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code>, (<code>Uf</code>), <code>Q</code>, (<code>Options</code>)</td>
</tr>
</tbody>
</table>
</div>
<p>The user defines the geometry and properties of the structural model, and then specifies the structural analysis procedure(s) and the graphical post-processing of the results by selecting suitable functions from - in a  script file, as described in the following sections. Scripting affords extensive flexibility for the response determination and the presentation of the results, but puts the burden on the user to assemble the whole by understanding its parts. This supports the open-ended educational mission of , as opposed to the black-box nature of commercial analysis software.</p>
<p>The following sections describe the functions in - with examples. The notation for function arguments and local variables agrees with the notation of the course reader, as summarized in Appendix.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> The examples in this chapter correspond to examples of the course reader with the  scripts for all examples available in the folder <code>Examples</code> of the basic  package.</p>
<h2 id="data-organization">Data Organization</h2>
<p>The initial set of analysis functions for the concepts of an introductory course on structural analysis is built around two data structures:  for the geometric description of the structural model, and  for the element and material properties and element loading, as is evident from the input argument list of the functions in -. The organization of structural model information in two data structures serves to emphasize the concept of the introductory structural analysis course that, under linear conditions, the governing static and kinematic relations depend only on the geometry of the structural model and not on any element properties. Accordingly, the functions <code>B_matrix</code> for setting up the equilibrium matrix <span class="math inline">\(\mathbf{B}\)</span> and <code>A_matrix</code> for setting up the kinematic matrix <span class="math inline">\(\mathbf{A}\)</span> of the structure take as single input argument the data structure  with model geometry information.</p>
<h3 id="data-structure">Data Structure</h3>
<p>In  information about the structural model is collected in the data structure , which is set up by the function  from information supplied by the user. The function  is limited to models consisting of 2-node, 2d or 3d truss and frame elements. The function numbers the degrees of freedom (DOFs) of the structure, as discussed in the course reader, thus facilitating their identification for small structural models. With this degree of freedom (DOF) numbering the analysis functions set up matrices that do not take advantage of the small number of non-zero terms in large structural models. The general model creation function  does not have limitations on element type and uses a DOF numbering scheme that minimizes the storage of structure matrices. The use of sparse matrices with minimum storage is essential for the analysis of large structural models with 2d and 3d finite elements.</p>
<figure>
<img src="StatTrEx2" id="F:ModelInp" alt="Specification of model geometry for plane truss in script file Ex3_1.m" /><figcaption aria-hidden="true">Specification of model geometry for plane truss in script file Ex3_1.m</figcaption>
</figure>
<div class="sourceCode" id="cb1"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<p>shows the input data for the structure of in the form of numerical arrays <code>XYZ</code>, <code>BOUN</code>, and <code>CON</code>. The rows of <code>XYZ</code> correspond to the nodes and the <span class="math inline">\(ndm\)</span> columns to the node coordinates, where <span class="math inline">\(ndm\)</span> is the dimension of the structural model. The rows of <code>BOUN</code> also correspond to the nodes and the <span class="math inline">\(ndf\)</span> columns to node restraint switches, where <span class="math inline">\(ndf\)</span> is the maximum number of DOFs per node for the model. The DOF order for each node is: 1 = force in <span class="math inline">\(X\)</span>, 2 = force in <span class="math inline">\(Y\)</span>, 3 = moment about <span class="math inline">\(Z\)</span> (for 2d model), or force in <span class="math inline">\(Z\)</span> (for 3d model), 4,5,6 = moment about <span class="math inline">\(X\)</span>, <span class="math inline">\(Y\)</span> and <span class="math inline">\(Z\)</span>, respectively (for 3d model). The switch value 0 indicates a free and the value 1 a restrained DOF. <code>CON</code> can be a numerical array for a structural model with only 2-node elements. For finite element models with elements having a different number of nodes, <code>CON</code> needs to be specified as a so that the row contents can vary from element to element. Each row of the numerical <code>CON</code> array contains the node numbers to which the corresponding element connects. Finally, <code>ElemName</code> is a that accommodates element names with a different number of characters. The names ‘Truss’ and ‘2dFrm’ suffice for tasks that do not require element and material properties. For tasks requiring element and material properties the element names need to be ‘LinTruss,’ ‘Lin2dFrm,’ and ‘Lin3dFrm’ for the 2d/3d truss, the 2d frame, and the 3d frame element, respectively.</p>
<p>At the start of each input script the command <code>CleanStart</code> issues two  commands, one for clearing the computer memory of all stored variable values (<code>clearvars</code>), and the second for closing any open figure windows (<code>close all</code>). It may also be expedient to include the call to the function <code>Create_Units</code> at the start of each script, so as to take advantage of the unit definitions in the return argument <code>Units</code> and obviate the need for unit conversion in the values of variables with different units.</p>
<p>The command</p>
<p>generates the data structure . Once <code>Model</code> is created its contents can be displayed by <code>disp(Model)</code>.</p>
<div class="MLbox">
<div class="sourceCode" id="cb2"><pre class="sourceCode default"><code class="sourceCode default"></code></pre></div>
</div>
<p>shows the fields and some of their contents for the data structure  of the truss in : <span class="math inline">\(nn\)</span> is the number of nodes of the structural model, <span class="math inline">\(ndm\)</span> the model dimension, <code>XYZ</code> the node coordinate array, <span class="math inline">\(ne\)</span> the number of elements, <code>CON</code> a cell array of element connectivity with the row number corresponding to the element number (by conversion of the numerical array <code>CON</code> supplied as input argument), <span class="math inline">\(nq\)</span> the number of basic forces in each element, <span class="math inline">\(ndf\)</span> the number of local DOFs/node and <span class="math inline">\(nen\)</span> the number of end nodes of each element, <code>ElemName</code> the cell array of element types, <span class="math inline">\(nt\)</span> the total number of DOFs, <code>BOUN</code> the array of node restraint switches, <span class="math inline">\(nf\)</span> the number of free DOFs, and <code>DOF</code> the global DOF numbering array. Typing <code>Model</code> or <code>disp(Model)</code> at the command prompt only shows contents of scalar fields of  and numeric or cell arrays that can be displayed in a single line, as shows (numeric arrays have <code>[ ]</code> delimiters and cell arrays have <code>{ }</code> delimiters in ). To display the contents of fields of other array types, type the data structure name and the field name separated by a period as input argument to the  function <code>disp</code> to avoid echoing the variable name:</p>
<div class="flushleft">
<p><code>Model.XYZ</code> for node coordinates</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode default"><code class="sourceCode default"></code></pre></div>
</div>
<div class="flushleft">
<p><code>Model.BOUN</code> for node restraint switches</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode default"><code class="sourceCode default"></code></pre></div>
</div>
<div class="flushleft">
<p><code>Model.DOF</code> for global DOF numbering</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode default"><code class="sourceCode default"></code></pre></div>
</div>
<h3 id="data-structure-for-element-properties-and-loading">Data Structure  for Element Properties and Loading</h3>
<p> is the second data structure of  after . It is specified entirely by the user. Because the element property data vary from element to element, it is necessary to use a cell array for  so that the array contents can vary from element to element.  is a one dimensional cell array with the row number corresponding to the element number. It has the fields in with optional fields with default value 0 shown in parentheses.</p>
<div id="T:ElDatafields">
<table>
<caption> fields (optional fields with default value 0 in parentheses)</caption>
<thead>
<tr class="header">
<th style="text-align: center;"><span style="color: blue">Field</span></th>
<th style="text-align: left;"> <span style="color: blue">Description</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code>E</code></td>
<td style="text-align: left;"> elastic material modulus (scalar)</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>A</code></td>
<td style="text-align: left;"> cross section area (scalar)</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>I</code></td>
<td style="text-align: left;"> moment of inertia (scalar) (2d frame only)</td>
</tr>
<tr class="even">
<td style="text-align: center;"> (<code>Release</code>)  </td>
<td style="text-align: left;"> 3x1 vector of release codes; 0=continuous, 1=release (2d frame only)  </td>
</tr>
<tr class="odd">
<td style="text-align: center;">(<code>w</code>)</td>
<td style="text-align: left;"> uniform element load, 2x1 vector with <span class="math inline">\(w_x\)</span> and <span class="math inline">\(w_y\)</span> (2d frame only)</td>
</tr>
<tr class="even">
<td style="text-align: center;">(<code>e0</code>)</td>
<td style="text-align: left;"> non-mechanical effects, 2x1 vector with <span class="math inline">\(\epsilon_0\)</span> and <span class="math inline">\(\kappa_0\)</span> (2d frame only)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">(<code>q0</code>)</td>
<td style="text-align: left;"> initial prestressing force (scalar) (truss only)</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>Np</code></td>
<td style="text-align: left;"> plastic axial capacity (scalar)</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>Mp</code></td>
<td style="text-align: left;"> plastic flexural capacity (scalar) (2d frame only)</td>
</tr>
</tbody>
</table>
</div>
<p>shows that  includes a field <code>Np</code> for the plastic axial capacity and a field <code>Mp</code> for the plastic flexural capacity. . Otherwise, the plastic capacities of the elements may be directly specified with vector <span class="math inline">\(\mathbf{Q}_{pl}\)</span>, as discussed later in this chapter.</p>
<div class="MLbox">
<div class="sourceCode" id="cb6"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<div class="MLbox">
<div class="sourceCode" id="cb8"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<h2 id="general-utility-functions">General Utility Functions</h2>
<p>Once the geometry and other relevant information about the structural model is collected in data structure  by the function , information about the geometry and the global DOF correspondence for a particular element can be extracted with the help of two general utility functions: <code>Localize</code> and <code>ElmLenOr</code>. All functions with input arguments  and  in invoke these utility functions for setting up the corresponding structural matrices or vectors.</p>
<h3 id="function-localize">Function <code>Localize</code></h3>
<p>This function locates the element <code>el</code> in the  and returns its end node coordinates in array <code>xyz</code>, and the local-global DOF correspondence in vector <code>id</code>. The first column of the two dimensional array <code>xyz</code> contains the coordinates of end <span class="math inline">\(i\)</span> of the element and the second column those of end <span class="math inline">\(j\)</span>.</p>
<h3 id="function-elmlenor">Function <code>ElmLenOr</code></h3>
<p>This function returns the element length <code>L</code> and the direction cosines of the element <span class="math inline">\(x\)</span>-axis in vector <code>dcx</code> from the end node coordinates supplied in array <code>xyz</code>.</p>
<h2 id="structural-equilibrium">Structural Equilibrium</h2>
<p>The global DOF equilibrium equations of the structural model are given by . As discussed in , the equilibrium equations at the free DOFs of the structural model in are used to solve for the basic forces <span class="math inline">\(\mathbf{Q}_{}\)</span>. For determining the solution of these equations it is necessary to set up the applied nodal forces <span class="math inline">\(\mathbf{P}_{f}\)</span>, the equivalent nodal forces <span class="math inline">\(\mathbf{P}_{fw}\)</span> and the equilibrium matrix <span class="math inline">\(\mathbf{B}_{f}\)</span>. The latter is extracted from the full equilibrium matrix <span class="math inline">\(\mathbf{B}_{}\)</span>.</p>
<h3 id="S:FLBfAssembly">Assembly of Equilibrium Matrix <span class="math inline">\(\mathbf{B}_{}\)</span></h3>
<p>The assembly of the equilibrium matrix <span class="math inline">\(\mathbf{B}_{}\)</span> of the structural model in involves the determination of the equilibrium matrix <span class="math inline">\(\mathbf{b}_g\)</span> of each element and the re-assignment of the rows of <span class="math inline">\(\mathbf{b}_g\)</span> to the rows of <span class="math inline">\(\mathbf{B}_{}\)</span> based on the local-global DOF number correspondence in accordance with the <span class="math inline">\(\boldsymbol{id}\)</span> array of the element. Setting up the equilibrium matrix <span class="math inline">\(\mathbf{b}_g\)</span> of each element according to , or for a 2d frame, a 2d truss and a 3d truss element, respectively, requires the element length <span class="math inline">\(L\)</span> and the direction cosines of the undeformed element <span class="math inline">\(x\)</span>-axis. These are set up by the utility function <code>ElmLenOr</code> in conjunction with the utility function <code>Localize</code>, which also sets up the <span class="math inline">\(\boldsymbol{id}\)</span> array for the element, as described earlier.</p>
<p>The assembly of the <span class="math inline">\(\mathbf{B}_{}\)</span> matrix according to is implemented in  function , as shown in . The function  calls the internal function <code>bg_matrix</code> to set up the equilibrium matrix <span class="math inline">\(\mathbf{b}_g\)</span> of each element according to , or for a 2d frame, a 2d truss and a 3d truss element, respectively. The function syntax is given in .</p>
<p>Because the data structure  does not have information about basic force releases, it is the user’s responsibility to remove the columns of the <span class="math inline">\(\mathbf{B}_{}\)</span>-matrix corresponding to basic force releases so that the difference between the number of columns and the number of rows of the <span class="math inline">\(\mathbf{B}_{}\)</span>-matrix matches the degree of static indeterminacy  of the structural model. A convenient way for setting up an index of element release locations is furnished by the utility function <code>H_index</code> with information about the element releases in , as will be discussed later.</p>
<p>After setting up the complete equilibrium matrix <span class="math inline">\(\mathbf{B}_{}\)</span> for the structural model, the equilibrium matrix <span class="math inline">\(\mathbf{B}_{f}\)</span> for the free DOFs corresponds to the upper <span class="math inline">\(nf\)</span> rows of <span class="math inline">\(\mathbf{B}_{}\)</span>. It can be extracted with the statement</p>
<div class="MLbox">
<div class="sourceCode" id="cb10"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<h3 id="S:SpecNF">Specification of Nodal Forces</h3>
<figure>
<img src="StatTrEx2" id="F:PfInp" alt="Specification of applied nodal forces in the script file Ex3_1.m" /><figcaption aria-hidden="true">Specification of applied nodal forces in the script file Ex3_1.m</figcaption>
</figure>
<div class="sourceCode" id="cb14"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<p>The next task for setting up the node equilibrium equations of the structural model is the specification of the applied and the equivalent nodal forces. For this task it is impractical to know the global DOF numbering for directly setting up the applied and the equivalent nodal force vectors <span class="math inline">\(\mathbf{P}_{f}\)</span> and <span class="math inline">\(\mathbf{P}_{fw}\)</span> at the free DOFs, respectively. Instead, it is convenient to specify the nodal forces in a two dimensional array <code>Pe</code> with row numbers corresponding to node numbers and column numbers corresponding to DOF numbers, where 1 = force in <span class="math inline">\(X\)</span>, 2 = force in <span class="math inline">\(Y\)</span>, 3 = moment about <span class="math inline">\(Z\)</span> (for 2d model), or force in <span class="math inline">\(Z\)</span> (for 3d model), 4,5,6 = moment about <span class="math inline">\(X\)</span>, <span class="math inline">\(Y\)</span> and <span class="math inline">\(Z\)</span>, respectively (for 3d model). With the global DOF numbering available in the data structure , the  function  in sets-up the nodal force vector. The input arguments to the function are the data structure  and the two dimensional nodal force array <code>Pe</code>, while the output argument is the nodal force vector <code>Pf</code>. shows the syntax for the applied nodal forces of the truss from . The equivalent nodal forces <span class="math inline">\(\mathbf{P}_{w}\)</span> are set up by the function <code>Create_PwForces</code> in for the element loading <span class="math inline">\(w\)</span> specified in data structure  according to .</p>
<h3 id="S:Q42dtruss">Solution for Statically Determinate Structures</h3>
<p>For a stable, statically determinate structure the equilibrium matrix <span class="math inline">\(\mathbf{B}_{f}\)</span> is square with full rank. The  function <code>rank</code> can be used to make sure that this is indeed the case. Given the nodal forces <span class="math inline">\(\mathbf{P}_{f}\)</span> and <span class="math inline">\(\mathbf{P}_{fw}\)</span> at the free DOFs of a stable structural model, a unique solution of the system of linear equations in exists, resulting in the basic forces <span class="math inline">\(\mathbf{Q}_{}\)</span> of the structure. The product of the basic forces <span class="math inline">\(\mathbf{Q}_{}\)</span> with the full equilibrium matrix <span class="math inline">\(\mathbf{B}_{}\)</span> gives the complete nodal force vector <span class="math inline">\(\mathbf{P}_{}\)</span> according to . The entries in the upper <span class="math inline">\(nf\)</span> rows of <span class="math inline">\(\mathbf{P}_{}\)</span> correspond to the nodal forces <span class="math inline">\(\mathbf{P}_{f}-\mathbf{P}_{fw}\)</span>, and the entries in the remaining rows correspond to the support reactions <span class="math inline">\(\mathbf{R}_{}\)</span> according to .</p>
<p>shows an excerpt from a  script file that follows the generation of  in and of the applied nodal force vector <span class="math inline">\(\mathbf{P}_{f}\)</span> in . The script shows the determination of the equilibrium matrix <span class="math inline">\(\mathbf{B}_{}\)</span> with function  and its display, the solution of the equilibrium equations in with the  <span class="math inline">\(\backslash\)</span> command, and the resulting basic forces <span class="math inline">\(\mathbf{Q}_{}\)</span>. The basic forces <span class="math inline">\(\mathbf{Q}_{}\)</span> are then used to determine the support reactions <span class="math inline">\(\mathbf{R}_{}\)</span> after first multiplying these with the full equilibrium matrix <span class="math inline">\(\mathbf{B}_{}\)</span> and then extracting the rows corresponding to the restrained DOFs.</p>
<div class="MLbox">
<div class="sourceCode" id="cb15"><pre class="sourceCode default"><code class="sourceCode default"></code></pre></div>
</div>
<h3 id="solution-for-statically-indeterminate-structures">Solution for Statically Indeterminate Structures</h3>
<p>The general solution of the equilibrium equations in for a equilibrium matrix <span class="math inline">\(\mathbf{B}_{f}\)</span> with full rank and with more columns than rows uses . Conversion of a matrix to row-echelon form uses the Gauss-Jordan elimination procedure. This well established procedure of linear algebra is implemented in the function <code>rref</code> of . It can be used to establish the rank of <span class="math inline">\(\mathbf{B}_{f}\)</span> and provide the particular and the homogeneous solutions of the equilibrium equations according to .</p>
<p>Following the general solution of the equilibrium equations in is based on the basic force influence matrix <span class="math inline">\(\bar{\mathbf{B}}_i\)</span> of for the applied and equivalent nodal forces, and the basic force influence matrix <span class="math inline">\(\bar{\mathbf{B}}_x\)</span> for the redundant basic forces <span class="math inline">\(\mathbf{Q}_{x}\)</span>.  function  takes the equilibrium matrix <span class="math inline">\(\mathbf{B}_{f}\)</span> as input argument and uses its reduced-row echelon form to set up the force influence matrices <span class="math inline">\(\bar{\mathbf{B}}_i\)</span> and <span class="math inline">\(\bar{\mathbf{B}}_x\)</span>. The optional function argument <code>ind_r</code> can be used to select specific basic forces as redundants. If <code>ind_r</code> is not specified, the Gauss-Jordan elimination process selects the redundant basic forces automatically, and the function  returns the index array <code>ind_x</code> to the basic force vector <span class="math inline">\(\mathbf{Q}_{}\)</span>, so that the redundant basic forces <span class="math inline">\(\mathbf{Q}_{x}\)</span> can be extracted with <code>Qx = Q(ind_x)</code>. The function syntax is</p>
<div class="MLbox">
<div class="sourceCode" id="cb16"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode default"><code class="sourceCode default"></code></pre></div>
</div>
<p>shows the direct specification of the <span class="math inline">\(\mathbf{B}_{f}\)</span> matrix for the braced frame of that corresponds to the equilibrium equations in . The function  then determines the force influence matrices <span class="math inline">\(\bar{\mathbf{B}}_i\)</span> and <span class="math inline">\(\bar{\mathbf{B}}_x\)</span> for the selection of <span class="math inline">\(\mathbf{Q}_1\)</span> and <span class="math inline">\(\mathbf{Q}_4\)</span> as redundant basic forces, as specified by <code>ind_r=[1,4]</code>. With the direct specification of the nodal force vector <span class="math inline">\(\mathbf{P}_{f}\)</span> the particular solution for the given nodal forces can be determined by the product <span class="math inline">\(\bar{\mathbf{B}}_i\mspace{1.5mu}\mathbf{P}_{f}\)</span>. The resulting values agree with those from (b) and (c).</p>
<h2 id="structural-kinematics">Structural Kinematics</h2>
<p>The structural kinematic relations in relate the element deformations <span class="math inline">\(\mathbf{V}_{}\)</span> to the free global DOF displacements <span class="math inline">\(\mathbf{U}_{f}\)</span> through the kinematic matrix <span class="math inline">\(\mathbf{A}_{f}\)</span> of the structure. With a given set of element deformations <span class="math inline">\(\mathbf{V}_{}\)</span> the solution of the kinematic relations in gives the values of the free DOF displacements <span class="math inline">\(\mathbf{U}_{f}\)</span>. This approach to the determination of the free DOF displacements is of particular interest for statically determinate structures, for which the number of element deformations is equal to the number of unknown free DOF displacements, so that the element deformations are not constrained by compatibility conditions, as the examples of demonstrate.</p>
<h3 id="assembly-of-kinematic-matrix-mathbfa_">Assembly of Kinematic Matrix <span class="math inline">\(\mathbf{A}_{}\)</span></h3>
<p>Because <span class="math inline">\(\mathbf{A}_f^T=\mathbf{B}_{f}\)</span> according to the principle of virtual work, it is not necessary to create separate functions for setting up the equilibrium matrix <span class="math inline">\(\mathbf{B}_{}\)</span> and the kinematic matrix <span class="math inline">\(\mathbf{A}_{}\)</span>. Nonetheless,  has two separate functions in the interest of completeness.</p>
<p>The assembly of the kinematic matrix <span class="math inline">\(\mathbf{A}_{}\)</span> is completely analogous to that of the equilibrium matrix <span class="math inline">\(\mathbf{B}_{}\)</span> and the corresponding functions practically identical. Nonetheless, a brief description of the process is given in the following.</p>
<p>The assembly of the kinematic matrix <span class="math inline">\(\mathbf{A}_{}\)</span> of the structural model in involves the determination of the kinematic matrix <span class="math inline">\(\mathbf{a}_g\)</span> of each element and the re-assignment of the columns of <span class="math inline">\(\mathbf{a}_g\)</span> to the columns of <span class="math inline">\(\mathbf{A}_{}\)</span> based on the local-global DOF number correspondence in accordance with the <span class="math inline">\(\boldsymbol{id}\)</span> array of the element. The kinematic matrix <span class="math inline">\(\mathbf{a}_g\)</span> of each element is set up according to , , or for 2d frame, 2d truss and 3d truss, respectively, and requires the element length <span class="math inline">\(L\)</span> and the <span class="math inline">\(x\)</span>-axis orientation in the form of the direction cosines, as discussed for the equilibrium matrix <span class="math inline">\(\mathbf{b}_g\)</span> in .</p>
<div class="MLbox">
<div class="sourceCode" id="cb18"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<p>gives the syntax for function . The function  calls the internal function <code>ag_matrix</code> to set up the kinematic matrix <span class="math inline">\(\mathbf{a}_g\)</span> of each element according to , , or for 2d frame, 2d truss and 3d truss, respectively. The function syntax is given in .</p>
<p>Because the data structure  does not have information about basic force releases, it is the user’s responsibility to remove the rows of the <span class="math inline">\(\mathbf{A}_{}\)</span>-matrix corresponding to element ends with release deformations <span class="math inline">\(\mathbf{V}_{h}\)</span>. After setting up the complete kinematic matrix <span class="math inline">\(\mathbf{A}_{}\)</span> for the structural model, the kinematic matrix <span class="math inline">\(\mathbf{A}_{f}\)</span> for the free DOFs corresponds to the first <span class="math inline">\(nf\)</span> columns of <span class="math inline">\(\mathbf{A}_{}\)</span>. For a stable, statically determinate structure the kinematic matrix <span class="math inline">\(\mathbf{A}_{f}\)</span> is square with full rank. Given the element deformations <span class="math inline">\(\mathbf{V}_{}\)</span>, a unique solution of the system of linear equations in exists, resulting in the displacements <span class="math inline">\(\mathbf{U}_{f}\)</span> at the free DOFs of the structural model.</p>
<p>The excerpt from a  script file in follows the input data for the plane truss of and the command . The element deformation vector <code>V0</code> is populated with zeroes. It has size equal to the total number of basic forces <code>sum(Model.nq)</code> for this model which does not have element releases. After specifying the non-zero values of the element deformations the solution of the kinematic relations in gives the free DOF displacements <code>Uf</code>. The values are identical with those of with the corresponding deformed shape in .</p>
<div class="MLbox">
<div class="sourceCode" id="cb22"><pre class="sourceCode default"><code class="sourceCode default"></code></pre></div>
</div>
<h2 id="force-deformation-relations-for-linear-material-response">Force-Deformation Relations for Linear Material Response</h2>
<p>establishes the deformation-force relations of the truss element in and of the 2d frame element in . The collection of these relations for all elements of the structural model results in the structure deformation-force relations in . Consequently, the collection of the element flexibility matrices <span class="math inline">\(\mathbf{f}\)</span> to form the matrix <span class="math inline">\(\mathbf{F}_{s}\)</span> and the collection of the initial element deformation vectors <span class="math inline">\(\boldsymbol{v}_0\)</span> to form the vector <span class="math inline">\(\mathbf{V}_{o}\)</span> depends on setting up <span class="math inline">\(\mathbf{f}\)</span> and <span class="math inline">\(\boldsymbol{v}_0\)</span> for all elements of the structural model. The latter depend on the material properties and the loading of each element which are supplied in  according to the information in .</p>
<h3 id="force-deformation-functions">Force-Deformation Functions</h3>
<p>With the element property and loading information in , the  function  collects the element flexibility matrices into the block-diagonal matrix <span class="math inline">\(\mathbf{F}_{s}\)</span> according to . Similarly, the function  collects the initial element deformations into vector <span class="math inline">\(\mathbf{V}_{o}\)</span>.</p>
<div class="MLbox">
<div class="sourceCode" id="cb23"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<div class="MLbox">
<div class="sourceCode" id="cb25"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<p>The syntax of function  is shown in.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> The function  calls the internal function <code>f_matrix</code> to set up the flexibility matrix <span class="math inline">\(\mathbf{f}\)</span> for each element according to with the flexibility matrices for the truss element in and for the 2d frame element in . The function syntax is given in . The function  has similar syntax and is not listed here.</p>
<p>According to , the element force-deformation relations are established as the inverse of the deformation-force relations of the element with the basic element stiffness matrix <span class="math inline">\(\mathbf{k}\)</span> equal to the inverse of the element flexibility matrix <span class="math inline">\(\mathbf{f}\)</span> and the initial force vector <span class="math inline">\(\boldsymbol{q}_0\)</span> according to .</p>
<div class="MLbox">
<div class="sourceCode" id="cb27"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<div class="MLbox">
<div class="sourceCode" id="cb29"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<div class="MLbox">
<div class="sourceCode" id="cb31"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<p> function  collects the basic element stiffness matrices into the block-diagonal matrix <span class="math inline">\(\mathbf{K}_{s}\)</span> according to . Similarly, the function  collects the initial element forces into vector <span class="math inline">\(\mathbf{Q}_{o}\)</span>.</p>
<p>The function  calls the internal function <code>k_matrix</code> to set up the stiffness matrix <span class="math inline">\(\mathbf{k}\)</span> for each element according to with the stiffness for the truss element in and the stiffness matrix of the 2d frame element in or depending on the presence of an end moment release. The syntax of function  is shown in , while the syntax for the internal function <code>k_matrix</code> is given in .</p>
<p>The syntax of function  is very similar except for the collection of vectors instead of matrices. The function calls the internal function <code>q0_vector</code> with the function syntax in to set up the initial force vector <span class="math inline">\(\boldsymbol{q}_0\)</span> of each element according to , and .</p>
<h2 id="force-method-of-analysis">Force Method of Analysis</h2>
<p>The steps of the force method of analysis are summarized in . This step sequence is implemented in the  script file <code>S_ForceMethod</code>.</p>
<p>In contrast to a function, a script file operates on the variables in the workspace memory and stores its output also in the workspace memory.  makes use of script files for two purposes:</p>
<ol type="1">
<li><p>to define several variables at once and place them in the workspace for easy access or to issue a few simple  commands with a single call rather than individually;</p></li>
<li><p>to collect a series of commands involving  functions into solution procedures that can be invoked with a single call from the workspace; such scripts are identified with prefix <code>S_</code> and can be easily modified to suit individual needs. The limitation of such a script, however, is that variables serving as input arguments to the functions in the script should be present in the workspace with the same syntax as the function arguments in the script.</p></li>
</ol>
<p>All script variables reside in the  workspace and are, therefore, of global character. Such variables may lead to name conflicts, if care is not exercised. In contrast, variables in functions are local and can only be accessed if they appear in the input or output argument list. Clearly, this is the preferred approach for data protection in a modular computing environment. For this reason, scripts are used sparingly in .</p>
<div class="MLbox">
<div class="sourceCode" id="cb33"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<p>The script <code>S_ForceMethod</code> depends on the definition of the structural model geometry in the data structure , and on the specification of the element property and loading information in the data structure . The specification of an index <code>ind_r</code> for the redundant basic forces is optional, as is the specification of the nodal forces <span style="color: blue"><code>Pf</code></span> and <span style="color: blue"><code>Pwf</code></span>. The default value for the nodal forces is zero.</p>
<p>The command sequence for the implementation of the force method of analysis according to is divided in two parts in : (a) the setting up of the necessary matrices <span class="math inline">\(\mathbf{B}_{}\)</span>, <span class="math inline">\(\bar{\mathbf{B}}_i\)</span>, <span class="math inline">\(\bar{\mathbf{B}}_x\)</span>, <span class="math inline">\(\mathbf{F}_{s}\)</span> and the vector <span class="math inline">\(\mathbf{V}_{o}\)</span> from information in  and , and (b) the solution steps of the force method. The script generates the basic forces <span class="math inline">\(\mathbf{Q}_{}\)</span> of the structural model, the corresponding element deformations <span class="math inline">\(\boldsymbol{V}_{\varepsilon}\)</span>, and the free DOF displacements <span class="math inline">\(\mathbf{U}_{f}\)</span>. These can be used for response interpretation, as will be discussed in .</p>
<p>The script <code>S_ForceMethod</code> uses two auxiliary functions: (a) <code>H_index</code> to set up a cell array of indices for continuous element deformations from information in the field <code>Release</code> of , and (b) <code>Complete_QV</code> which uses the same information to pad the basic forces <span class="math inline">\(\mathbf{Q}_{}\)</span> from the force method of analysis with zero values at the releases, so that it can determine the element deformations <span class="math inline">\(\boldsymbol{V}_{\varepsilon}\)</span> at the ends with flexural releases and plot the deformed shape of the corresponding element, if required.</p>
<h2 id="S:DMinFL">Displacement Method of Analysis</h2>
<p>The steps of the displacement method of analysis are described in and . A summary of these steps for implementation in  is:</p>
<ol type="1">
<li><p>With the kinematic matrix <span class="math inline">\(\mathbf{A}_{f}\)</span> set up the stiffness matrix <span class="math inline">\(\mathbf{K}_{f}\)</span> and the initial force vector <span class="math inline">\(\mathbf{P}_{o}\)</span> <span class="math display">\[\mathbf{K}_{f}= \mathbf{A}_f^T\mspace{1.5mu}\mathbf{K}_{s}\mspace{1.5mu}\mathbf{A}_{f}\quad \quad \mathbf{P}_{o}= \mathbf{A}_f^T\mspace{1.5mu}\mathbf{Q}_{o}+ \mathbf{P}_{fw}\]</span></p></li>
<li><p>Solve the equilibrium equations for the free DOF displacements <span class="math inline">\(\mathbf{U}_{f}\)</span> <span class="math display">\[\boxed{ \mathbf{P}_{f}= \mathbf{K}_{f}\mspace{1.5mu}\mathbf{U}_{f}+ \mathbf{P}_{o}}\]</span></p></li>
<li><p>Determine the element deformations <span class="math inline">\(\mathbf{V}_{}\)</span> from the kinematic relations <span class="math display">\[\boxed{ \mathbf{V}_{}= \mathbf{A}_{f}\mspace{1.5mu}\mathbf{U}_{f}}\]</span></p></li>
<li><p>Determine the basic forces <span class="math inline">\(\mathbf{Q}_{}\)</span> from the collection of element force-deformation relations <span class="math display">\[\boxed{ \mathbf{Q}_{}= \mathbf{K}_{s}\mspace{1.5mu}\mathbf{V}_{}+ \mathbf{Q}_{o}}\]</span></p></li>
</ol>
<p>shows the implementation of these steps in the  script file <code>S_DisplMethod</code>.</p>
<div class="MLbox">
<div class="sourceCode" id="cb35"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<p>As is the case with the script for the force method of analysis, the script <code>S_DisplMethod</code> depends on the definition of the structural model geometry in the data structure , and on the specification of the element property and loading information in the data structure . The specification of the nodal forces <span style="color: blue"><code>Pf</code></span> and <span style="color: blue"><code>Pwf</code></span> is optional with default values equal to zero. The script uses the same auxiliary functions as the script for the force method to remove the rows of the kinematic matrix <span class="math inline">\(\mathbf{A}_{}\)</span> with release deformations and pad the vector of basic forces <span class="math inline">\(\mathbf{Q}_{}\)</span> from the displacement method of analysis with zero values at the releases, so that it can determine the element deformations <span class="math inline">\(\boldsymbol{V}_{\varepsilon}\)</span> at the element ends with flexural releases and plot the deformed shape of the corresponding element, if required.</p>
<h2 id="direct-stiffness-assembly">Direct Stiffness Assembly</h2>
<p>demonstrates the significant advantage of the displacement method over the force method of analysis: the direct assembly of the structure stiffness matrix <span class="math inline">\(\mathbf{K}_{f}\)</span> and the resisting forces <span class="math inline">\(\mathbf{P}_{r}\)</span>. We demonstrate briefly the ease of implementing the direct stiffness assembly in  by taking advantage of the array indexing capabilities of  described in Appendix <a href="#C:ArrayIndx" data-reference-type="ref" data-reference="C:ArrayIndx">[C:ArrayIndx]</a> and avoiding the multiplication by the Boolean array in . The latter approach is symbolically compact but computationally inefficient, because the Boolean matrix <span class="math inline">\(\mathbf{A}_b^{(el)}\)</span> in contains only a few terms of unit value but mostly zeros.</p>
<p>In the direct assembly process the element <span class="math inline">\(\boldsymbol{id}\)</span> array serves as index of the element stiffness coefficients into the structure stiffness matrix <span class="math inline">\(\breve{\mathbf{K}}\)</span>. The  function <code>Kf_matrix.m</code> assembles the complete stiffness matrix <span class="math inline">\(\breve{\mathbf{K}}\)</span> and then extracts the stiffness <span class="math inline">\(\mathbf{K}_{}\)</span> at the free dofs (in practice only the free dof stiffness <span class="math inline">\(\mathbf{K}_{}\)</span> is assembled to save storage).</p>
<div class="MLbox">
<div class="sourceCode" id="cb37"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<p>shows the function excerpt with the operations of direct stiffness assembly. <code>K</code> corresponds to <span class="math inline">\(\breve{\mathbf{K}}\)</span> and <code>Kf</code> corresponds to <span class="math inline">\(\mathbf{K}_{}\)</span> in the code. The function <code>Kf_matrix.m</code> calls each element by its name, as specified in the field <code>ElemName</code> of <code>Model</code>, gives it its end coordinates and element properties and expects its stiffness matrix in global coordinates as return argument. This operation should be implemented in a separate function for each element, so that new elements can be added with ease. Because we plan to pursue a different implementation in   as will be discussed in the course of Nonlinear Analysis, we include only the truss and the 2d frame element stiffness determination in a subfunction <code>ke_matrix.m</code> of <code>Kf_matrix.m</code>.</p>
<p>gives the element stiffness matrix of the truss and the 2d frame element in global coordinates. The  commands are excerpted in noting that the stiffness determination of the 2d frame element with basic force releases follows the description in .</p>
<div class="MLbox">
<div class="sourceCode" id="cb39"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<h2 id="plastic-analysis">Plastic Analysis</h2>
<p>According to the determination of the collapse load factor of a structural model is possible either with the lower bound theorem of plastic analysis that makes use of the equilibrium equations and the plastic conditions, or with the upper bound theorem of plastic analysis that makes use of the kinematic relations and the plastic work increment of structural mechanisms. Even though the of plastic analysis states that the collapse load factor is the same with these methods,  uses two separate functions to better illustrate the resulting information from each method, which is of equilibrium nature for the lower bound theorem and of kinematic nature for the upper bound theorem. The basic forces at incipient collapse from the lower bound theorem can be used to display the moment distribution at , while the displacement and deformation increments from the upper bound theorem can be used to display the mechanism .</p>
<h3 id="S:PlAnwFlab">Lower Bound Theorem</h3>
<p>The formulation of the lower bound theorem of plastic analysis in of is a . Functions for the solution of such problems are available in the Optimization toolbox of . In particular, the <code>linprog</code> function of the toolbox is suited for structural problems involving . To set up the input arguments for this function the  function  takes the equilibrium matrix <code>Bf</code>, the array of plastic capacities <code>Qpl</code>, and the reference force vector <code>Pref</code> at the free DOFs of the structural model as input arguments. The latter is set up directly or with the help of the function , as discussed in . Optional input arguments to the function  are the constant nodal forces <span class="math inline">\(\mathbf{P}_{cf}\)</span> and the data structure <code>Options</code> with parameters for the linear programming solution. The default value for the constant nodal forces is zero, while the default parameters for the linear programming function that  selects work in most cases. They need to be modified only if numerical difficulties arise.</p>
<div class="MLbox">
<div class="sourceCode" id="cb41"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="sourceCode default"><code class="sourceCode default"></code></pre></div>
</div>
<p>With this information the function  determines the collapse load factor <code>lambdac</code> and the corresponding basic forces <code>Qc</code> of the structure under the collapse load. The syntax of the plastic analysis function is</p>
<p>shows the input arguments to  for the column-girder assembly of . The output arguments are the collapse load factor <code>lambdac</code> and the corresponding basic forces <code>Qc</code> of the structural model under the collapse load.</p>
<h3 id="S:UBPlAnwFlab">Upper Bound Theorem</h3>
<p>The formulation of the upper bound theorem of plastic analysis in , , and of is also a , in fact it is the dual problem of the lower bound theorem in <span class="citation" data-cites="Strang_1988">[@Strang_1988]</span>.</p>
<p>The  function <code>PlasticAnalysis_wUBT</code> sets up the necessary equality and inequality constraints with input arguments <span class="math inline">\(\mathbf{A}_{f}\)</span>, <span class="math inline">\(\mathbf{Q}_{pl}\)</span>, <span class="math inline">\(\boldsymbol{P}_{ref}\)</span>. It invokes the simplex algorithm for the solution of the linear programming problem and returns the collapse load factor <span class="math inline">\(\lambda_c\)</span>, and the displacement rates <span class="math inline">\(\dot{\mathbf{U}_{}}_f\)</span> as displacement increments <code>DUf</code> and the plastic hinge deformation rates <span class="math inline">\(\dot{\mathbf{V}_{}}_{hp}\)</span> as plastic deformation increments <code>DVhp</code> of the collapse mechanism. The syntax is</p>
<p>shows the input arguments to <code>PlasticAnalysis_wUBT</code> for the portal frame of . The function output consists of the collapse load factor <code>lambdac</code>, the corresponding displacement increments <code>DUf</code>, and the plastic hinge deformation increments <code>DVhp</code> of the collapse mechanism. The values match those from .</p>
<h2 id="S:Post">Graphics Utility Functions</h2>
<p> has functions for displaying on the computer screen the geometry of the model and the results of the analysis in the form of internal force distributions, deformed shape, and plastic hinge locations. The graphics utility functions are listed in and are briefly described in the following. These functions depend on several supporting functions in the folder <code>Utilities</code>, which are of no further interest for the user.</p>
<p>Specifically:</p>
<ul>
<li><p>The function <code>Create_Window</code> opens an empty window with two input arguments <code>DX</code> and <code>DY</code> for the percentage of the computer screen that the window occupies in the horizontal and in the vertical direction, respectively. Thus, the function call <code>Create_Window(0.80,0.60)</code> creates an empty window centered on the computer display and occupying 80% of the horizontal display and 60% of the vertical display dimension.</p></li>
<li><p>The function <code>Plot_Model</code> displays the nodes of the structural model connected by straight lines (the element chords).</p></li>
<li><p>The presence of the optional input argument <code>Uf</code> in any plotting function ensures that the information is displayed in the deformed configuration.</p></li>
<li><p>The optional input argument <code>Options</code> in a plotting function is a data structure with fields specifying the attributes of graphical elements. Field descriptions of the data structure <code>Options</code> are given in - for the different plotting functions. Because some fields appear in more than one function, the user should make sure to change the field value before invoking the corresponding function, lest the last definition of the field is used, which may not be the intention.</p></li>
<li><p>The function <code>Label_Model</code> displays node and element numbers of the structural model as well as the coordinate axes for the geometry description.</p></li>
<li><p>The functions for plotting the axial force, the bending moment and the curvature distribution support an optional numerical input argument <code>Scale</code> for the magnification of the distribution display without affecting the numerical values of the internal forces and deformations.</p></li>
<li><p>The functions for labeling the axial force and the bending moment distribution support an optional integer input argument <code>Digit</code> for the number of digits after the comma to display. The default is 1.</p></li>
<li><p>The functions for labeling the axial force and the bending moment distribution support an optional character input argument <code>Units</code>, so that the values of the corresponding internal force are scaled to the specified unit of axial force or bending moment. The function <code>Create_Units.m</code> generates different units of force, moment, length and area in the return argument. The user can define additional dependent units in terms of those already present in the fields of the return argument.</p></li>
<li><p>Plotting and labeling can be limited to some elements of the structural model with the optional argument <code>ElemList</code>. The default option is to display the requested information for all elements of the structural model.</p></li>
<li><p>In the absence of the input argument <code>ElemData</code> the corresponding plot function will display the moment distribution and the deformed shape for the homogeneous solution of the element equilibrium. The field <code>w</code> must be specified in <code>ElemData</code> for the function to display the moment distribution and the deformed shape for the complete solution that includes the particular solution under the element loading.</p></li>
<li><p>The variable <code>Ve</code> corresponds to <span class="math inline">\(\boldsymbol{V}_{\varepsilon}\)</span>, the element deformations of continuous nature.</p></li>
</ul>
<div id="T:OptPlotModel">
<table>
<caption>Fields of the optional input argument <code>Options</code> for function <span style="color: blue"><code>Plot_Model</code></span></caption>
<thead>
<tr class="header">
<th style="text-align: center;"> Field name  </th>
<th style="text-align: left;"> Purpose  </th>
<th style="text-align: center;"> Default value  </th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"> <code>MAGF</code>  </td>
<td style="text-align: left;"> magnification for deformed wireframe  </td>
<td style="text-align: center;"> 10  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>PlNod</code> </td>
<td style="text-align: left;"> switch for displaying node symbols  </td>
<td style="text-align: center;"> <span class="sans-serif">’</span>no<span class="sans-serif">’</span>  </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>PlBnd</code> </td>
<td style="text-align: left;"> switch for displaying boundary symbols  </td>
<td style="text-align: center;"> <span class="sans-serif">’</span>no<span class="sans-serif">’</span>  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>NodSF</code> </td>
<td style="text-align: left;"> scale factor for node symbol  </td>
<td style="text-align: center;"> 1  </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>PlJnt</code> </td>
<td style="text-align: left;"> switch for displaying rigid joint offsets  </td>
<td style="text-align: center;"> <span class="sans-serif">’</span>yes<span class="sans-serif">’</span>  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>LnStl</code> </td>
<td style="text-align: left;"> line style for undeformed/deformed model  </td>
<td style="text-align: center;"> <span class="sans-serif">’</span>-<span class="sans-serif">’</span> / <span class="sans-serif">’</span>-.<span class="sans-serif">’</span>  </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>LnWth</code> </td>
<td style="text-align: left;"> line thickness  </td>
<td style="text-align: center;"> 2  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>LnClr</code> </td>
<td style="text-align: left;"> line color for undeformed/deformed model  </td>
<td style="text-align: center;"> <span class="sans-serif">’</span>b<span class="sans-serif">’</span> / <span class="sans-serif">’</span>k<span class="sans-serif">’</span>  </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>BsClr</code> </td>
<td style="text-align: left;"> color for boundary node and symbol  </td>
<td style="text-align: center;"> [0.6 0 0.6]  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>ModSF</code> </td>
<td style="text-align: left;"> switch for adjusting the scale factor with element size  </td>
<td style="text-align: center;"> <span class="sans-serif">’</span>yes<span class="sans-serif">’</span>  </td>
</tr>
</tbody>
</table>
</div>
<div id="T:OptLabModel">
<table>
<caption>Fields of the optional input argument <code>Options</code> for function <span style="color: blue"><code>Label_Model</code></span></caption>
<thead>
<tr class="header">
<th style="text-align: center;"> Field name  </th>
<th style="text-align: left;"> Purpose  </th>
<th style="text-align: center;"> Default value  </th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"> <code>Item</code>  </td>
<td style="text-align: left;"> ‘node,’‘elem’ or ‘axes’  </td>
<td style="text-align: center;"> <span class="sans-serif">’</span>all<span class="sans-serif">’</span>  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>FntSF</code> </td>
<td style="text-align: left;"> label font scale factor  </td>
<td style="text-align: center;"> 1  </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>AxsSF</code> </td>
<td style="text-align: left;"> coordinate axes arrow scale factor  </td>
<td style="text-align: center;"> 1  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>LOfSF</code> </td>
<td style="text-align: left;"> label offset scale factor  </td>
<td style="text-align: center;"> 1  </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>NList</code> </td>
<td style="text-align: left;"> list of nodes to label  </td>
<td style="text-align: center;"> <code>1:nn</code>  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>EList</code> </td>
<td style="text-align: left;"> list of elements to label  </td>
<td style="text-align: center;"> <code>1:ne</code>  </td>
</tr>
</tbody>
</table>
</div>
<div id="T:OptPlotNForc">
<table>
<caption>Some fields of the optional input argument <code>Options</code> for function <span style="color: blue"><code>Plot_NodalForces</code></span></caption>
<thead>
<tr class="header">
<th style="text-align: center;"> Field name  </th>
<th style="text-align: left;"> Purpose  </th>
<th style="text-align: center;"> Default value  </th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"> <code>FrcSF</code>  </td>
<td style="text-align: left;"> scale factor for force arrow shaft  </td>
<td style="text-align: center;"> 1  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>TipSF</code> </td>
<td style="text-align: left;"> scale factor for force arrow tip  </td>
<td style="text-align: center;"> 1  </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>ArWth</code> </td>
<td style="text-align: left;"> line width for force arrow shaft  </td>
<td style="text-align: center;"> 3  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>ArClr</code> </td>
<td style="text-align: left;"> nodal force arrow color  </td>
<td style="text-align: center;"> <span class="sans-serif">’</span>r<span class="sans-serif">’</span>  </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>Label</code> </td>
<td style="text-align: left;"> <span class="sans-serif">’</span>yes<span class="sans-serif">’</span> / <span class="sans-serif">’</span>no<span class="sans-serif">’</span> for labeling nodal force  </td>
<td style="text-align: center;"> <span class="sans-serif">’</span>No<span class="sans-serif">’</span>  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>FntSF</code> </td>
<td style="text-align: left;"> scale factor for nodal force label  </td>
<td style="text-align: center;"> 1  </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>Digit</code> </td>
<td style="text-align: left;"> number of digits for nodal force label  </td>
<td style="text-align: center;"> 2  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>Units</code> </td>
<td style="text-align: left;"> force units  </td>
<td style="text-align: center;"> base unit  </td>
</tr>
</tbody>
</table>
</div>
<div id="T:OptPlRel">
<table>
<caption>Fields of optional input argument <code>Options</code> for function <span style="color: blue"><code>Plot_Releases</code></span></caption>
<thead>
<tr class="header">
<th style="text-align: center;"> Field name  </th>
<th style="text-align: left;"> Purpose  </th>
<th style="text-align: center;"> Default value  </th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"> <code>MAGF</code>  </td>
<td style="text-align: left;"> magnification factor for deformed model  </td>
<td style="text-align: center;"> 10  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>HngSF</code>  </td>
<td style="text-align: left;"> scale factor for size of hinge symbol  </td>
<td style="text-align: center;"> 1  </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>HOfSF</code>  </td>
<td style="text-align: left;"> factor for hinge symbol offset from element end  </td>
<td style="text-align: center;"> 1  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>AHClr</code>  </td>
<td style="text-align: left;"> display color for axial releases  </td>
<td style="text-align: center;"> light gray  </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>FHClr</code>  </td>
<td style="text-align: left;"> display color for flexural releases  </td>
<td style="text-align: center;"> white  </td>
</tr>
</tbody>
</table>
</div>
<div id="T:OptDefoStr">
<table>
<caption>Fields of optional input argument <code>Options</code> for function <span style="color: blue"><code>Plot_DeformedStructure</code></span></caption>
<thead>
<tr class="header">
<th style="text-align: center;"> Field name  </th>
<th style="text-align: left;"> Purpose  </th>
<th style="text-align: center;"> Default value  </th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"> <code>MAGF</code>  </td>
<td style="text-align: left;"> magnification for deformed configuration  </td>
<td style="text-align: center;"> 10  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>EList</code> </td>
<td style="text-align: left;"> list of elements to include in deformed shape  </td>
<td style="text-align: center;"> <code>1:ne</code>  </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>PlBnd</code> </td>
<td style="text-align: left;"> switch for displaying boundary symbols  </td>
<td style="text-align: center;"> <span class="sans-serif">’</span>Yes<span class="sans-serif">’</span>  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>NodSF</code> </td>
<td style="text-align: left;"> scale factor for size of boundary symbol  </td>
<td style="text-align: center;"> 1  </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>PlJnt</code> </td>
<td style="text-align: left;"> switch for displaying rigid joint offsets  </td>
<td style="text-align: center;"> <span class="sans-serif">’</span>Yes<span class="sans-serif">’</span>  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>PlCrd</code> </td>
<td style="text-align: left;"> switch for displaying element chord  </td>
<td style="text-align: center;"> <span class="sans-serif">’</span>No<span class="sans-serif">’</span>  </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>PlRel</code> </td>
<td style="text-align: left;"> switch for displaying element releases  </td>
<td style="text-align: center;"> <span class="sans-serif">’</span>Yes<span class="sans-serif">’</span>  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>LnStl</code> </td>
<td style="text-align: left;"> line style for deformed shape  </td>
<td style="text-align: center;"> <span class="sans-serif">’</span>-<span class="sans-serif">’</span>  </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>LnWth</code> </td>
<td style="text-align: left;"> line thickness for deformed shape  </td>
<td style="text-align: center;"> 2  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>LnClr</code> </td>
<td style="text-align: left;"> line color for deformed shape  </td>
<td style="text-align: center;"> <span class="sans-serif">’</span>r<span class="sans-serif">’</span>  </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>BsClr</code> </td>
<td style="text-align: left;"> color for boundary node and symbol  </td>
<td style="text-align: center;"> [0.6 0 0.6]  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>HngSF</code> </td>
<td style="text-align: left;"> scale factor for size of release symbol  </td>
<td style="text-align: center;"> 1  </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>HOfSF</code> </td>
<td style="text-align: left;"> scale factor for flexural hinge symbol offset from element end  </td>
<td style="text-align: center;"> 1  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>AHClr</code>  </td>
<td style="text-align: left;"> display color for axial releases  </td>
<td style="text-align: center;"> light gray  </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>FHClr</code>  </td>
<td style="text-align: left;"> display color for flexural releases  </td>
<td style="text-align: center;"> white  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>ModSF</code> </td>
<td style="text-align: left;"> switch for adjusting the scale factor with element size  </td>
<td style="text-align: center;"> <span class="sans-serif">’</span>yes<span class="sans-serif">’</span>  </td>
</tr>
</tbody>
</table>
</div>
<div id="T:OptPlHng">
<table>
<caption>Fields of optional input argument <code>Options</code> for function <span style="color: blue"><code>Plot_PlasticHinges</code></span></caption>
<thead>
<tr class="header">
<th style="text-align: center;"> Field name  </th>
<th style="text-align: left;"> Purpose  </th>
<th style="text-align: center;"> Default value  </th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"> <code>EList</code> </td>
<td style="text-align: left;"> list of elements for which plastic hinges are displayed  </td>
<td style="text-align: center;"> <code>1:ne</code>  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>HngSF</code> </td>
<td style="text-align: left;"> scale factor for size of plastic hinge symbol  </td>
<td style="text-align: center;"> 1  </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>HOfSF</code> </td>
<td style="text-align: left;"> scale factor for flexural hinge offset from element end  </td>
<td style="text-align: center;"> 1  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>FHClr</code> </td>
<td style="text-align: left;"> flexural hinge color  </td>
<td style="text-align: center;"> <span class="sans-serif">’</span>r<span class="sans-serif">’</span>  </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>CHClr</code> </td>
<td style="text-align: left;"> color for column hinge with <span class="math inline">\(N\)</span>-<span class="math inline">\(M\)</span> interaction  </td>
<td style="text-align: center;"> [1 0.6 0]  </td>
</tr>
<tr class="even">
<td style="text-align: center;"> <code>AHClr</code> </td>
<td style="text-align: left;"> axial hinge color in truss elements  </td>
<td style="text-align: center;"> [1 0.6 0]  </td>
</tr>
<tr class="odd">
<td style="text-align: center;"> <code>tol</code> </td>
<td style="text-align: left;"> relative tolerance for plastic capacity check  </td>
<td style="text-align: center;"> <span class="math inline">\(10^{-6}\)</span>  </td>
</tr>
</tbody>
</table>
</div>
<h2 id="examples">Examples</h2>
<p>The examples in this section showcase the main graphics utility functions with further details about features. A separate  script file is available for each example in the course reader with the file name starting with the prefix <code>ChmExn</code> corresponding to the example n in Chapter m of the reader. Salient excerpts from some of these script files are used in the following to showcase the  functions in the preceding sections and, in particular, the graphics utility functions.</p>
<h3 id="plotting-and-labeling-of-model">Plotting and Labeling of Model</h3>
<p>Once the function  creates the data structure   the information about the geometry of the model can be displayed with the functions <code>Plot_Model</code> and <code>Label_Model</code>. The default values for the graphic objects of these functions may result in an unsatisfactory image: disproportionately small size of labels and disproportionately large coordinate axes. Moreover, the default option for the function <code>Plot_Model</code> does not display node and boundary symbols in .</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<figure>
<img src="Ex4_1F2a" id="F:PoorSizeMod" alt="Display of 2d truss model with default values for graphic objects" /><figcaption aria-hidden="true">Display of 2d truss model with default values for graphic objects</figcaption>
</figure>
<p>After turning on the fields <code>PlNod</code> and <code>PlBnd</code> in <code>PlotOpt</code>, adjusting the size of the node and boundary symbols with <code>NodSF</code>, adjusting the size of the coordinate axes with <code>AxsSF</code>, and adjusting the size and offset of labels with <code>FntSz</code> and <code>LOfSz</code>, respectively, the resulting display in is improved significantly.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<figure>
<img src="Ex4_1F2b" id="F:GoodSizeMod" alt="Improved display of 2d truss with custom values for plot options" /><figcaption aria-hidden="true">Improved display of 2d truss with custom values for plot options</figcaption>
</figure>
<p>The default sizing and labeling values produce satisfactory results for the 3d truss model in , as long as the user requests that the node and boundary symbols be displayed.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<figure>
<img src="Ex4_2F1" id="F:GoodSz3dTruss" alt="Satisfactory display of 3d truss with default values for graphic objects" /><figcaption aria-hidden="true">Satisfactory display of 3d truss with default values for graphic objects</figcaption>
</figure>
<h3 id="plotting-of-nodal-forces-and-element-loading">Plotting of Nodal Forces and Element Loading</h3>
<p>The function <code>Plot_NodalForces</code> displays the nodal forces <code>Pe</code> <code>Create_NodalForces</code>. It is expedient to prevent the display of node symbols in <code>Plot_Model</code>. The nodal force values are displayed by turning on the field <code>Label</code> in <code>PlotOpt</code>. The size of the arrow can be customized with the field <code>FrcSF</code>.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<figure>
<img src="Ex4_2F2" alt="image" /><figcaption aria-hidden="true">image</figcaption>
</figure>
<p>The function <code>Plot_ElemLoading</code> displays the element loads specified in field <code>w</code> and the element deformations in field <code>e0</code> of the data object . The size of the arrow for the element loading can be customized with the field <code>FrcSF</code> and the size of the arrow tip with the field <code>TipSF</code>. Calling the function <code>Plot_Model</code> calling <code>Plot_ElemLoading</code> and ensures that the node and boundary symbols are clearly visible in .</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<figure>
<img src="Ex4_5F2" id="F:ElemLoad" alt="Display of the uniformly distributed element load w for the simple frame with an inclined element from" /><figcaption aria-hidden="true">Display of the uniformly distributed element load <span class="math inline">\(w\)</span><br />
for the simple frame with an inclined element from</figcaption>
</figure>
<h3 id="plotting-of-releases-for-internal-forces">Plotting of Releases for Internal Forces</h3>
<p>The function <code>Plot_Releases</code> displays the internal force releases. End moment releases for truss elements are displayed automatically with default values when invoking the function. The size and offset of the moment release symbol can be adjusted with the fields <code>HngSF</code> and <code>HOfSF</code>.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<figure>
<img src="Ex4_7F1" alt="image" /><figcaption aria-hidden="true">image</figcaption>
</figure>
<div class="sourceCode" id="cb49"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<figure>
<img src="Ex4_6F1" id="F:MomRel" alt="Display of the end moment release for the three hinge portal frame of" /><figcaption aria-hidden="true">Display of the end moment release for the three hinge portal frame of</figcaption>
</figure>
<p>For frame elements the display of internal force releases depends on the field <code>Release</code> of the data structure . The entries of the field in indicate the presence of an end moment release at end <span class="math inline">\(i\)</span> of element <span class="math inline">\(c\)</span> for the model of a three hinge portal frame.</p>
<h3 id="plotting-and-labeling-of-axial-force-distribution">Plotting and Labeling of Axial Force Distribution</h3>
<p>The script excerpt in displays and labels the axial forces <span class="math inline">\(\mathbf{Q}_{}\)</span> in for the plane truss of . The optional input argument <code>ScaleN</code> in <code>Plot_AxialForces</code> controls the scaling of the axial force distribution, while the optional input argument <code>NDigt=2</code> in <code>Label_AxialForces</code> requests 2 digits after the comma for the label of the axial force value. A tensile axial force distribution is shown in blue and a compressive axial force in red.</p>
<div class="MLbox">
<div class="sourceCode" id="cb50"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<figure>
<img src="Ex4_1F1" id="F:Qplot" alt="Axial force distribution for the truss of" /><figcaption aria-hidden="true">Axial force distribution for the truss of</figcaption>
</figure>
<h3 id="plotting-and-labeling-of-bending-moment-distribution">Plotting and Labeling of Bending Moment Distribution</h3>
<div class="MLbox">
<div class="sourceCode" id="cb51"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<p><br />
</p>
</div>
<figure>
<img src="Ex4_4F2" id="F:MomPlotwow" alt="Bending moment distribution for the homogeneous solution of the beam from" /><figcaption aria-hidden="true">Bending moment distribution for the homogeneous solution of the beam from</figcaption>
</figure>
<p>The script excerpt in uses the basic forces <span class="math inline">\(\mathbf{Q}_{}\)</span> to display and label the bending moments in for the beam with overhang of . Without specification of the value for the distributed element loading in the field <code>w</code> of  the function "is not aware" of the presence of element loads and for the bending moment distribution.</p>
<div class="MLbox">
<div class="sourceCode" id="cb52"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<p><br />
</p>
</div>
<figure>
<img src="Ex4_4F3" id="F:MomPlotww" alt="Bending moment distribution for the complete solution of the beam from" /><figcaption aria-hidden="true">Bending moment distribution for the complete solution of the beam from</figcaption>
</figure>
<p>The script excerpt in includes the input argument  in the call to the function <code>Plot_2dMomntDistr</code>, so that it can display the complete solution by superposing the particular solution for element <span class="math inline">\(b\)</span> to the homogeneous solution of .</p>
<h3 id="plotting-of-deformed-shape">Plotting of Deformed Shape</h3>
<p>The script excerpt in uses the free DOF displacements <code>Uf</code> under the initial element deformations <code>V0</code> in to display the resulting deformed shape for the truss of with the help of the function <code>Plot_DeformedStructure</code>. The input arguments <code>ElemData</code> and <code>Veps</code> to the function are not required for the case in hand.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<figure>
<img src="Ex5_1F1" id="F:DefoTrwDV" alt="Deformed shape for plane truss of" /><figcaption aria-hidden="true">Deformed shape for plane truss of</figcaption>
</figure>
<p>shows the deformed shape of the truss with default values under a magnification factor <code>MAGF</code> of 30. The function displays the releases of internal forces by default, which may not be desirable for truss models. The function also displays the boundary symbols by default, but the default size value is disproportionately large for the model in .</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<figure>
<img src="Ex5_1F2" id="F:DefoTrwCV" alt="Improved display of deformed shape for plane truss of" /><figcaption aria-hidden="true">Improved display of deformed shape for plane truss of</figcaption>
</figure>
<p>shows the improvement of the display for the deformed shape of the truss by suppressing the display of internal force releases and scaling the boundary symbols to a quarter of the default value.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
<figure>
<img src="Ex5_1F3" id="F:DefoTrCrd" alt="Deformed shape for the plane truss of" /><figcaption aria-hidden="true">Deformed shape for the plane truss of</figcaption>
</figure>
<p>shows that the deformed shape of a truss model can also be displayed with the function <code>Plot_Model</code> by including the free dof displacements <code>Uf</code> as the second input argument. This instructs the function to connect the nodes of the model in the deformed configuration by straight lines and can, therefore, be used for elements with straight edges to display the deformed shape of the structure. The default option is not to display the boundary conditions. The default values for the line color and line style reflect the color and style selection for element chords of deformed frame elements. These values can be overwritten with the field <code>PlBnd</code> for displaying the the boundary symbols, and with the fields <code>LnClr</code> and <code>LnStl</code> of <code>PlotOpt</code> for setting the line color and style for the deformed shape of the structure, respectively.</p>
<p>shows the specification of the element deformations <span class="math inline">\(\boldsymbol{V}_{\varepsilon}\)</span> for the three hinge portal frame of . It is important to initialize <span class="math inline">\(\boldsymbol{V}_{\varepsilon}\)</span> to its full size. The script uses the function <code>Localize</code> to extract the end coordinates of each element, which are then used with the function <code>ElmLenOr</code> to determine the element length. The axial deformations in elements a through d are set equal to zero on account of their inextensible character. The index of continuous element deformations <code>ic</code> is set up with the  function <code>setdiff</code> after specification of the flexural release locations at end <span class="math inline">\(i\)</span> of element a, end <span class="math inline">\(i\)</span> of element c, and end <span class="math inline">\(j\)</span> of element d for the three hinge portal frame in (a).</p>
<div class="MLbox">
<div class="sourceCode" id="cb56"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<p>The command sequence in sets up the kinematic matrix <span class="math inline">\(\mathbf{A}_{}\)</span> and extracts the submatrix <span class="math inline">\(\mathbf{A}_{f}\)</span> corresponding to the free DOFs of the model in (a) without taking advantage of the inextensibility of elements a through d to reduce the size of the matrix, as was done for the hand calculations in . The matrix <span class="math inline">\(\mathbf{A}_{f}\)</span> refers to element deformations at continuous element ends. In this case the kinematic relations in result in a system of 9 equations with 9 unknowns that gives a unique solution for the free DOF displacements under the given element deformations <span class="math inline">\(\boldsymbol{V}_{\varepsilon}\)</span>. Following the determination of the free DOF displacements <span class="math inline">\(\mathbf{U}_{f}\)</span> the release deformations can be determined with the relation <span class="math display">\[\label{E:VhVeps}
\boxed{ \mathbf{V}_{h}= \breve{\mathbf{A}}_f\mspace{1.5mu}\mathbf{U}_{f}- \mathbf{V}_{\epsilon} }\]</span></p>
<div class="MLbox">
<div class="sourceCode" id="cb57"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<div class="MLbox">
<div class="sourceCode" id="cb58"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<p>The command sequence in draws the model in in the original configuration in blue color. The command <code>Plot_Model</code> with the optional argument <code>Uf</code> draws the nodes and the element chords in the deformed configuration. The element chords are displayed with a black, dash-dotted line by default. Finally, the function call <code>Plot_DeformedStructure</code> draws the deformed shape of the model in the deformed configuration with a red solid line by default. The default line color, line style and line width of most plotting functions can be overwritten with specification of the <code>PlotOpt</code> fields <code>LnClr</code>, <code>LnStl</code>, and <code>LnWth</code>, respectively.</p>
<figure>
<img src="Ex5_3F2" id="F:DefoFrm" alt="Deformed shape for the three hinge portal frame of under given element deformations \mathbf{V}_{0}" /><figcaption aria-hidden="true">Deformed shape for the three hinge portal frame of under given element deformations <span class="math inline">\(\mathbf{V}_{0}\)</span></figcaption>
</figure>
<p>The presence of flexural releases at end <span class="math inline">\(i\)</span> of element a, end <span class="math inline">\(i\)</span> of element c, and end <span class="math inline">\(j\)</span> of element d results in concentrated rotations at these locations. For the correct deformed shape it is imperative to specify the element deformations <span class="math inline">\(\boldsymbol{V}_{\varepsilon}\)</span> as the fourth input argument to <code>Plot_DeformedStructure</code> in . Furthermore, the function displays the end moment releases in elements a, c and d, as long as  appears as the second input argument of the function with the release specification in the field <code>Release</code>, as shows.</p>
<p>If the element deformations <code>Veps</code> are not specified as the fourth input argument to the function <code>Plot_DeformedStructure</code>, as in , the function draws the deformed shape in under the assumption that the element tangents are continuous at the nodes. Consequently, instead of determining <span class="math inline">\(\mathbf{V}_{h}\)</span> according to <a href="#E:VhVeps" data-reference-type="eqref" data-reference="E:VhVeps">[E:VhVeps]</a> and the element deformations <span class="math inline">\(\mathbf{V}_{}\)</span> from <span class="math inline">\(\boldsymbol{V}_{\varepsilon}+\mathbf{V}_{h}\)</span>, the function simply uses <span class="math inline">\(\mathbf{V}_{}= \mathbf{A}_{f}\mspace{1.5mu}\mathbf{U}_{f}\)</span> resulting in the wrong deformed shape in with fixed ends at the two supports and a continuous tangent at the midspan of the girder.</p>
<div class="MLbox">
<div class="sourceCode" id="cb59"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<figure>
<img src="Ex5_3WF1" id="F:WrongDefoFrm" alt="Wrong deformed shape for the portal frame of with continuous element deformations throughout" /><figcaption aria-hidden="true">Wrong deformed shape for the portal frame of<br />
with continuous element deformations throughout</figcaption>
</figure>
<p>The specification of the element release locations in by setting up the global index <code>ic</code> into the element deformation vector <span class="math inline">\(\mathbf{V}_{}\)</span> is inconvenient for large structural models. In such case it is advisable to take advantage of the field <code>Release</code> in  for specifying the release locations of each element. <code>Release</code> is a 3-component column vector, with component 1 corresponding to the axial force, component 2 to the moment at end <span class="math inline">\(i\)</span>, and component 3 to the moment at end <span class="math inline">\(j\)</span> of the element. A value of 1 indicates the presence of a release for the corresponding basic element force. shows the specification of the flexural releases at end <span class="math inline">\(i\)</span> of element a, end <span class="math inline">\(i\)</span> of element c, and end <span class="math inline">\(j\)</span> of element d for the three hinge portal frame in (a). This information is used by  function <code>H_index</code> to set up the collection of cell arrays <code>iced</code> in with the indices for the continuous element deformations. Concatenating these cell arrays produces the global index <code>ic</code> for the continuous element deformations and the use of the  function <code>setdiff</code> gives the global index <code>ih</code> for the release locations in .</p>
<div class="MLbox">
<div class="sourceCode" id="cb60"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<h3 id="linear-analysis">Linear Analysis</h3>
<p>Following the specification of the model geometry and the generation of the data structure  with the function   shows the specification of the element properties for the portal frame of in (a). To account for the inextensible character of elements a, b, c and d a large value for the cross section area <span class="math inline">\(A\)</span> is specified in . The value of <span class="math inline">\(A=10^6\)</span> suffices for the purpose.</p>
<div class="MLbox">
<div class="sourceCode" id="cb61"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<p>shows the determination of the equivalent nodal forces for the uniform element load in elements a and b in . The uniform element load values are specified in  and used as input to the function <code>Create_PwForces</code> to generate the equivalent nodal forces at all DOFs. The equivalent nodal forces <span class="math inline">\(\mathbf{P}_{fw}\)</span> at the free DOFs are extracted from <code>Pw</code>. The element load is defined in the local reference system with the <span class="math inline">\(x\)</span>-axis pointing from end <span class="math inline">\(i\)</span> to end <span class="math inline">\(j\)</span>. Consequently, the <span class="math inline">\(y\)</span>-axis of element a points to the left and that of element b upward, with the element load <span class="math inline">\(w\)</span> in pointing in the negative <span class="math inline">\(y\)</span> direction in both in agreement with the sign for the field <code>w</code> of  in .</p>
<p>Following the element property and loading specification, shows the command sequence for the displacement method of analysis of the portal frame and for plotting and labeling the bending moment distribution under the uniform element load in elements a and b with a scale factor of <span class="math inline">\(0.5\)</span>.</p>
<div class="MLbox">
<div class="sourceCode" id="cb62"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<figure>
<img src="Ex10_3F1" id="F:Mdistr4DM" alt="Bending moment distribution of the portal frame under uniform load w in elements a and b" /><figcaption aria-hidden="true">Bending moment distribution of the portal frame under uniform load <span class="math inline">\(w\)</span> in elements a and b</figcaption>
</figure>
<p>shows the specification of the uniform thermal curvature in elements a and b for the portal frame of . Note the clearing of the values from the preceding load case of uniform element loading. Finally, shows the command sequence for producing the result display in under the uniform thermal curvature in elements a and b.</p>
<div class="MLbox">
<div class="sourceCode" id="cb63"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<div class="MLbox">
<div class="sourceCode" id="cb64"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<p><img src="Ex10_3F3" title="fig:" id="F:Ex8_3F3" alt="Bending moment, curvature distribution, and deformed shape under uniform curvature in elements a and b" /> (a) Bending moment distribution</p>
<p><img src="Ex10_3F4" title="fig:" id="F:Ex8_3F3" alt="Bending moment, curvature distribution, and deformed shape under uniform curvature in elements a and b" /><br />
(b) Curvature distribution<br />
<img src="Ex10_3F5" title="fig:" id="F:Ex8_3F3" alt="Bending moment, curvature distribution, and deformed shape under uniform curvature in elements a and b" /><br />
(c) Deformed shape</p>
<h3 id="plastic-analysis-1">Plastic Analysis</h3>
<p>discusses the use of  function  for determining the collapse load factor <span class="math inline">\(\lambda_c\)</span> and the corresponding basic forces <span class="math inline">\(\mathbf{Q}_{c}\)</span> of a structural model under a given reference load vector <span class="math inline">\(\boldsymbol{P}_{ref}\)</span> at the free DOFs. The input arguments to the function are the equilibrium matrix <code>Bf</code> at the free DOFs, the vector of plastic capacities <code>Qpl</code> and the reference load vector <code>Pref</code>. The script in shows the set-up of the input arguments to the function  for the column-girder assembly of .</p>
<div class="MLbox">
<div class="sourceCode" id="cb65"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<p>Because the end forces <code>Qc</code> in do not include the axial basic forces nor the end moment at the roller support, it is not possible to use the post-processing functions of  to display the moment distribution and the plastic hinge locations at collapse without information about the missing basic element forces. To accomplish this we append the field <code>Qmis</code> to the data structure  to supply the index of the missing basic forces. The plotting and labeling functions of  use the entries in this field, if present, to adjust the incoming basic force vector <span class="math inline">\(\mathbf{Q}_{}\)</span>, so that its terms end up in the right location of the full basic force vector <span class="math inline">\(\mathbf{Q}_{}\)</span> before performing the display and labeling operations.</p>
<p><img src="Ex12_2F1" title="fig:" id="F:PlotColGird" alt="Moment distribution with plastic hinge locations at collapse for the column-girder assembly of" /><br />
</p>
<p>shows the specification of the element index <code>Qmis</code> for the missing basic element forces and the command sequence for plotting the moment distribution and the plastic hinge locations at collapse for the girder-column assembly of in . Because the plastic flexural capacity of elements b and c is the same, a plastic hinge is displayed at end <span class="math inline">\(j\)</span> of element b as well as at end <span class="math inline">\(i\)</span> of element c indicating, in fact, that a plastic hinge forms at the girder midspan. To avoid the display of a double hinge the plastic capacity of element b should be slightly different from element c.</p>
<p>The last example deals with the determination and display of the collapse mechanism of the portal frame in . In the collapse load factor and the kinematics of the collapse mechanism were determined by specifying explicitly the kinematic matrix <span class="math inline">\(\mathbf{A}_{f}\)</span> of the portal frame and invoking the  function for the upper bound theorem. In we let  set up the kinematic matrix with the function  based on the geometric information of the structural model in data structure . Because this function includes also the axial deformations of the frame elements in the entries of the kinematic matrix <span class="math inline">\(\mathbf{A}_{f}\)</span> it is important to specify a plastic capacity vector of equal length with the number of rows of <span class="math inline">\(\mathbf{A}_{f}\)</span>. For this reason the plastic axial capacity is included in the plastic capacity vector <code>Qpl</code> in . It is set to a relatively high value to exclude the possibility of an axial plastic hinge forming in the portal frame.</p>
<div class="MLbox">
<div class="sourceCode" id="cb66"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<div class="MLbox">
<div class="sourceCode" id="cb67"><pre class="sourceCode matlab"><code class="sourceCode matlab"></code></pre></div>
</div>
<p>shows the required sequence of commands for plotting the collapse mechanism of the portal frame with the plastic hinge locations in . After creating a new window and displaying the structural model in the undeformed configuration the magnification factor <code>MAGF</code> is set and the <code>Plot_Model</code> function is invoked a second time with an additional argument the displacement increments <code>DUf</code> of the collapse mechanism. Finally the function <code>Plot_PlasticHinges</code> with the optional argument <code>DUf</code> displays the plastic hinge locations on the collapse mechanism.</p>
<p><img src="Ex12_6F1" title="fig:" id="F:Mech4PorFrm" alt="Collapse mechanism of portal frame" /><br />
</p>
<p>We note that the third input argument of the <code>Plot_PlasticHinges</code> function can be either the basic forces <code>Qc</code> at incipient collapse, as is the case in , in which case the plastic capacity at the corresponding location needs to be specified as the second argument to the function, or the plastic hinge deformation increments <code>DVhp</code>, as shown in .</p>
<h2 id="summary-of-basic-functions-and-scripts">Summary of Basic  Functions and Scripts</h2>
<p>The basic  functions and script files are summarized below.</p>
<div class="center">
<p><strong>Model and Loading Functions</strong></p>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: left;"><span style="color: blue"> Function name</span></th>
<th style="text-align: left;"> <span style="color: blue">Input arguments</span></th>
<th style="text-align: left;"> <span style="color: blue">Output</span>  </th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"> <code>Create_SimpleModel</code>  </td>
<td style="text-align: left;"> <code>XYZ</code>, <code>CON</code>, <code>BOUN</code>, <code>ElemName</code>  </td>
<td style="text-align: left;"> <code>Model</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"> <code>Create_NodalForces</code>  </td>
<td style="text-align: left;"> <code>Model</code>, <code>Pe</code></td>
<td style="text-align: left;"> <code>Pf</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <code>Create_PwForces</code>  </td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code></td>
<td style="text-align: left;"> <code>Pw</code></td>
</tr>
</tbody>
</table>
<div class="center">
<p><strong>Functions for Structural Matrices and Vectors</strong></p>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: left;"><span style="color: blue"> Function name</span></th>
<th style="text-align: left;"><span style="color: blue"> Input arguments (optional)</span></th>
<th style="text-align: left;"><span style="color: blue"> Output</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"> <code>B_matrix</code></td>
<td style="text-align: left;"> <code>Model</code></td>
<td style="text-align: left;"> <code>B</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"> <code>BbariBbarx_matrix</code>  </td>
<td style="text-align: left;"> <code>Bf</code>, (<code>ind_r</code>)</td>
<td style="text-align: left;"> <code>Bbari</code>, <code>Bbarx</code>  </td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <code>A_matrix</code></td>
<td style="text-align: left;"> <code>Model</code></td>
<td style="text-align: left;"> <code>A</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"> <code>Fs_matrix</code></td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code>, <code>(Roption)</code>  </td>
<td style="text-align: left;"> <code>Fs</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <code>V0_vector</code></td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code>, <code>(Roption)</code>  </td>
<td style="text-align: left;"> <code>V0</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"> <code>Ks_matrix</code></td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code>  </td>
<td style="text-align: left;"> <code>Ks</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <code>Q0_vector</code></td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code>  </td>
<td style="text-align: left;"> <code>Q0</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"> <code>Kf_matrix</code></td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code>  </td>
<td style="text-align: left;"> <code>Kf</code></td>
</tr>
</tbody>
</table>
<div class="center">
<p><strong>Analysis Scripts and Functions</strong></p>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: left;"><span style="color: blue"> Script name</span></th>
<th style="text-align: left;"> <span style="color: blue">Input variables (optional)</span></th>
<th style="text-align: left;"> <span style="color: blue">Output variables</span>  </th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"> <code>S_ForceMethod</code>  </td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code>, (<code>Pf</code>), (<code>Pwf</code>)  </td>
<td style="text-align: left;"> <code>Q</code>, <code>Ve</code>, <code>Uf</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"> <code>S_DisplMethod</code>  </td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code>, (<code>Pf</code>), (<code>Pwf</code>)  </td>
<td style="text-align: left;"> <code>Uf</code>, <code>Q</code>, <code>Ve</code></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th style="text-align: left;"><span style="color: blue"> Function name</span></th>
<th style="text-align: left;"><span style="color: blue"> Input arguments</span>  </th>
<th style="text-align: left;"> <span style="color: blue">Output</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"> <code>PlasticAnalysis_wLBT</code>  </td>
<td style="text-align: left;"> <code>Bf</code>, <code>Qpl</code>, <code>Pref</code>, <code>(Pcf)</code>, <code>(Options)</code>  </td>
<td style="text-align: left;"> <code>lambdac</code>, <code>Qc</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"> <code>PlasticAnalysis_wUBT</code>  </td>
<td style="text-align: left;"> <code>Af</code>, <code>Qpl</code>, <code>Pref</code>, <code>(Pcf)</code>, <code>(Options)</code>  </td>
<td style="text-align: left;"> <code>lambdac</code>, <code>DUf</code>, <code>DVhp</code>  </td>
</tr>
</tbody>
</table>
<div class="center">
<p><strong>General Utility Functions</strong></p>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: left;"><span style="color: blue"> Function name</span>  </th>
<th style="text-align: left;"><span style="color: blue"> Input arguments</span>  </th>
<th style="text-align: left;"><span style="color: blue"> Output</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"> <code>CleanStart</code>  </td>
<td style="text-align: left;">‘—’</td>
<td style="text-align: left;">‘—’  </td>
</tr>
<tr class="even">
<td style="text-align: left;"> <code>Create_Units</code></td>
<td style="text-align: left;">‘US’ or ‘SI’</td>
<td style="text-align: left;"> <code>Units</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <code>Localize</code>  </td>
<td style="text-align: left;"> <code>Model</code>, <code>el</code>  </td>
<td style="text-align: left;"> <code>xyz</code>, <code>id</code>  </td>
</tr>
<tr class="even">
<td style="text-align: left;"> <code>ElemLenOr</code></td>
<td style="text-align: left;"> <code>xyz</code></td>
<td style="text-align: left;"> <code>L</code>, <code>dcx</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <code>H_index</code></td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code></td>
<td style="text-align: left;"> <code>iced</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"> <code>D_index</code></td>
<td style="text-align: left;"> <code>Model</code></td>
<td style="text-align: left;"> <code>ied</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <code>Complete_QV</code></td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code>, <code>Q</code></td>
<td style="text-align: left;"> <code>Q</code>, <code>Ve</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"> <code>ElemData2Qpl</code></td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code></td>
<td style="text-align: left;"> <code>Qpl</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <code>Q2Post</code></td>
<td style="text-align: left;"> <code>Model</code>, <code>Q</code></td>
<td style="text-align: left;"> <code>Post</code></td>
</tr>
</tbody>
</table>
<div class="center">
<p><strong>Graphics Utility Functions</strong></p>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: left;"> <span style="color: blue">Function name</span></th>
<th style="text-align: left;"> <span style="color: blue">Input arguments (optional)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"> <code>Create_Window</code></td>
<td style="text-align: left;"> <code>DX</code>, <code>DY</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"> <code>Plot_Model</code></td>
<td style="text-align: left;"> <code>Model</code>, (<code>Uf</code>) , (<code>Options</code>)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <code>Label_Model</code></td>
<td style="text-align: left;"> <code>Model</code>, (<code>Options</code>)</td>
</tr>
<tr class="even">
<td style="text-align: left;"> <code>Plot_NodalForces</code></td>
<td style="text-align: left;"> <code>Model</code>, <code>Pe</code> , (<code>Options</code>) </td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <code>Plot_ElementLoading</code></td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code> , (<code>Options</code>) </td>
</tr>
<tr class="even">
<td style="text-align: left;"> <code>Plot_Releases</code></td>
<td style="text-align: left;"> <code>Model</code>, (<code>ElemData</code>) , (<code>Uf</code>) , (<code>Options</code>) </td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <code>Plot_AxialForces</code></td>
<td style="text-align: left;"> <code>Model</code>, <code>Q</code>, (<code>ElemList</code>), (<code>Scale</code>)</td>
</tr>
<tr class="even">
<td style="text-align: left;"> <code>Label_AxialForces</code></td>
<td style="text-align: left;"> <code>Model</code>, <code>Q</code>, (<code>ElemList</code>), (<code>Digit</code>), (<code>Force Units</code>)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <code>Plot_2dMomntDistr</code></td>
<td style="text-align: left;"> <code>Model</code>, (<code>ElemData</code>), <code>Q</code>, (<code>ElemList</code>), (<code>Scale</code>)  </td>
</tr>
<tr class="even">
<td style="text-align: left;"> <code>Label_2dMoments</code></td>
<td style="text-align: left;"> <code>Model</code>, <code>Q</code>, (<code>ElemList</code>), (<code>Digit</code>), (<code>Moment Units</code>)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <code>Plot_2dCurvDistr</code></td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code>, <code>Q</code>, (<code>ElemList</code>), (<code>Scale</code>)  </td>
</tr>
<tr class="even">
<td style="text-align: left;"> <code>Plot_DeformedStructure</code>  </td>
<td style="text-align: left;"> <code>Model</code>, (<code>ElemData</code>), <code>Uf</code>, (<code>Ve</code>), (<code>Options</code>)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"> <code>Plot_PlasticHinges</code></td>
<td style="text-align: left;"> <code>Model</code>, <code>ElemData</code>, (<code>Uf</code>), <code>Q</code>, (<code>Options</code>)</td>
</tr>
</tbody>
</table>
<h2 id="script-name-purpose"><span style="color: blue"> Script name</span>   <span style="color: blue"> Purpose</span>  </h2>
<hr />
<div class="center">
<p><strong>Auxiliary Functions</strong><br />
</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>Get_ModelScale</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>Plot_BounCond</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>DeformShape2dFrm</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>Draw_Arrow</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>Draw_Cube</code></td>
</tr>
</tbody>
</table>
</div>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>The prefix R in this report refers to material in the course reader<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p><code>Roption</code> specifies whether release information is used to strip matrix rows and columns corresponding to releases<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

                        
                        </article>
                        <!-- <div class="col-md-8" role="main"></div> -->
                    
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>&copy 1998-2021 UC Regents, Filip C. Filippou</p>
        </footer>
        <script>
            var base_url = "../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../js/base.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer></script>
        <script src="../../../search/main.js" defer></script>

        <div class="modal" id="elstir_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="elstir-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="elstir-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="elstir_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
