\let\Ovec\vec
\documentclass[10pt,graybox]{svmonoFCF}

\usepackage{amsmath,bm}
\usepackage{amssymb,latexsym}
\usepackage{isomath}
%\usepackage{subfig}
\usepackage{graphicx,float}
%\usepackage[justification=centerfirst]{caption}
%\usepackage[justification=centerfirst,font=small,format=plain,labelfont=bf]{caption}
%\usepackage[format=hang,margin=10pt]{caption}
\usepackage{listings}
\usepackage{fancyhdr}
\usepackage[svgnames]{xcolor}            % to add color
\usepackage{tocloft}
\usepackage{titlesec}
\usepackage{varwidth}
\usepackage{array}
\usepackage{appendix}
\usepackage{paralist}

\usepackage{newfloat}
\usepackage{caption}
\DeclareFloatingEnvironment[fileext=box,placement={!ht},name=Box]{MLbox}
\captionsetup{justification=centering}  % same as above
\usepackage{csquotes}
\usepackage{xr}

%\usepackage[alwaysadjust]{paralist}
%\usepackage{array}
%\usepackage{setspace}
%\usepackage{wrapfig}
%\usepackage{float}
%\floatstyle{boxed}
%\newfloat{Box}{!h}{box}[chapter]

% ----------------------------------------------------------
% style parameters for sentences and paragraphs, see Guide, C.3.2 and fig C.3
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\renewcommand{\baselinestretch}{1.25} % decimal number; factor for line spacing
\setlength{\textheight}{8.5in}        % height of text body
\setlength{\textwidth}{6.25in}        % width of text body
\setlength{\topmargin}{0pt}           % distance between 1" top margin and header
\setlength{\headheight}{12pt}         % height of header
\setlength{\headsep}{18pt}            % distance between header and text
\setlength{\oddsidemargin}{0.25in}    % distance between 1" side margin and text
\setlength{\evensidemargin}{0.25in}   % distance between 1" side margin and text
\setlength{\footskip}{24pt}           % distance between footer bottom and text

\setlength{\parindent}{12pt}

\cftsetindents{section}{0.25in}{0.35in}
\cftsetindents{subsection}{0.6in}{0.50in}
\cftsetindents{subsubsection}{1.1in}{0.50in}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\flushbottom        % makes all text pages the same height adding extra vertical space

\allowdisplaybreaks[1] % allow page breaks in multiline math environments

% ----------------------------------------------------------
% style parameters for figures and other floating bodies, see Guide C.9
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\renewcommand\topfraction{.9}       % maximum fraction of page top occupied by floats
\renewcommand\bottomfraction{.9}    % maximum fraction of page bot occupied by floats
\renewcommand\floatpagefraction{.9} % minimum fraction of float page occupied by floats
\renewcommand\textfraction{.1}      % minimum fraction of text page devoted to text

%\newcommand{\sdfrac}[2]{\mbox{\small$\displaystyle\frac{#1}{#2}$}}
\newcommand{\sdfrac}[2]{\mbox{\fontsize{9}{11}$\displaystyle\frac{#1}{#2}$}}
\newcommand{\BigFig}[1]{\parbox{12pt}{\Huge #1}}
\newcommand{\matsp}{\hspace{0.5\arraycolsep}}
\newcommand{\mvsub}[2]{{\raisebox{#1}{$\scriptstyle{#2}$}}}

\setlength{\floatsep}{3pt}          % space between floats at top or bottom of page
\setlength{\textfloatsep}{6pt}      % space between top or bottom float and text
\setlength{\intextsep}{6pt}         % space between middle float and text

%\renewcommand{\arraycolsep}{6pt}

% ----------------------------------------------------------
% options with package titlesec
% ----------------------------------------------------------
\titlespacing{\section}{0pt}{*2}{*2}
\titlespacing{\subsection}{0pt}{*2}{*2}
\titlespacing{\subsubsection}{0pt}{*2}{*2}

% ----------------------------------------------------------
% added to produce special header and footer for course
%\pagestyle{fancy}
%\lhead{Chapter \thechapter}
%\chead{}
%\rhead{\copyright Professor Filip C. Filippou, UC Berkeley}
%\cfoot{\thepage}
%\renewcommand\footrulewidth{0.4pt}
% ----------------------------------------------------------
% using Springer example environment
% \numberwithin{example}{chapter}
%\spnewtheorem{exSec}{\nocaption}{\itshape}{\rmfamily}
%\renewcommand{\theexSec}{(\alph{exSec})}

% ----------------------------------------------------------
% listings package
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\lstset{ %
language=Matlab,                     % code language
basicstyle=\small\sffamily,          % font size for code text
numbers=none,                        % code line numbering
commentstyle=\color{Green},
keywordstyle=\bfseries\color{blue},
stringstyle=\color{FireBrick},
showstringspaces=false,
lineskip=-1pt,
escapechar=\#,
emphstyle=\color{red},
frame=single,
framerule=0.5pt,
rulecolor=\color{blue},
framexrightmargin=0cm
%identifierstyle=\color{blue},
%backgroundcolor=\color{SkyBlue},  % choose the background color. You must add
}

% ----------------------------------------------------------
% custom commands

\DeclareMathOperator{\sgn}{sgn}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% change labels for enumerate environment from 1. to 1)
\renewcommand*\theenumi{\arabic{enumi}}
\renewcommand*\labelenumi{\theenumi)}
\setlength{\smallskipamount}{0pt}
\setlength{\parindent}{16pt}
\setlength{\itemindent}{6pt}
\setlength{\labelsep}{9pt}
\addtolength{\listparindent}{60pt}
%----------------------------------------------------------
% color box around equations
%\newcommand{\cboxed}[1]{\setlength{\fboxrule}{0pt}\fcolorbox{black}{Gray!25}{\ensuremath{#1}}}
\newcommand{\cboxed}[1]{\setlength{\fboxrule}{0pt}\fcolorbox{black}{DodgerBlue!20}{\ensuremath{\displaystyle#1}}}
%\newcommand{\cboxed}[1]{\setlength{\fboxrule}{1pt}\fcolorbox{black}{Yellow!30}{\ensuremath{#1}}}
%\newcommand{\cboxed}[1]{\setlength{\fboxrule}{0.75pt}\fcolorbox{DarkBlue}{Ivory}{\ensuremath{#1}}}
%\newcommand{\cboxed}[1]{\setlength{\fboxrule}{0.75pt}\fcolorbox{DarkBlue}{Azure}{\ensuremath{#1}}}
%\newcommand{\cboxed}[1]{\setlength{\fboxrule}{0.75pt}\fcolorbox{Green}{Honeydew}{\ensuremath{#1}}}
\newcommand{\cfboxed}[1]{\setlength{\fboxrule}{1pt}\fcolorbox{black}{DodgerBlue!30}{\ensuremath{#1}}}
%----------------------------------------------------------
% insert figure, equation, chapter, etc reference commands
\newcommand{\figref}[1]{Fig.~\ref{#1}}
\newcommand{\boxref}[1]{Box~\ref{#1}}
\newcommand{\MLref}[1]{Box~\ref{#1}}
\newcommand{\tableref}[1]{Table~\ref{#1}}
\newcommand{\chapref}[1]{Chapter~\ref{#1}}
\newcommand{\secref}[1]{Section~\ref{#1}}
\newcommand{\Feqref}[1]{Eq.~\ref{#1}}
\newcommand{\exref}[1]{Example~\ref{#1}}
%----------------------------------------------------------
% commands for text emphasis
\newcommand{\bt}[1]{\emph{#1}}
\newcommand{\rt}[1]{{\color{red}{#1}}}
\newcommand{\bct}[1]{{\texttt{#1}}}
%----------------------------------------------------------
% color box around paragraphs
%\newcommand{\cpbox}[2][0pt]{
%    \setlength{\fboxrule}{#1}\setlength{\fboxsep}{9pt}\par\smallskip\noindent%
%    \hskip-9pt\fcolorbox{black}{Gray!25}{\parbox{\textwidth}{#2}}\smallskip}
%\newcommand{\cpbox}[2][0pt]{
%    \setlength{\fboxrule}{#1}\setlength{\fboxsep}{9pt}\par\medskip%
%    \hskip-12pt\fcolorbox{black}{Gray!25}{\parbox{0.96\textwidth}{#2}}\par\medskip}
\newcommand{\cpbox}[2][0pt]{
    \setlength{\fboxrule}{#1}\setlength{\fboxsep}{6pt}\par\medskip%
    \hskip-15pt\fcolorbox{black}{DodgerBlue!20}{\parbox{0.9734\textwidth}{#2}}\par\medskip}
%%% CHANGED FOR NONLINEAR ANALYSIS INDENT; NOT SURE WHY THE OTHER ONE IS NOT WORKING 1/20/2014
%\newcommand{\cpbox}[2][0pt]{
%    \setlength{\fboxrule}{#1}\setlength{\fboxsep}{6pt}\par\medskip%
%    \fcolorbox{black}{DodgerBlue!20}{\parbox{0.9734\textwidth}{#2}}\par\medskip}
%----------------------------------------------------------
% color box around text matching its width
\newlength{\wbox}
%\newcommand{\ccpbox}[2][0pt]{
%    \setlength{\fboxrule}{#1}\setlength{\fboxsep}{9pt}\settowidth{\wbox}{#2}\begin{center}%
%    \fcolorbox{black}{Gray!25}{\parbox{\wbox}{#2}}\end{center}}
\newcommand{\ccpbox}[2][0pt]{
    \setlength{\fboxrule}{#1}\setlength{\fboxsep}{6pt}\settowidth{\wbox}{#2}%
    \begin{center}\fcolorbox{black}{DodgerBlue!20}{\parbox{\wbox}{#2}}\end{center}}
\newcommand{\fcpbox}[2][0pt]{
    \setlength{\fboxrule}{#1}\setlength{\fboxsep}{9pt}%
    \begin{center}\fcolorbox{black}{DodgerBlue!20}{\parbox{0.85\linewidth}{#2}}\end{center}}
%----------------------------------------------------------
% example command
\newcounter{exmp}                            % example counter
\newcommand{\Example}[1]{\vskip12pt
    \noindent {\color{Blue}\textbf{\textit{Example \refstepcounter{exmp}{\theexmp\ } #1}}}\par \medskip %
    \addcontentsline{toc}{section}{\hspace{20pt} Example \theexmp\ \ #1}}
%\setcounter{tocdepth}{4}                    % increase depth of table of contents to 4
\numberwithin{exmp}{chapter}                 % number examples with chapter number
%----------------------------------------------------------
% example section command
\newcounter{exsec}[exmp]                     % example section counter
\newcommand{\ExSec}[1]{\medskip \noindent \textit {\refstepcounter{exsec}{\theexsec\ }#1} \par \medskip}
\renewcommand{\theexsec}{(\alph{exsec})}
%----------------------------------------------------------

\newenvironment{frameenv}[1]
    {\begin{MLbox}[tb]
    \begin{figure}
    \caption{#1}
    \end{figure}\end{MLbox}
    }
%----------------------------------------------------------
%\newenvironment{exmp}[1][chapter]{\begin{trivlist}
%\item[\hskip \labelsep {\bfseries #1}]}{\end{trivlist}}
%\newcounter{Ex}
%\newenvironment{example}[1][chapter]{\begin{trivlist} \item[\hskip \textbf{\textit{Example \refstepcounter{Ex}{\theexmp\ } #1}}]}{\end{trivlist}}
%\numberwithin{Ex}{chapter}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\makeatletter
  \renewcommand*\env@matrix[1][c]{\hskip -\arraycolsep
    \let\@ifnextchar\new@ifnextchar
    \array{*\c@MaxMatrixCols #1}}
\makeatother

%\def\BigColSep{\setlength{\arraycolsep}{50pt}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\newcommand*{\boxedcolor}{red}
%\makeatletter
%\newcommand{\yboxed}[1]{\textcolor{\boxedcolor}{%
%\fbox{\normalcolor\m@th$\displaystyle#1$}}}
%\makeatother

%\newenvironment{fenumerate}{
%\begin{enumerate}
%%    \setlength{\parindent}{5in}
%    \setlength{\itemindent}{6pt}
%}{\end{enumerate}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% interesting application
%\makeatletter
%  \def\enumerate{%
%    \ifnum \@enumdepth >\thr@@\@toodeep\else
%      \advance\@enumdepth\@ne
%      \edef\@enumctr{enum\romannumeral\the\@enumdepth}%
%        \expandafter
%        \list
%          \csname label\@enumctr\endcsname
%          {\usecounter\@enumctr\def\makelabel##1{\hss\llap{##1}}}%
%    \fi}
%  \let\endenumerate =\endlist
%\makeatother

\newenvironment{blah}{\par
 \samepage
 \@setpar{\@@par\nobreak}%
}{%
 \par
 \allowbreak
}
